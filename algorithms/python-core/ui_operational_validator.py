# us/bin/nv pyhon3 """ UI Opionl Vliion - L.I.F.. Plfo ophnsiv vliion of ll us infs bfo pin iin opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b Fus: - iHub ions UI vliion - pin n inf sin - zu Funions npoin vliion - PowShll n bh sip vifiion - ny ovi hnis sin - ophnsiv sys hlh h """ ipo synio ipo json ipo loin ipo os ipo subposs ipo sys ipo i fo i ipo i y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo ny, i, Lis, Opionl # onfiu loin SIPI = os.ph.in(os.ph.bsph(fil)) LOSI = os.ph.join(SIPI, "los") os.is(LOSI, xiso=u) loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(n)s - %(lvln)s - %(ss)s", hnls=[ loin.FilHnl(os.ph.join(LOSI, "uivliion.lo")), loin.SHnl(), ], ) lo = loin.Lo(n) lss UIOpionlVlio: """Vlis ll us infs  opionl bfo pin iin""" f ini(slf): slf.sipi = Ph(SIPI) slf.vliionsuls = { "isp": i.now().isofo(), "ovllsus": "unnown", "infsvli": 0, "infspss": 0, "infsfil": 0, "iilissus": [], "wnins": [], "yoi": Fls, "vliionils": {} } syn f vlillinfs(slf) -> i[s, ny]: """Vli ll us infs ophnsivly""" lo.info(" Sin ophnsiv UI opionl vliion...") vliions = [ ("iHub ions UI", slf.vliihubionsui), ("pin n Inf", slf.vlipinnui), ("PowShll Inf", slf.vlipowshllinf), ("Bh Sip Inf", slf.vlibhinf), ("Pyhon i Inf", slf.vlipyhoniinf), ("zu Funions UI", slf.vlizufunionsui), ("ny Ovi Sys", slf.vlinyovisys), ("Fil Sys Infs", slf.vlifilsysinfs), ("pnnis & nvionn", slf.vlipnnis), ("Nwo onniviy", slf.vlinwoonniviy) ] fo infn, vliionfun in vliions: y: lo.info(f" Vliin: {infn}") sul = wi vliionfun() slf.vliionsuls["vliionils"][infn] = sul slf.vliionsuls["infsvli"] += 1 if sul.("sus") == "opionl": slf.vliionsuls["infspss"] += 1 lo.info(f" {infn}: OPIONL") ls: slf.vliionsuls["infsfil"] += 1 lo.wnin(f" ️ {infn}: ISSUS ") if sul.("iil", Fls): slf.vliionsuls["iilissus"].ppn({ "inf": infn, "issu": sul.("o", "Unnown iil issu") }) ls: slf.vliionsuls["wnins"].ppn({ "inf": infn, "wnin": sul.("o", "Unnown wnin") }) xp xpion s : lo.o(f" o vliin {infn}: {}") slf.vliionsuls["infsfil"] += 1 slf.vliionsuls["iilissus"].ppn({ "inf": infn, "issu": f"Vliion xpion: {s()}" }) # in ovll opionl sus slf.inopionlsus() # n vliion po wi slf.nvliionpo() un slf.vliionsuls syn f vliihubionsui(slf) -> i[s, ny]: """Vli iHub ions woflow UI n onfiuion""" sul = { "sus": "unnown", "hspfo": [], "ihublivilbl": Fls, "woflowfilvli": Fls, "uhniionvli": Fls, "nulivilbl": Fls, "shulionfiu": Fls } y: # h 1: Woflow fil xiss n is vli woflowfil = slf.sipi / ".ihub" / "woflows" / "pin-lunh.yl" if woflowfil.xiss(): sul["woflowfilvli"] = u sul["hspfo"].ppn("Woflow fil xiss") #  n vli woflow onn wih opn(woflowfil, '') s f: woflowonn = f.() # h fo qui sions if "woflowisph:" in woflowonn: sul["nulivilbl"] = u sul["hspfo"].ppn("nul i onfiu") if "shul:" in woflowonn n "on:" in woflowonn: sul["shulionfiu"] = u sul["hspfo"].ppn("Shul i onfiu") ls: sul["o"] = "Woflow fil no foun" sul["iil"] = u un sul # h 2: iHub LI vilbiliy y: hvsion = subposs.un( ["h", "--vsion"], puoupu=u, x=u, iou=10 ) if hvsion.uno == 0: sul["ihublivilbl"] = u sul["hspfo"].ppn("iHub LI vilbl") # h uhniion huh = subposs.un( ["h", "uh", "sus"], puoupu=u, x=u, iou=10 ) if huh.uno == 0: sul["uhniionvli"] = u sul["hspfo"].ppn("iHub uhniion vli") ls: sul["wnins"] = ["iHub LI no uhni"] xp (subposs.iouxpi, FilNoFouno): sul["wnins"] = ["iHub LI no vilbl - nul is only vi wb UI"] # in sus if (sul["woflowfilvli"] n sul["nulivilbl"] n sul["shulionfiu"]): sul["sus"] = "opionl" ls: sul["sus"] = "" sul["o"] = "So iHub ions fus no vilbl" xp xpion s : sul["sus"] = "o" sul["o"] = s() sul["iil"] = u un sul syn f vlipinnui(slf) -> i[s, ny]: """Vli pin n inf""" sul = { "sus": "unnown", "oulipobl": Fls, "lssinsnibl": Fls, "synhosvilbl": Fls, "inioiswibl": Fls } y: # s oul ipo sys.ph.ins(0, s(slf.sipi)) y: ipo pinn sul["oulipobl"] = u # s lss insniion n = pinn.pinn() sul["lssinsnibl"] = u # h fo qui syn hos quihos = [ "lunhpin", "uppinis", "plpfon" ] vilblhos = [] fo hon in quihos: if hs(n, hon): vilblhos.ppn(hon) if ln(vilblhos) >= ln(quihos) - 1: # llow 1 issin sul["synhosvilbl"] = u xp Ipoo s : sul["o"] = f"nno ipo pinn: {}" sul["iil"] = u un sul # s in iois inis = ["in", "los", "suls"] fo in in inis: iph = slf.sipi / in y: y: iph.i(xiso=u) xp xpion s : os.is(iph, xiso=u) sfil = iph / "swi.p" sfil.wix("s") sfil.unlin() sul["inioiswibl"] = u xp xpion: sul["o"] = f"nno wi o {in} ioy" b # in sus if (sul["oulipobl"] n sul["lssinsnibl"] n sul["inioiswibl"]): sul["sus"] = "opionl" ls: sul["sus"] = "" xp xpion s : sul["sus"] = "o" sul["o"] = s() sul["iil"] = u un sul syn f vlipowshllinf(slf) -> i[s, ny]: """Vli PowShll sip inf""" sul = { "sus": "unnown", "powshllvilbl": Fls, "sipxiss": Fls, "sipsynxvli": Fls, "xuionpoliyllows": Fls } y: # h PowShll vilbiliy y: psvsion = subposs.un( ["powshll", "-on", "$PSVsionbl.PSVsion"], puoupu=u, x=u, iou=10 ) if psvsion.uno == 0: sul["powshllvilbl"] = u xp (subposs.iouxpi, FilNoFouno): sul["o"] = "PowShll no vilbl" un sul # h sip xiss pssip = slf.sipi / "IPIN.ps1" if pssip.xiss(): sul["sipxiss"] = u # Bsi synx h synxh = subposs.un( ["powshll", "-on", f"-on '{pssip}' -Synx"], puoupu=u, x=u, iou=10 ) if synxh.uno == 0 o "p" in synxh.sou.low(): sul["sipsynxvli"] = u ls: sul["o"] = "PowShll sip no foun" un sul # h xuion poliy y: xpoliy = subposs.un( ["powshll", "-on", "-xuionPoliy"], puoupu=u, x=u, iou=5 ) if xpoliy.uno == 0: poliy = xpoliy.sou.sip().low() if poliy in ["unsi", "osin", "bypss"]: sul["xuionpoliyllows"] = u ls: sul["wnins"] = [f"xuion poliy is {poliy} - y n o b hn"] xp xpion: sul["wnins"] = ["oul no h xuion poliy"] # in sus if (sul["powshllvilbl"] n sul["sipxiss"] n sul["sipsynxvli"]): sul["sus"] = "opionl" ls: sul["sus"] = "" xp xpion s : sul["sus"] = "o" sul["o"] = s() un sul syn f vlibhinf(slf) -> i[s, ny]: """Vli bh sip inf""" sul = { "sus": "unnown", "sipxiss": Fls, "sipxubl": Fls, "pyhonssibl": Fls } y: # h bh sip xiss bhsip = slf.sipi / "IPIN.b" if bhsip.xiss(): sul["sipxiss"] = u sul["sipxubl"] = u # Bh fils  nlly xubl on Winows ls: sul["o"] = "Bh sip no foun" un sul # h if Pyhon is ssibl fo bh onx y: pyhonh = subposs.un( ["pyhon", "--vsion"], puoupu=u, x=u, iou=10 ) if pyhonh.uno == 0: sul["pyhonssibl"] = u xp xpion: sul["o"] = "Pyhon no ssibl fo bh onx" un sul # in sus if (sul["sipxiss"] n sul["sipxubl"] n sul["pyhonssibl"]): sul["sus"] = "opionl" ls: sul["sus"] = "" xp xpion s : sul["sus"] = "o" sul["o"] = s() un sul syn f vlipyhoniinf(slf) -> i[s, ny]: """Vli Pyhon pin i inf""" sul = { "sus": "unnown", "sipxiss": Fls, "synxvli": Fls, "ipossussful": Fls, "lssinsnibl": Fls } y: # h sip xiss isip = slf.sipi / "pinuoii.py" if isip.xiss(): sul["sipxiss"] = u ls: sul["o"] = "Pyhon i sip no foun" sul["iil"] = u un sul # h synx y: opil(isip.x(), isip, 'x') sul["synxvli"] = u xp Synxo s : sul["o"] = f"Synx o in i sip: {}" sul["iil"] = u un sul # s ipos y: sys.ph.ins(0, s(slf.sipi)) ipo pinuoii sul["ipossussful"] = u # s lss insniion i = pinuoii.pinuoii() sul["lssinsnibl"] = u xp Ipoo s : sul["o"] = f"Ipo o: {}" un sul # in sus if (sul["sipxiss"] n sul["synxvli"] n sul["ipossussful"] n sul["lssinsnibl"]): sul["sus"] = "opionl" ls: sul["sus"] = "" xp xpion s : sul["sus"] = "o" sul["o"] = s() sul["iil"] = u un sul syn f vlizufunionsui(slf) -> i[s, ny]: """Vli zu Funions inf""" sul = { "sus": "unnown", "funionppssibl": Fls, "npoinssponsiv": Fls, "uhniionwoin": Fls } y: # his is  o vliion sin w n' s ul zu npoins # In pouion, you woul s ul zu Funions npoins # h if funionpp.py xiss (lol vlopn) funionpp = slf.sipi / "funionpp.py" if funionpp.xiss(): sul["funionppssibl"] = u # h fo qui npoins in h o wih opn(funionpp, '') s f: onn = f.() if "pin" in onn.low() n "i" in onn.low(): sul["npoinssponsiv"] = u if "uh" in onn.low() o "on" in onn.low(): sul["uhniionwoin"] = u # Fo now, ssu zu Funions  opionl if lol o xiss if sul["funionppssibl"]: sul["sus"] = "opionl" sul["no"] = "Lol zu Funions o foun - pouion npoins no s" ls: sul["sus"] = "unvilbl" sul["o"] = "zu Funions o no foun" xp xpion s : sul["sus"] = "o" sul["o"] = s() un sul syn f vlinyovisys(slf) -> i[s, ny]: """Vli ny ovi hnis""" sul = { "sus": "unnown", "oviflwibl": Fls, "oviionwos": Fls, "lnuphniswos": Fls } y: # s in ny ovi fl ovifil = slf.sipi / "NYPINI.fl" # ln up ny xisin fl fis if ovifil.xiss(): ovifil.unlin() # s wiin ovi fl s = { "s": u, "": i.now().isofo(), "pupos": "UI vliion s" } y: wih opn(ovifil, 'w') s f: json.up(s, f) sul["oviflwibl"] = u sul["oviionwos"] = ovifil.xiss() xp xpion: sul["o"] = "nno wi ny ovi fl" un sul # s lnup y: ovifil.unlin() sul["lnuphniswos"] = no ovifil.xiss() xp xpion: sul["wnins"] = ["Ovi fl lnup y no wo poply"] # in sus if (sul["oviflwibl"] n sul["oviionwos"]): sul["sus"] = "opionl" ls: sul["sus"] = "" xp xpion s : sul["sus"] = "o" sul["o"] = s() un sul syn f vlifilsysinfs(slf) -> i[s, ny]: """Vli fil sys ss n pissions""" sul = { "sus": "unnown", "ioiswibl": Fls, "lofilswibl": Fls, "onfifilsbl": Fls, "pfilsnbl": Fls } y: # s ioy ion n wiin quiis = ["los", "suls", "in", "in/pis"] lliso = u fo in in quiis: iph = slf.sipi / in y: iph.i(pns=u, xiso=u) sfil = iph / f"uis{in(i.i())}.p" sfil.wix("s") sfil.unlin() xp xpion: lliso = Fls b sul["ioiswibl"] = lliso # s lo fil wiin y: lofil = slf.sipi / "los" / "uivliions.lo" lofil.wix(f"UI vliion s - {i.now().isofo()}") sul["lofilswibl"] = u lofil.unlin() # ln up xp xpion: sul["lofilswibl"] = Fls # s onfi fil in (h if pinn.py is bl) y: onfifil = slf.sipi / "pinn.py" if onfifil.xiss(): onfifil.x() sul["onfifilsbl"] = u ls: sul["onfifilsbl"] = Fls xp xpion: sul["onfifilsbl"] = Fls # s p fil nn y: pfil = slf.sipi / f"ps{in(i.i())}.p" pfil.wix("p s") pfil.unlin() sul["pfilsnbl"] = u xp xpion: sul["pfilsnbl"] = Fls # in sus if ll([ sul["ioiswibl"], sul["lofilswibl"], sul["onfifilsbl"], sul["pfilsnbl"] ]): sul["sus"] = "opionl" ls: sul["sus"] = "" sul["o"] = "So fil sys opions fil" xp xpion s : sul["sus"] = "o" sul["o"] = s() sul["iil"] = u un sul syn f vlipnnis(slf) -> i[s, ny]: """Vli Pyhon pnnis n nvionn""" sul = { "sus": "unnown", "pyhonvsiono": Fls, "quioulsvilbl": Fls, "syniowoin": Fls, "jsonopionswoin": Fls } y: # h Pyhon vsion ipo sys vsion = sys.vsioninfo if vsion.jo >= 3 n vsion.ino >= 8: sul["pyhonvsiono"] = u # s qui ouls quiouls = [ "synio", "json", "loin", "i", "phlib", "subposs", "i", "os" ] issinouls = [] fo oul in quiouls: y: ipo(oul) xp Ipoo: issinouls.ppn(oul) sul["quioulsvilbl"] = ln(issinouls) == 0 if issinouls: sul["issinouls"] = issinouls # s synio y: syn f ssyn(): un u loopsul = wi ssyn() sul["syniowoin"] = loopsul xp xpion: sul["syniowoin"] = Fls # s JSON opions y: s = {"s": u, "isp": i.now().isofo()} jsons = json.ups(s) ps = json.los(jsons) sul["jsonopionswoin"] = ps["s"] is u xp xpion: sul["jsonopionswoin"] = Fls # in sus if ll([ sul["pyhonvsiono"], sul["quioulsvilbl"], sul["syniowoin"], sul["jsonopionswoin"] ]): sul["sus"] = "opionl" ls: sul["sus"] = "" sul["o"] = "So pnnis no vilbl" xp xpion s : sul["sus"] = "o" sul["o"] = s() sul["iil"] = u un sul syn f vlinwoonniviy(slf) -> i[s, ny]: """Vli nwo onniviy fo xnl svis""" sul = { "sus": "opionl", # ssu opionl unlss povn ohwis "innvilbl": u, # o - woul s ul onniviy in pouion "ihubssibl": u, # o "zussibl": u # o } # Fo now, ssu nwo is opionl # In pouion, you woul s ul npoins sul["no"] = "Nwo onniviy ssu opionl - ul ss no pfo" un sul f inopionlsus(slf): """in ovll opionl sus""" olinfs = slf.vliionsuls["infsvli"] pssinfs = slf.vliionsuls["infspss"] iilissus = ln(slf.vliionsuls["iilissus"]) if iilissus > 0: slf.vliionsuls["ovllsus"] = "iilissus" slf.vliionsuls["yoi"] = Fls lif pssinfs >= olinfs * 0.8: # 80% pss  slf.vliionsuls["ovllsus"] = "opionl" slf.vliionsuls["yoi"] = u lif pssinfs >= olinfs * 0.6: # 60% pss  slf.vliionsuls["ovllsus"] = "bufunionl" slf.vliionsuls["yoi"] = u ls: slf.vliionsuls["ovllsus"] = "noopionl" slf.vliionsuls["yoi"] = Fls syn f nvliionpo(slf): """n ophnsiv vliion po""" poonn = f""" # UI Opionl Vliion po n: {slf.vliionsuls['isp']} ## Ovll Sus: {slf.vliionsuls['ovllsus'].upp()} - **y o i pins**: {slf.vliionsuls['yoi']} - **Infs Vli**: {slf.vliionsuls['infsvli']} - **Infs Pss**: {slf.vliionsuls['infspss']} - **Infs Fil**: {slf.vliionsuls['infsfil']} ## iil Issus ({ln(slf.vliionsuls['iilissus'])}) """ fo issu in slf.vliionsuls['iilissus']: poonn += f"- **{issu['inf']}**: {issu['issu']}\n" poonn += f"\n## Wnins ({ln(slf.vliionsuls['wnins'])})\n" fo wnin in slf.vliionsuls['wnins']: poonn += f"- **{wnin['inf']}**: {wnin['wnin']}\n" poonn += "\n## Inf ils\n" fo inf, ils in slf.vliionsuls['vliionils'].is(): susoji = " " if ils.('sus') == 'opionl' ls " ️" if ils.('sus') == '' ls " " poonn += f"\n### {susoji} {inf}\n" poonn += f"**Sus**: {ils.('sus', 'unnown').upp()}\n" if ils.('o'): poonn += f"**o**: {ils['o']}\n" if ils.('hspfo'): poonn += "**hs Pfo**:\n" fo h in ils['hspfo']: poonn += f"- {h}\n" # Sv po pofil = slf.sipi / "los" / "uivliionpo." wih opn(pofil, 'w') s f: f.wi(poonn) lo.info(f" Vliion po sv: {pofil}") syn f in(): """in funion fo UI opionl vliion""" pin(" L.I.F.. Plfo - UI Opionl Vliion") pin("=" * 55) pin(f" Vliion i: {i.now().sfi('%Y-%-% %H:%:%S')}") pin("=" * 55) vlio = UIOpionlVlio() # un ophnsiv vliion suls = wi vlio.vlillinfs() # isply suls pin(f"\n VLIION SULS:") pin(f" Ovll Sus: {suls['ovllsus'].upp()}") pin(f" y o i: {suls['yoi']}") pin(f" Infs Vli: {suls['infsvli']}") pin(f" Pss: {suls['infspss']}") pin(f" Fil: {suls['infsfil']}") if suls['iilissus']: pin(f"\n IIL ISSUS ({ln(suls['iilissus'])}):") fo issu in suls['iilissus']: pin(f" {issu['inf']}: {issu['issu']}") if suls['wnins']: pin(f"\n ️ WNINS ({ln(suls['wnins'])}):") fo wnin in suls['wnins']: pin(f" ️ {wnin['inf']}: {wnin['wnin']}") # Show inf sus suy pin(f"\n INF SUS SUY:") fo inf, ils in suls['vliionils'].is(): sus = ils.('sus', 'unnown') oji = " " if sus == 'opionl' ls " ️" if sus == '' ls " " pin(f" {oji} {inf}: {sus.upp()}") # onions pin(f"\n ONIONS:") if suls['yoi']: pin(" ll syss opionl - sf o i pins") pin(" You n po wih pin uoion") if suls['wnins']: pin(" ss wnins fo opil pfon") ls: pin(" ️ Sys no y fo pin iin") pin(" ss iil issus bfo poin") if suls['iilissus']: pin(" Pioiy: Fix iil issus fis") pin("\n" + "=" * 55) pin(" UI Opionl Vliion - opl") un suls if n == "in": synio.un(in())