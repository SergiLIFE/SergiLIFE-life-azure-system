"""  Io Hub Sin fo L.I.F. Plfo Uss zu-io-vi whn vilbl; ohwis povis  sub h los sss. onnion sin is  fo nvionn vibl ZUIOHUBVIONNIONSIN o n b povi ily o vilin. SII-sf loin only. """ ipo synio ipo json ipo loin ipo os fo ypin ipo ny, synIo, i, Opionl loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(lvln)s - %(ss)s" ) lo = loin.Lo(n) y: # Pf syn lin fo zu.io.vi.io ipo ( IoHubvilin s lIoHubvilin, # yp: ino ) xp xpion: # p: no ov lIoHubvilin = Non # yp: ino lss Subvilin: syn f onn(slf) -> Non: lo.info("[Io] Sub lin onn") syn f snss(slf, ss: s) -> Non: lo.info("[->Io] %s", ss[:200]) syn f shuown(slf) -> Non: lo.info("[Io] Sub lin shuown") lss IoHubvilinFoy: @siho f foonnionsin(onnionsin: s): if lIoHubvilin is no Non: un lIoHubvilin.foonnionsin(onnionsin) # yp: ino[no-ny-un] un Subvilin() f vilin(onnionsin: Opionl[s] = Non): s = onnionsin o os.nv("ZUIOHUBVIONNIONSIN") if no s: lo.wnin( "[WN] No Io Hub vi onnion sin foun. Usin sub lin." ) un Subvilin() if lIoHubvilin is Non: lo.wnin("[WN] zu-io-vi no insll. Usin sub lin.") un Subvilin() un IoHubvilinFoy.foonnionsin(s) syn f soplfo( fohs: synIo[i[s, ny]], vilin: Opionl[ny] = Non, invlsons: flo = 0.0039, ) -> Non: """ S  spls o Io Hub. 256 Hz splin ~ vy 3.9 s. fohs: syn io yilin i spls (JSON-silizbl) """ lin = vilin o vilin() wi lin.onn() y: syn fo spl in fohs: wi lin.snss(json.ups(spl)) wi synio.slp(invlsons) finlly: wi lin.shuown()