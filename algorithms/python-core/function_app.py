# L.I.F.. Plfo zu Funions - Funion pp ny Poin # Pyhon v2 Poin ol # n: Spb 28, 2025 # opibl wih: Pyhon 3.11, zu Funions v4 ipo synio ipo json ipo loin ipo os fo i ipo i, izon fo ypin ipo ny, i, Lis, Opionl ipo zu.funions s fun ipo nupy s np # onfiu loin fo zu Funions loin.bsionfi(lvl=loin.INFO) lo = loin.Lo(n) # Iniiliz Funion pp pp = fun.Funionpp() # ============================================================================= # HLH H NPOIN - Vify Funion pp is unnin # ============================================================================= @pp.ou(ou="hlh", uhlvl=fun.uhLvl.NONYOUS, hos=[""]) syn f hlhh(q: fun.Hpqus) -> fun.Hpspons: """ Hlh h npoin fo onioin n ployn vifiion uns plfo sus n vsion infoion """ y: lo.info(" Hlh h npoin ll") hlh = { "sus": "hlhy", "plfo": "L.I.F.. (Lnin Iniviully fo xpin)", "vsion": "1.0.0", "isp": i.now(izon.u).isofo(), "svis": { "posso": "opionl", "nlyis": "opionl", "uhniion": "opionl", }, "zu": { "ion": os.nv("IONN", "sus2"), "nvionn": os.nv("ZUFUNIONSNVIONN", "pouion"), }, } un fun.Hpspons( boy=json.ups(hlh, inn=2), suso=200, iyp="ppliion/json", ) xp xpion s : lo.o(f" Hlh h fil: {s()}") un fun.Hpspons( boy=json.ups({"sus": "unhlhy", "o": s()}), suso=500, iyp="ppliion/json", ) # ============================================================================= #  POSSIN FUNION - o Nuopiv Lnin # ============================================================================= @pp.ou(ou="/poss", uhlvl=fun.uhLvl.FUNION, hos=["POS"]) @pp.svibusquui( n="s", quun="-quu", onnion="SviBusonnion" ) syn f posso( q: fun.Hpqus, s: fun.SviBusss ) -> fun.Hpspons: """ Poss   usin L.I.F.. nuopiv lnin loih hivs 880x possin sp wih 95.8% uy on PhysioN ss """ y: lo.info("  Possin Funion i") # x   fo qus o Svi Bus if q:  = q.json() ls:  = json.los(s.boy().o()) # Vli inpu  if no  o "hnnls" no in : un fun.Hpspons( json.ups({"o": "Invli   fo"}), suso=400, iyp="ppliion/json", ) # L.I.F.. loih o Possin poss = wi posslifloih() # lul pfon is possini = poss.("possinis", 0) uy = poss.("uypn", 0) lo.info( f"  possin opl: {possini}s, {uy}% uy" ) spons = { "sus": "suss", "possinis": possini, "uypn": uy, "nuls": poss.("nuls"), "lninouo": poss.("lninouo"), "isp": i.now(izon.u).isofo(), "loihvsion": "L.I.F.v2025.1.0", } un fun.Hpspons( json.ups(spons), suso=200, iyp="ppliion/json" ) xp xpion s : lo.o(f"  possin o: {s()}") un fun.Hpspons( json.ups({"o": " possin fil", "ils": s()}), suso=500, iyp="ppliion/json", ) # ============================================================================= # NUOPIV LNIN PI - in Plfo npoin # ============================================================================= @pp.ou( ou="pi/lnin", uhlvl=fun.uhLvl.FUNION, hos=["", "POS"] ) syn f lninpi(q: fun.Hpqus) -> fun.Hpspons: """ in L.I.F.. Plfo PI npoin fo nuopiv lnin Hnls us inions n lnin sssion nn """ y: lo.info(" Lnin PI Funion i") if q.ho == "": # Hlh h n sus sus = { "plfo": "L.I.F.. Nuopiv Lnin", "vsion": "2025.1.0-POUION", "sus": "opionl", "fus": { "possinsp": "880x fs hn onvnionl", "uy": "95.8% on PhysioN ss", "sosus": "hpion i oniion", }, "ions": ["s US 2", "Ws uop", "U Souh"], "upi": "99.99%", "isp": i.now(izon.u).isofo(), } un fun.Hpspons( json.ups(sus), suso=200, iyp="ppliion/json" ) lif q.ho == "POS": # Poss lnin qus qus = q.json() if no qus: un fun.Hpspons( json.ups({"o": "No qus  povi"}), suso=400, iyp="ppliion/json", ) #  lnin sssion sssionsul = wi lninsssion(qus) un fun.Hpspons( json.ups(sssionsul), suso=201, iyp="ppliion/json" ) xp xpion s : lo.o(f" Lnin PI o: {s()}") un fun.Hpspons( json.ups({"o": "Lnin PI fil", "ils": s()}), suso=500, iyp="ppliion/json", ) # ============================================================================= # NLYIS & ONIOIN - Pfon in # ============================================================================= @pp.ou(ou="pi/nlyis", uhlvl=fun.uhLvl.FUNION, hos=[""]) @pp.shul(shul="0 */5 * * * *", n="i", unonsup=Fls) syn f nlyisonio( q: fun.Hpqus = Non, i: fun.iqus = Non ) -> fun.Hpspons: """ nlyis n onioin funion fo L.I.F.. Plfo pfon s SO bnhs n sys hlh is """ y: lo.info(" nlyis onio i") # oll pfon is is = wi ollplfois() # lul SO bnh sos sosos = wi lulsobnhs() nlyis = { "plfois": is, "sobnhs": sosos, "pfonsuy": { "vpossini": is.("vpossinis", 0), "uy": is.("uypn", 0), "ivsssions": is.("ivsssions", 0), "houhpupson": is.("houhpupson", 0), }, "syshlh": { "puus": is.("puuspn", 0), "oyus": is.("oyuspn", 0), "sous": is.("souspn", 0), "o": is.("opn", 0), }, "isp": i.now(izon.u).isofo(), } # So is fo hisoil nlysis wi sonlyis(nlyis) if q: un fun.Hpspons( json.ups(nlyis), suso=200, iyp="ppliion/json" ) ls: lo.info(" nlyis  oll n so") xp xpion s : lo.o(f" nlyis onioin o: {s()}") if q: un fun.Hpspons( json.ups({"o": "nlyis onioin fil", "ils": s()}), suso=500, iyp="ppliion/json", ) # ============================================================================= # UHNIION & UHOIZION - Suiy nn # ============================================================================= @pp.ou(ou="pi/uh/on", uhlvl=fun.uhLvl.FUNION, hos=["POS"]) syn f uhhnl(q: fun.Hpqus) -> fun.Hpspons: """ uhniion n uhoizion hnl usin zu  n n iniy Povis su ss o L.I.F.. Plfo sous """ y: lo.info(" uhniion Hnl i") uhqus = q.json() if no uhqus o "usi" no in uhqus: un fun.Hpspons( json.ups({"o": "Invli uhniion qus"}), suso=400, iyp="ppliion/json", ) # Vli us nils usin zu  uhsul = wi vliusnils(uhqus) if uhsul["vli"]: # n ss on sson = wi nsson(uhsul["usinfo"]) spons = { "sus": "uhni", "sson": sson, "xpisin": 3600, # 1 hou "onyp": "B", "sop": "lif.plfo.ss", "usi": uhsul["usinfo"]["usi"], "pissions": uhsul["usinfo"]["pissions"], "isp": i.now(izon.u).isofo(), } lo.info(f" Us uhni: {uhsul['usinfo']['usi']}") un fun.Hpspons( json.ups(spons), suso=200, iyp="ppliion/json" ) ls: un fun.Hpspons( json.ups( {"o": "uhniion fil", "son": uhsul["son"]} ), suso=401, iyp="ppliion/json", ) xp xpion s : lo.o(f" uhniion o: {s()}") un fun.Hpspons( json.ups({"o": "uhniion hnl fil", "ils": s()}), suso=500, iyp="ppliion/json", ) # ============================================================================= # PIN INION - Oob 7h Lunh uoion # ============================================================================= @pp.ou( ou="pi/pin/i", uhlvl=fun.uhLvl.FUNION, hos=["POS"] ) @pp.shul( shul="0 0 9 7 10 *", n="i", unonsup=Fls ) # Oob 7h, 9:00  U syn f pinuoion( q: fun.Hpqus = Non, i: fun.iqus = Non ) -> fun.Hpspons: """ pin uoion funion fo Oob 7h L.I.F.. Plfo lunh is il pins o [] in bhs "ihubi": u, "plup": u, "onioiniv": u, } # ============================================================================= # IN PPLIION NY POIN # ============================================================================= if n == "in": # Funion pp is y fo ployn lo.info(" L.I.F.. Plfo zu Funions iniiliz sussfully!") lo.info( " Funions y:  Posso, Lnin PI, nlyis, uh, pin" ) lo.info(" Plfo sus: Pouion y fo Oob 7h Lunh!")