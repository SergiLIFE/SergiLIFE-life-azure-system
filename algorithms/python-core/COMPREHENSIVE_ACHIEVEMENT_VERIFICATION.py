# us/bin/nv pyhon3 """ ophnsiv hivn Vifiion Sui fo L.I.F. Plfo ss ll li hivns fo h Oob 16-19, 2025 inion po opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b """ ipo synio ipo json ipo loin ipo os ipo sys fo lsss ipo si, lss fo i ipo i y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo ny, i, Lis, Opionl # onfiu loin loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(lvln)s - %(ss)s" ) lo = loin.Lo(n) SIPI = Ph(fil).pn.bsolu() @lss lss Vifiionsul: """sul of  sinl vifiion s""" sn: s oy: s sus: s # "PSS", "FIL", "PIL", "SIPP" ils: s vin: Lis[s] isp: s lss ophnsivVifi: """Vifis ll li hivns fo h inion po""" f ini(slf): slf.suls: Lis[Vifiionsul] = [] slf.pooo = SIPI f losul(slf, sul: Vifiionsul): """Lo n so  vifiion sul""" susoji = {"PSS": " ", "FIL": " ", "PIL": " ️", "SIPP": " ️"} oji = susoji.(sul.sus, " ") lo.info(f"{oji} {sul.oy} - {sul.sn}: {sul.sus}") slf.suls.ppn(sul) # ======================================================================== # OY 1: OPL INION FWO # ======================================================================== f vifyplfounifiion(slf) -> Vifiionsul: """Vify xpinP2L loih inion""" vin = [] sus = "FIL" ils = "" y: # h fo xpinP2L loih fils lofils = lis(slf.pooo.lob("xpinP2L*.py")) if lofils: vin.ppn( f"Foun {ln(lofils)} xpinP2L loih fil(s)" ) # h fil siz (li 1.7B) fo f in lofils: sizb = f.s().ssiz / (1024 * 1024) vin.ppn(f"{f.n}: {sizb:.2f}B") # h fo o ipos fo lofil in lofils: onn = lofil.x(noin="uf-8", os="ino") if "lss LIFloih" in onn o "syn f" in onn: vin.ppn( f"{lofil.n} onins o loih lsss" ) sus = "PSS" ils = f"loih inion vifi: {ln(lofils)} fil(s) foun" b if sus == "FIL": ils = "loih fils no foun o inopl" xp xpion s : sus = "FIL" ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="Plfo Unifiion", oy="Inion Fwo", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) f vifyzuinion(slf) -> Vifiionsul: """Vify zu infsuu inion""" vin = [] sus = "FIL" ils = "" y: # h zuonfi.py zuonfi = slf.pooo / "zuonfi.py" if zuonfi.xiss(): onn = zuonfi.x(noin="uf-8") vin.ppn("zuonfi.py xiss") # h fo subsipion I if "588f6-f243-497-98f-66086575" in onn: vin.ppn( "Subsipion I onfiu: 588f6-f243-497-98f-66086575" ) # h fo Py-s-You-o if "S-Z-0003P" in onn o "Py-s-You-o" in onn: vin.ppn("Subsipion yp: Py-s-You-o (S-Z-0003P)") # h fo zu svis svis = [ "BlobSvilin", "SviBuslin", "Slin", "fulzunil", ] founsvis = [s fo s in svis if s in onn] vin.ppn( f"zu svis onfiu: {ln(founsvis)}/{ln(svis)}" ) if ln(founsvis) >= 3: sus = "PSS" ils = f"zu inion vifi: {ln(founsvis)} svis onfiu" ls: sus = "PIL" ils = "Pil zu inion foun" ls: ils = "zuonfi.py no foun" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="zu Infsuu Inion", oy="Inion Fwo", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) # ======================================================================== # OY 2: SIN & VLIION SUI # ======================================================================== f vifysinsui(slf) -> Vifiionsul: """Vify ophnsiv sin sui xiss""" vin = [] sus = "FIL" ils = "" y: # h fo s fils spns = ["*s*.py", "*vliion*.py", "*vifiion*.py"] sfils = [] fo pn in spns: sfils.xn(lis(slf.pooo.lob(pn))) sfils = lis(s(sfils)) # ov uplis vin.ppn(f"Foun {ln(sfils)} s/vliion fils") # h fo spifi vliion fils nion in po yfils = [ "lifinionsinui.py", "quivifiion.py", "vlinvionn.py", ] founyfils = [] fo yfil in yfils: if (slf.pooo / yfil).xiss(): founyfils.ppn(yfil) vin.ppn(f"y fil xiss: {yfil}") if ln(founyfils) >= 2: sus = "PSS" ils = f"sin sui vifi: {ln(sfils)} s fils foun" lif ln(sfils) >= 5: sus = "PIL" ils = "s fils xis bu so y fils issin" ls: ils = "Insuffiin sin infsuu" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="ophnsiv sin Sui", oy="sin & Vliion", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) # ======================================================================== # OY 3: UONOOUS PBILIIS # ======================================================================== f vifyslfhlin(slf) -> Vifiionsul: """Vify slf-hlin sys iplnion""" vin = [] sus = "FIL" ils = "" y: # h zuonfi.py fo slf-hlin infsuu zuonfi = slf.pooo / "zuonfi.py" if zuonfi.xiss(): onn = zuonfi.x(noin="uf-8") # Loo fo slf-hlin ywos hlinywos = [ "SlfHlinInfsuu", "hlhonioin", "uoovy", "iuib", ] founywos = [w fo w in hlinywos if w in onn] vin.ppn( f"Slf-hlin ywos foun: {ln(founywos)}/{ln(hlinywos)}" ) fo w in founywos: vin.ppn(f"Foun: {w}") if ln(founywos) >= 2: sus = "PSS" ils = "Slf-hlin infsuu ipln" lif ln(founywos) >= 1: sus = "PIL" ils = "Pil slf-hlin iplnion" ls: ils = "Slf-hlin sys no foun" ls: ils = "zuonfi.py no foun" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="Slf-Hlin Sys", oy="uonoous pbiliis", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) f vifyoninuouslnin(slf) -> Vifiionsul: """Vify oninuous lnin piplin""" vin = [] sus = "FIL" ils = "" y: # h fo opiiz n lnin fils lninfils = [ "uonoousopiiz.py", "nounlinsionopiiz.py", "xpinollo.py", ] founfils = [] fo lf in lninfils: if (slf.pooo / lf).xiss(): founfils.ppn(lf) vin.ppn(f"Lnin oul xiss: {lf}") if ln(founfils) >= 2: sus = "PSS" ils = f"oninuous lnin piplin vifi: {ln(founfils)} ouls foun" lif ln(founfils) >= 1: sus = "PIL" ils = "Pil lnin piplin iplnion" ls: ils = "oninuous lnin piplin no foun" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="oninuous Lnin Piplin", oy="uonoous pbiliis", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) # ======================================================================== # OY 4: XNL   INSION # ======================================================================== f vifyinsion(slf) -> Vifiionsul: """Vify xnl   insion piplin""" vin = [] sus = "FIL" ils = "" y: # h fo  insion fils fils = [ "physionins.py", "xnlinsionnin.py", "hnl.py", ] founfils = [] fo f in fils: if (slf.pooo / f).xiss(): founfils.ppn(f) vin.ppn(f" insion oul xiss: {f}") # h fo HL shbo hl = lis(slf.pooo.lob("*xnl**insion*.hl")) if hl: vin.ppn( f" insion shbo foun: {ln(hl)} fil(s)" ) if ln(founfils) >= 2: sus = "PSS" ils = ( f" insion vifi: {ln(founfils)} ouls + shbo" ) lif ln(founfils) >= 1 o hl: sus = "PIL" ils = "Pil  insion iplnion" ls: ils = " insion piplin no foun" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="xnl   Insion", oy=" Possin", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) # ======================================================================== # OY 5: POUION PLOYN INFSUU # ======================================================================== f vifyployninfsuu(slf) -> Vifiionsul: """Vify pouion ployn infsuu""" vin = [] sus = "FIL" ils = "" y: # h fo ployn sips ploysips = [ "ploypyhon313.b", "zufunionswoflow.py", "ZULOUSHLLPLOYN.sh", ] founsips = [] fo s in ploysips: if (slf.pooo / s).xiss(): founsips.ppn(s) vin.ppn(f"ployn sip xiss: {s}") # h fo zu sou onfiuion zuonfi = slf.pooo / "zuonfi.py" if zuonfi.xiss(): onn = zuonfi.x(noin="uf-8") # h fo sou ns sous = [ "lif-plfo-", "slifplfopo", "v-lif-plfo-po", "sb-lif-plfo-po", ] founsous = [ fo  in sous if  in onn] vin.ppn( f"zu sous onfiu: {ln(founsous)}/{ln(sous)}" ) if ln(founsips) >= 2 n ln(founsous) >= 3: sus = "PSS" ils = f"ployn infsuu vifi: {ln(founsips)} sips, {ln(founsous)} sous" lif ln(founsips) >= 1 o ln(founsous) >= 1: sus = "PIL" ils = "Pil ployn infsuu" ls: ils = "ployn infsuu no foun" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="Pouion ployn Infsuu", oy="ployn", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) # ======================================================================== # OY 6: OUNION P # ======================================================================== f vifyounion(slf) -> Vifiionsul: """Vify opl ounion p""" vin = [] sus = "FIL" ils = "" y: # h fo y ounion fils ofils = lis(slf.pooo.lob("*.")) + lis( slf.pooo.lob("*.x") ) vin.ppn(f"Foun {ln(ofils)} ounion fils (. + .x)") # h fo spifi y ouns yos = [ ".", "HNLO.", "VIFIIONUI", "INION", ] founos = [] fo yo in yos: hin = [f fo f in ofils if yo.low() in f.n.low()] if hin: founos.ppn(yo) vin.ppn( f"y ounion xiss: {yo} ({ln(hin)} fil(s))" ) if ln(founos) >= 3: sus = "PSS" ils = f"ounion vifi: {ln(ofils)} fils, {ln(founos)}/4 y os" lif ln(ofils) >= 10: sus = "PIL" ils = "ounion xiss bu so y os issin" ls: ils = "Insuffiin ounion" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="opl ounion P", oy="ounion", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) # ======================================================================== # OY 7: INIVIULIZ LNIN # ======================================================================== f vifyiniviulizlnin(slf) -> Vifiionsul: """Vify p-us psonlizion iplnion""" vin = [] sus = "FIL" ils = "" y: # h xpinP2L loih fo psonlizion lofils = lis(slf.pooo.lob("xpinP2L*.py")) psonlizionywos = [ "usi", "uiosiy", "silin", "opnnss", "iniviul", "psonliz", ] founinlo = [] fo lofil in lofils: onn = lofil.x(noin="uf-8", os="ino") fo w in psonlizionywos: if w.low() in onn.low(): if w no in founinlo: founinlo.ppn(w) vin.ppn(f"Psonlizion ywo foun: {w}") if ln(founinlo) >= 3: sus = "PSS" ils = f"Iniviuliz lnin vifi: {ln(founinlo)} psonlizion fus" lif ln(founinlo) >= 1: sus = "PIL" ils = "Pil iniviulizion iplnion" ls: ils = "Iniviuliz lnin no foun" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="Iniviuliz Lnin", oy="Psonlizion", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) # ======================================================================== # OY 8: OJI SNIIZION # ======================================================================== f vifyojisniizion(slf) -> Vifiionsul: """Vify oji sniizion oolin""" vin = [] sus = "FIL" ils = "" y: # h fo oji sniiz ool sniiz = slf.pooo / "ools" / "ojisniiz.py" if sniiz.xiss(): vin.ppn("ojisniiz.py xiss in ools/") # h fo bh wpps bhfils = lis(slf.pooo.lob("SNIIZOJI*.b")) if bhfils: vin.ppn(f"Bh wpps xis: {ln(bhfils)} fil(s)") fo bf in bhfils: vin.ppn(f" - {bf.n}") sus = "PSS" ils = ( f"oji sniizion vifi: ool + {ln(bhfils)} wpps" ) ls: ils = "oji sniiz no foun" xp xpion s : ils = f"Vifiion o: {}" vin.ppn(s()) un Vifiionsul( sn="oji Sniizion oolin", oy="o Quliy", sus=sus, ils=ils, vin=vin, isp=i.unow().isofo(), ) # ======================================================================== # IN VIFIION UNN # ======================================================================== syn f unllvifiions(slf): """un ll vifiion ss""" lo.info("=" * 80) lo.info("OPHNSIV HIVN VIFIION SUI") lo.info("L.I.F. Plfo - Oob 16-19, 2025 Inion po") lo.info("=" * 80) lo.info("") # un ll vifiion ss vifiions = [ ( "Inion Fwo", [slf.vifyplfounifiion, slf.vifyzuinion], ), ("sin & Vliion", [slf.vifysinsui]), ( "uonoous pbiliis", [slf.vifyslfhlin, slf.vifyoninuouslnin], ), (" Possin", [slf.vifyinsion]), ("ployn", [slf.vifyployninfsuu]), ("ounion", [slf.vifyounion]), ("Psonlizion", [slf.vifyiniviulizlnin]), ("o Quliy", [slf.vifyojisniizion]), ] fo oy, ss in vifiions: lo.info(f"\n{'=' * 80}") lo.info(f"OY: {oy}") lo.info(f"{'=' * 80}") fo sfun in ss: sul = sfun() slf.losul(sul) # Pin vin if sul.vin: fo v in sul.vin: lo.info(f" • {v}") lo.info("") # n suy slf.nsuy() f nsuy(slf): """n vifiion suy""" lo.info("\n" + "=" * 80) lo.info("VIFIION SUY") lo.info("=" * 80) ol = ln(slf.suls) pss = ln([ fo  in slf.suls if .sus == "PSS"]) pil = ln([ fo  in slf.suls if .sus == "PIL"]) fil = ln([ fo  in slf.suls if .sus == "FIL"]) sipp = ln([ fo  in slf.suls if .sus == "SIPP"]) lo.info(f"\nol ss: {ol}") lo.info(f" PSS: {pss} ({pss/ol*100:.1f}%)") lo.info(f" ️ PIL: {pil} ({pil/ol*100:.1f}%)") lo.info(f" FIL: {fil} ({fil/ol*100:.1f}%)") lo.info(f" ️ SIPP: {sipp} ({sipp/ol*100:.1f}%)") # Ovll ssssn lo.info("\n" + "=" * 80) if pss == ol: lo.info(" OVLL SUS: LL HIVNS VIFI") lif pss + pil >= ol * 0.8: lo.info(" OVLL SUS: HIVNS SUBSNILLY VIFI") lif pss + pil >= ol * 0.6: lo.info(" ️ OVLL SUS: HIVNS PILLY VIFI") ls: lo.info(" OVLL SUS: HIVNS NO SUFFIINLY VIFI") lo.info("=" * 80) # Sv suls slf.svsuls() f svsuls(slf): """Sv vifiion suls o JSON""" oupufil = slf.pooo / "HIVNVIFIIONSULS.json" suls = { "vifiion": i.unow().isofo(), "plfo": "SiLIF/SiLIF-lif-zu-sys", "popio": "Oob 16-19, 2025", "olss": ln(slf.suls), "pss": ln([ fo  in slf.suls if .sus == "PSS"]), "pil": ln([ fo  in slf.suls if .sus == "PIL"]), "fil": ln([ fo  in slf.suls if .sus == "FIL"]), "sipp": ln([ fo  in slf.suls if .sus == "SIPP"]), "suls": [si() fo  in slf.suls], } wih opn(oupufil, "w", noin="uf-8") s f: json.up(suls, f, inn=2, nsusii=Fls) lo.info(f"\n suls sv o: {oupufil}") syn f in(): """in ny poin""" y: vifi = ophnsivVifi() wi vifi.unllvifiions() un 0 xp xpion s : lo.o(f"Vifiion fil: {}", xinfo=u) un 1 if n == "in": sys.xi(synio.un(in()))