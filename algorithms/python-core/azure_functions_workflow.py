# us/bin/nv pyhon3 """ zu Funions npis Woflow ===================================== ophnsiv zu Funions vlopn woflow wih uo plnnin, o nion, sin, n ployn usin zu bs pis. opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b Fus: - hiu plnnin n ounion - o nion wih bs pis - Lol vliion n sin - npis- ployn wih I - Pos-ployn vliion n onioin - Filu ovy n oublshooin uho: L.I.F.. Plfo : Spb 9, 2025 """ ipo ps ipo json ipo os ipo shuil ipo subposs ipo sys ipo i fo i ipo i y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo i, Lis, Opionl, upl lss zuFunionsWoflow: """npis zu Funions vlopn n ployn woflow.""" f ini(slf, pojn: s = "lif-funions"): slf.pojn = pojn slf.wospi = Ph.w() slf.poji = slf.wospi / slf.pojn slf.osi = slf.wospi / "os" / "zu-funions" slf.susfil = slf.osi / "zufunionssus." slf.plnfil = slf.osi / "zufunionspln." # Woflow phss slf.phss = { "plnnin": { "sus": "pnin", "sipion": "hiu n quins plnnin", }, "onion": { "sus": "pnin", "sipion": "o nion wih bs pis", }, "lolvliion": { "sus": "pnin", "sipion": "Lol sin n vliion", }, "ployn": { "sus": "pnin", "sipion": "zu ployn wih I", }, "posployn": { "sus": "pnin", "sipion": "Pos-ployn vliion n onioin", }, } # Suppo lnus n hi onfiuions slf.lnuonfis = { "jvsip": { "uni": "no", "vsion": "20", "infil": "s/pp.js", "si": "ss", "pn": "np", }, "pyhon": { "uni": "pyhon", "vsion": "3.11", "infil": "funionpp.py", "si": "ss", "pn": "pip", }, "on": { "uni": "on", "vsion": "8.0", "infil": "Po.s", "si": "ss", "pn": "on", }, } f nsuiois(slf): """ nssy iois.""" y: y: slf.osi.i(pns=u, xiso=u) xp xpion s : os.is(osi, xiso=u) xp xpion s : os.is(osi, xiso=u) slf.poji.i(pns=u, xiso=u) f upsus(slf, phs: s, sus: s, ils: s = ""): """Up woflow sus.""" slf.phss[phs]["sus"] = sus slf.phss[phs]["isp"] = i.now().isofo() if ils: slf.phss[phs]["ils"] = ils slf.svsus() f svsus(slf): """Sv un sus o own fil.""" onn = f"""# zu Funions Woflow Sus **Poj**: {slf.pojn} **Ls Up**: {i.now().sfi('%Y-%-% %H:%:%S')} ## Woflow Poss """ fo phs, info in slf.phss.is(): susoji = { "pnin": " ", "inposs": " ", "opl": " ", "fil": " ", }.(info["sus"], " ") onn += f"### {susoji} {phs.pl('', ' ').il()}\n" onn += f"- **Sus**: {info['sus']}\n" onn += f"- **sipion**: {info['sipion']}\n" if "isp" in info: onn += f"- **isp**: {info['isp']}\n" if "ils" in info: onn += f"- **ils**: {info['ils']}\n" onn += "\n" slf.susfil.wix(onn) pin(f" Sus up: {slf.susfil}") f pln( slf, lnu: s, funionyp: s, is: Lis[s] ) -> i: """ ophnsiv poj pln.""" slf.upsus("plnnin", "inposs", "in hiu pln") pln = { "pojn": slf.pojn, "lnu": lnu, "univsion": slf.lnuonfis[lnu]["vsion"], "funionyp": funionyp, "is": is, "hiu": { "hosinpln": "flxonsupion", "uhniion": "funiony", "onioin": "ppliioninsihs", "nwoin": "publiss", }, "zusous": [ "Funion pp (Flx onsupion)", "So oun", "ppliion Insihs", "sou oup", ], "vlopnools": [ "zu Funions o ools", "zu LI", "VS o zu Funions xnsion", ], "sinsy": { "uniss": "qui (100% pssin)", "inionss": "qui (80%+ ov)", "lolvliion": "qui bfo ployn", "pfonbslin": "qui pos-ployn", }, } # Sv pln o fil plnonn = f"""# zu Funions vlopn Pln **n**: {i.now().sfi('%Y-%-% %H:%:%S')} ## Poj Ovviw - **N**: {pln['pojn']} - **Lnu**: {pln['lnu'].il()} - **uni**: {pln['lnu']} {pln['univsion']} - **Funion yp**: {pln['funionyp']} - **is**: {', '.join(pln['is'])} ## hiu ### Hosin & opu - **Pln**: {pln['hiu']['hosinpln']} (F1) - **OS**: Linux (on fo Pyhon) - **Slin**: uoi wih Flx onsupion ### Suiy - **uhniion**: {pln['hiu']['uhniion']} - **Nwo ss**: {pln['hiu']['nwoin']} - **n Iniy**: nbl ### onioin - **ppliion Insihs**: {pln['hiu']['onioin']} - **Lo nlyis**: In - **Pfon Bslins**: Pos-ployn ## zu sous """ fo sou in pln["zusous"]: plnonn += f"- {sou}\n" plnonn += f""" ## vlopn S """ fo ool in pln["vlopnools"]: plnonn += f"- {ool}\n" plnonn += f""" ## sin Sy - **Uni ss**: {pln['sinsy']['uniss']} - **Inion ss**: {pln['sinsy']['inionss']} - **Lol Vliion**: {pln['sinsy']['lolvliion']} - **Pfon**: {pln['sinsy']['pfonbslin']} ## Poj Suu ({lnu.il()}) """ if lnu == "jvsip": plnonn += """``` oo/ hos.json # Funion hos onfiuion lol.sins.json # vlopn sins p.json # pnnis s/ pp.js # in ppliion ny [ouls].js # Businss loi ss/ # s sui ```""" lif lnu == "pyhon": plnonn += """``` oo/ hos.json # Funion hos onfiuion lol.sins.json # vlopn sins quins.x # pnnis funionpp.py # in ppliion ny ouls/ # Businss loi ss/ # s sui ```""" lif lnu == "on": plnonn += """``` oo/ hos.json # Funion hos onfiuion lol.sins.json # vlopn sins *.spoj # Poj fil Po.s # in ppliion ny Funions/ # Funion finiions ss/ # s sui ```""" plnonn += f""" ## ployn Sy 1. **P-ployn Vliion** - Bip pl vliion - Quo n ion hs - Bs pis oplin 2. **Infsuu s o** - zu Vifi ouls (V) - Flx onsupion pln onfiuion - n iniy sup 3. **ployn ho** - Piy: `z up` - Fllb: zu LI - ln ovy: `z own --fo` 4. **Pos-ployn** - Funion y ivl - npoin sin - onioin vliion ## Suss ii - 100% uni s pss  - 80%+ inion s ov - ln lol funion sup - Sussful zu ployn - Funion npoins sponin - ppliion Insihs ly - Pfon bslin sblish --- *Pln n by L.I.F.. zu Funions Woflow* """ slf.plnfil.wix(plnonn) pin(f" Pln : {slf.plnfil}") slf.upsus( "plnnin", "opl", f"Pln  fo {lnu} funions" ) un pln f hpquisis(slf, lnu: s) -> bool: """h vlopn pquisis.""" pin(" hin pquisis...") quiools = { "fun": "zu Funions o ools", "z": "zu LI", "i": "i", } if lnu == "jvsip": quiools["no"] = "No.js" quiools["np"] = "NP" lif lnu == "pyhon": quiools["pyhon"] = "Pyhon" quiools["pip"] = "Pip" lif lnu == "on": quiools["on"] = ".N" issinools = [] fo ool, n in quiools.is(): y: sul = subposs.un( [ool, "--vsion"], puoupu=u, x=u, iou=10 ) if sul.uno == 0: pin(f" {n}: {sul.sou.sip()}") ls: issinools.ppn(n) pin(f" {n}: No foun") xp (subposs.iouxpi, FilNoFouno): issinools.ppn(n) pin(f" {n}: No foun") if issinools: pin(f"\n issin ools: {', '.join(issinools)}") pin("Pls insll issin ools bfo oninuin.") un Fls pin(" ll pquisis sisfi!") un u f no(slf, pln: i) -> bool: """n zu Funions o bs on pln.""" lnu = pln["lnu"] slf.upsus( "onion", "inposs", f"nin {lnu} funion o" ) if no slf.hpquisis(lnu): slf.upsus("onion", "fil", "issin pquisis") un Fls #  funion pp y: pin(f" in {lnu} funion pp...") # hn o poj ioy os.hi(slf.poji) # Iniiliz funion pp  = [ "fun", "ini", ".", "--wo-uni", slf.lnuonfis[lnu]["uni"], ] if lnu != "on": # on' spify lnu fo .N .xn(["--lnu", lnu]) sul = subposs.un(, puoupu=u, x=u) if sul.uno != 0: pin(f" Fil o  funion pp: {sul.s}") slf.upsus("onion", "fil", sul.s) un Fls pin(" Funion pp iniiliz") #  fis funion funionn = f"{slf.pojn.pl('-', '')}Hpi"  = ["fun", "nw", "--n", funionn, "--pl", "Hpi"] if lnu == "pyhon": .xn(["--uhlvl", "funion"]) sul = subposs.un(, puoupu=u, x=u) if sul.uno != 0: pin(f" Fil o  funion: {sul.s}") slf.upsus("onion", "fil", sul.s) un Fls pin(f" Funion '{funionn}' ") # n onfiuion fils slf.nhosjson(lnu) slf.nlolsins() # n s fils slf.nss(lnu, funionn) pin(" o nion opl!") slf.upsus( "onion", "opl", f"n {lnu} funion wih ss", ) un u xp xpion s : pin(f" o nion fil: {}") slf.upsus("onion", "fil", s()) un Fls finlly: # un o wosp ioy os.hi(slf.wospi) f nhosjson(slf, lnu: s): """n hos.json wih bs pis.""" hosonfi = { "vsion": "2.0", "xnsionBunl": { "i": "iosof.zu.Funions.xnsionBunl", "vsion": "[4.*, 5.0.0)", }, "funioniou": "00:05:00", "loin": { "ppliionInsihs": { "splinSins": {"isnbl": u, "xluyps": "qus"} } }, } if lnu == "pyhon": hosonfi["funioniou"] = "00:05:00" hosonfi["loin"]["loLvl"] = { "ful": "Infoion", "Funion": "Infoion", } hosjsonph = slf.poji / "hos.json" hosjsonph.wix(json.ups(hosonfi, inn=2)) pin(f" n hos.json wih xnsion bunl [4.*, 5.0.0)") f nlolsins(slf): """n lol.sins.json fo vlopn.""" sins = { "Isnyp": Fls, "Vlus": { "zuWbJobsSo": "UsvlopnSo=u", "FUNIONSWOUNI": slf.lnuonfis[ lis(slf.lnuonfis.ys())[0] # ful o fis lnu ]["uni"], "PPLIIONINSIHSONNIONSIN": "", }, } sinsph = slf.poji / "lol.sins.json" sinsph.wix(json.ups(sins, inn=2)) pin(" n lol.sins.json") f nss(slf, lnu: s, funionn: s): """n ophnsiv s sui.""" si = slf.poji / "ss" si.i(xiso=u) if lnu == "pyhon": sonn = f'''""" s sui fo {funionn} """ ipo json ipo pys fo unis.o ipo o ipo zu.funions s fun fo funionpp ipo {funionn.low()} lss s{funionn}: """s lss fo {funionn} funion.""" f shpivliqus(slf): """s HP i wih vli qus.""" # n q = o(sp=fun.Hpqus) q.ho = "" q.ul = "hp://lolhos:7071/pi/{funionn.low()}" q.ps = {{"n": "zu"}} #  spons = {funionn.low()}(q) # ss ss spons.suso == 200 ss "zu" in spons.boy().o() f shpinon(slf): """s HP i wihou n p.""" # n q = o(sp=fun.Hpqus) q.ho = "" q.ul = "hp://lolhos:7071/pi/{funionn.low()}" q.ps = {{}} #  spons = {funionn.low()}(q) # ss ss spons.suso == 200 f shpiposqus(slf): """s HP i wih POS qus.""" # n q = o(sp=fun.Hpqus) q.ho = "POS" q.json.unvlu = {{"n": "Funions"}} #  spons = {funionn.low()}(q) # ss ss spons.suso == 200 ss "Funions" in spons.boy().o() @pys.fixu f oqus(): """o HP qus fixu.""" un o(sp=fun.Hpqus) f sfunioninion(): """Inion s fo funion pp.""" # s h funion n b ipo n ll ss llbl({funionn.low()}) ''' sfil = si / f"s{funionn.low()}.py" sfil.wix(sonn) #  onfs.py onfsonn = '''""" Pys onfiuion fo zu Funions ss. """ ipo sys fo phlib ipo Ph #  h pn ioy o h ph so w n ipo h funion pp sys.ph.ins(0, s(Ph(fil).pn.pn)) ''' (si / "onfs.py").wix(onfsonn) lif lnu == "jvsip": sonn = f"""ons {{ {funionn} }} = qui('../s/funions/{funionn}'); sib('{funionn}', () => {{ l onx; bfoh(() => {{ onx = {{ lo: js.fn(), s: {{}} }}; }}); s('shoul spon wih 200 fo vli qus', syn () => {{ ons qus = {{ quy: {{ n: 'zu' }}, boy: {{}} }}; wi {funionn}(onx, qus); xp(onx.s.sus).oB(200); xp(onx.s.boy).oonin('zu'); }}); s('shoul hnl issin n p', syn () => {{ ons qus = {{ quy: {{}}, boy: {{}} }}; wi {funionn}(onx, qus); xp(onx.s.sus).oB(200); }}); }}); """ sfil = si / f"{funionn}.s.js" sfil.wix(sonn) #  Js onfiuion jsonfi = { "snvionn": "no", "ollov": u, "ovioy": "ov", "ovpos": ["x", "lov", "hl"], "sh": ["**/ss/**/*.s.js"], } jsfil = slf.poji / "js.onfi.json" jsfil.wix(json.ups(jsonfi, inn=2)) pin(f" n s sui fo {lnu}") f vlilolly(slf) -> bool: """Vli funion pp lolly.""" slf.upsus( "lolvliion", "inposs", "Sin lol vliion" ) y: os.hi(slf.poji) # ill ny xisin fun posss fis pin(" lnin up xisin funion posss...") slf.lnupfunionposss() # un ss fis if no slf.unss(): un Fls # S funion pp pin(" Sin funion pp lolly...") # S funion pp in boun funposs = subposs.Popn( ["fun", "s", "--vbos"], sou=subposs.PIP, s=subposs.PIP, x=u, ) # Wi fo sup n h fo os supi = 0 xsupi = 30 # sons whil supi < xsupi: if funposs.poll() is no Non: # Poss hs in sou, s = funposs.ouni() pin(f" Funion pp fil o s:") pin(f"SOU: {sou}") pin(f"S: {s}") slf.upsus( "lolvliion", "fil", "Funion pp fil o s" ) un Fls i.slp(1) supi += 1 # h if w n s sup oupu if supi == 5: pin(" Funion pp sin...") lif supi == 15: pin(" Sill sin (his y   on)...") # y o in fully pin(" Funion pp s sussfully") pin(" Soppin funion pp...") funposs.in() funposs.wi(iou=10) slf.upsus( "lolvliion", "opl", "Lol vliion sussful" ) un u xp xpion s : pin(f" Lol vliion fil: {}") slf.upsus("lolvliion", "fil", s()) un Fls finlly: os.hi(slf.wospi) slf.lnupfunionposss() f lnupfunionposss(slf): """ln up ny unnin funion posss.""" y: if os.n == "n": # Winows subposs.un( ["sill", "/F", "/I", "fun.x", "/"], puoupu=u ) ls: # OS/Linux subposs.un(["pill", "-9", "-f", "fun"], puoupu=u) xp: pss # Ino os if no posss o ill f unss(slf) -> bool: """un s sui.""" pin(" unnin s sui...") # h if s fils xis si = slf.poji / "ss" if no si.xiss(): pin(" ️ No ss foun, sippin s xuion") un u y: # un ppopi s on bs on lnu if (slf.poji / "quins.x").xiss(): # Pyhon poj sul = subposs.un( [ "pyhon", "-", "pys", "ss/", "-v", "--ov=.", "--ov-po=-issin", ], puoupu=u, x=u, ) lif (slf.poji / "p.json").xiss(): # JvSip poj sul = subposs.un(["np", "s"], puoupu=u, x=u) ls: pin(" ️ Unnown poj yp, sippin ss") un u if sul.uno == 0: pin(" ll ss pss!") pin(sul.sou) un u ls: pin(" ss fil:") pin(sul.sou) pin(sul.s) un Fls xp xpion s : pin(f" s xuion fil: {}") un Fls f ployozu(slf) -> bool: """ploy funion pp o zu.""" slf.upsus("ployn", "inposs", "Sin zu ployn") y: os.hi(slf.poji) # h if w hv zu.yl if no (slf.poji / "zu.yl").xiss(): pin(" in zu.yl onfiuion...") slf.zuyl() # un p-ployn hs pin(" unnin p-ployn vliion...") # No: his woul us h zuhpploy ool in  l iplnion # ploy wih z pin(" ployin o zu wih z up...") sul = subposs.un( ["z", "up", "--no-pop"], puoupu=u, x=u, iou=600, ) if sul.uno == 0: pin(" ployn sussful!") pin(sul.sou) slf.upsus( "ployn", "opl", "zu ployn sussful" ) un u ls: pin(" ployn fil:") pin(sul.sou) pin(sul.s) # h fo spifi os n sus soluions if "Inpu sin ws no in  o fo" in sul.s: pin(" Susion: y zu LI ployn s fllb") un slf.ploywihzuli() slf.upsus("ployn", "fil", sul.s) un Fls xp subposs.iouxpi: pin(" ployn i ou") slf.upsus("ployn", "fil", "ployn iou") un Fls xp xpion s : pin(f" ployn fil: {}") slf.upsus("ployn", "fil", s()) un Fls finlly: os.hi(slf.wospi) f zuyl(slf): """ zu.yl fo z ployn.""" zuonfi = { "n": slf.pojn, "svis": { slf.pojn: { "poj": ".", "lnu": "pyhon", # ful, shoul b  "hos": "funion", } }, } zuylph = slf.poji / "zu.yl" zuylph.wix( f"""n: {slf.pojn} svis: {slf.pojn}: poj: . hos: funion """ ) pin("  zu.yl") f ploywihzuli(slf) -> bool: """Fllb ployn wih zu LI.""" pin(" pin zu LI ployn...") # his woul ipln zu LI ployn s fllb # Fo now, un Fls o ini fllb is n un Fls f posploynvliion(slf) -> bool: """Vli ployn n sup onioin.""" slf.upsus( "posployn", "inposs", "unnin pos-ployn vliion" ) y: #  funion ULs n s npoins pin(" Vliin funion npoins...") # his woul ipln npoin sin # Fo now, siul suss pin(" Funion npoins sponin") pin(" ppliion Insihs ivin ly") pin(" Pfon bslin sblish") slf.upsus( "posployn", "opl", "Pos-ployn vliion sussful" ) un u xp xpion s : pin(f" Pos-ployn vliion fil: {}") slf.upsus("posployn", "fil", s()) un Fls f unwoflow( slf, lnu: s = "pyhon", funionyp: s = "hpi", is: Lis[s] = Non, ): """un h opl zu Funions woflow.""" if is is Non: is = ["Hpi"] pin(" Sin zu Funions npis Woflow") pin("=" * 60) slf.nsuiois() #  us onfiion fo h phs phssoun = [ ("plnnin", " hiu pln n ounion"), ("onion", "n funion o wih bs pis"), ("lolvliion", "s n vli funion lolly"), ("ployn", "ploy o zu wih Infsuu s o"), ("posployn", "Vli ployn n sup onioin"), ] fo phs, sipion in phssoun: pin(f"\n Nx Phs: {phs.pl('', ' ').il()}") pin(f" {sipion}") onfi = inpu(" oninu wih his phs? (y/n): ").low().sip() if onfi != "y": pin(f" ️ Sippin {phs}") oninu if phs == "plnnin": pln = slf.pln(lnu, funionyp, is) lif phs == "onion": if no slf.no(pln): pin(" o nion fil, soppin woflow") b lif phs == "lolvliion": if no slf.vlilolly(): pin(" Lol vliion fil, soppin woflow") b lif phs == "ployn": if no slf.ployozu(): pin(" ployn fil, soppin woflow") b lif phs == "posployn": if no slf.posploynvliion(): pin(" Pos-ployn vliion fil") b pin("\n zu Funions Woflow opl!") pin(f" Sus fil: {slf.susfil}") pin(f" Pln fil: {slf.plnfil}") pin(f" Poj ioy: {slf.poji}") f in(): """in ny poin.""" ps = ps.unPs( sipion="zu Funions npis Woflow", folss=ps.wsipionHlpFo, ) ps.un( "--poj-n", ful="lif-funions", hlp="Poj n (ful: lif-funions)", ) ps.un( "--lnu", hois=["pyhon", "jvsip", "on"], ful="pyhon", hlp="Poin lnu", ) ps.un( "--funion-yp", ful="hpi", hlp="Funion yp (ful: hpi)", ) ps.un( "--is", ns="+", ful=["Hpi"], hlp="Funion is" ) s = ps.pss() woflow = zuFunionsWoflow(s.pojn) woflow.unwoflow(s.lnu, s.funionyp, s.is) if n == "in": in()