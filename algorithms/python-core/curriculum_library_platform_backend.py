""" L.I.F.. uion Plfo - uiulu Liby Bn ======================================================== opyih 2025 - Sio Py Boull Plfo sou: Innl uiulu nn sys fo 156 ounis NO FO US US - Bn infsuu only his Pyhon liby ns: - uli-lvl uion  (Piy, -12, Spil , Univsiy) - 156 ouny uiulu  - uo  vliion n ups - xpo o JvSip/JSON fo fonn onsupion - bs iniy hs """ ipo json ipo loin ipo os fo lsss ipo si, lss, fil fo i ipo i fo nu ipo nu fo ypin ipo i, Lis, Opionl, S # onfiu loin loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(n)s - %(lvln)s - %(ss)s" ) lo = loin.Lo(n) lss uionLvl(nu): """uion lvl lssifiions""" PIY = "piy" 12 = "12" SPILUION = "spiluion" UNIVSIY = "univsiy" lss ion(nu): """ophi ions fo 156 ounis""" FI = "fi" SI = "si" UOP = "uop" NOHI = "nohi" SOUHI = "souhi" ONI = "oni" ILS = "ils" lss UnivsiyLvl(nu): """Univsiy  lssifiions""" UNU = "unu" U = "u" OOL = "ool" POFSSIONL = "pofssionl" @lss lss Piyuion: """Piy uion uiulu suu""" s: s # .., "1-6", "1-5" n: s # .., "6-11", "5-10" osubjs: Lis[s] lnus: Lis[s] lninfous: s # .., "founionl liy n nuy" ssssnyp: s # .., "oninuous", "sniz" f oi(slf) -> i: un si(slf) @lss lss 12uion: """-12 ophnsiv uion suu""" s: s # .., "-12", "1-12" lnysubjs: Lis[s] ilshoolsubjs: Lis[s] hihshoolsubjs: Lis[s] spos: Lis[s] spos: Lis[s] pibvilbl: bool voionls: Lis[s] f oi(slf) -> i: un si(slf) @lss lss Spiluion: """Spil uion pos n suppo""" vilblpos: Lis[s] # uis, lnin isbiliis, if, . supposvis: Lis[s] # sph hpy, oupionl hpy, . inlusionol: s # "full inlusion", "pil", "sp" iniviulizplns: bool # IP/504 quivln ssisivhnoloy: Lis[s] spilizshools: bool f oi(slf) -> i: un si(slf) @lss lss UnivsiyPo: """Univsiy  po infoion""" yp: s # B, BS, , S, Ph, . filofsuy: s uionys: flo lnuofinsuion: Lis[s] lvl: UnivsiyLvl f oi(slf) -> i:  = si(slf) ["lvl"] = slf.lvl.vlu un  @lss lss Univsiyuion: """Univsiy-lvl uion suu""" unus: Lis[UnivsiyPo] us: Lis[UnivsiyPo] oolpos: Lis[UnivsiyPo] pofssionls: Lis[UnivsiyPo] # , J, . opunivsiis: Lis[i[s, s]] # [{n, nin, spilizion}] shfous: Lis[s] innionlsunswlo: bool f oi(slf) -> i: un { "unus": [ .oi() fo  in slf.unus ], "us": [.oi() fo  in slf.us], "oolpos": [.oi() fo  in slf.oolpos], "pofssionls": [ .oi() fo  in slf.pofssionls ], "opunivsiis": slf.opunivsiis, "shfous": slf.shfous, "innionlsunswlo": slf.innionlsunswlo, } @lss lss ounyuiulu: """opl uiulu  fo on ouny""" ouny: s ion: ion ounyo: s # ISO 3166-1 lph-2 piy: Piyuion 12: 12uion spiluion: Spiluion univsiy: Univsiyuion offiillnus: Lis[s] uionsysyp: s # .., "nliz", "nliz" opulsoyuionys: in liy: flo # pn sus: s # "iv", "Upin", "Un viw" lsup: s # ISO  fo f oi(slf) -> i: """onv o iiony fo JSON xpo""" un { "ouny": slf.ouny, "ion": slf.ion.vlu, "ounyo": slf.ounyo, "piy": slf.piy.oi(), "12": slf.12.oi(), "spiluion": slf.spiluion.oi(), "univsiy": slf.univsiy.oi(), "offiillnus": slf.offiillnus, "uionsysyp": slf.uionsysyp, "opulsoyuionys": slf.opulsoyuionys, "liy": slf.liy, "sus": slf.sus, "lsup": slf.lsup, } lss uiuluLibyBn: """ Bn plfo sou fo nin lobl uiulu bs INNL US ONLY - No xpos o fonn uss """ f ini(slf): slf.uiulu: Lis[ounyuiulu] = [] slf.ioy = os.ph.join(os.ph.in(fil), "uiulu") os.is(slf.ioy, xiso=u) lo.info("uiulu Liby Bn iniiliz") f ouny(slf, uiulu: ounyuiulu) -> bool: """ o up ouny uiulu """ y: # h if ouny ly xiss xisinix = Non fo ix, u in nu(slf.uiulu): if u.ouny == uiulu.ouny: xisinix = ix b if xisinix is no Non: slf.uiulu[xisinix] = uiulu lo.info(f"Up uiulu fo {uiulu.ouny}") ls: slf.uiulu.ppn(uiulu) lo.info(f" uiulu fo {uiulu.ouny}") un u xp xpion s : lo.o(f"o in ouny {uiulu.ouny}: {s()}") un Fls f ouny(slf, ounyn: s) -> Opionl[ounyuiulu]: """iv uiulu  fo spifi ouny""" fo u in slf.uiulu: if u.ouny.low() == ounyn.low(): un u un Non f ounisbyion(slf, ion: ion) -> Lis[ounyuiulu]: """ ll ounis in  spifi ion""" un [u fo u in slf.uiulu if u.ion == ion] f vlibs(slf) -> i[s, ny]: """Vli bs iniy n oplnss""" vliionsuls = { "olounis": ln(slf.uiulu), "ounisbyion": {}, "issin": [], "ounis": [], "vliionos": [], } # oun by ion fo ion in ion: oun = ln(slf.ounisbyion(ion)) vliionsuls["ounisbyion"][ion.vlu] = oun # h fo issin o inopl  fo u in slf.uiulu: y: # h if ssnil  is psn if no u.piy.osubjs: vliionsuls["issin"].ppn( f"{u.ouny}: No piy subjs" ) if no u.univsiy.unus: vliionsuls["issin"].ppn( f"{u.ouny}: No univsiy pos" ) # h if  is ou (ol hn 1 y) lsup = i.foisofo(u.lsup) if (i.now() - lsup).ys > 365: vliionsuls["ounis"].ppn(u.ouny) xp xpion s : vliionsuls["vliionos"].ppn( f"{u.ouny}: {s()}" ) lo.info( f"bs vliion opl: {vliionsuls['olounis']} ounis" ) un vliionsuls f xpoojson(slf, oupuph: s) -> bool: """xpo ni bs o JSON fil""" y:  = [u.oi() fo u in slf.uiulu] wih opn(oupuph, "w", noin="uf-8") s f: json.up(, f, inn=2, nsusii=Fls) lo.info(f"xpo bs o {oupuph}") un u xp xpion s : lo.o(f"xpo fil: {s()}") un Fls f xpoojvsip(slf, oupuph: s) -> bool: """xpo bs s JvSip y fo fonn inion""" y:  = [u.oi() fo u in slf.uiulu] jsonn = f"// uo-n by uiulu Liby Bn\n" jsonn += f"// n: {i.now().isofo()}\n" jsonn += f"// ol ounis: {ln()}\n\n" jsonn += f"ons lobluiulubs = " jsonn += json.ups(, inn=2, nsusii=Fls) jsonn += ";\n" wih opn(oupuph, "w", noin="uf-8") s f: f.wi(jsonn) lo.info(f"xpo JvSip o {oupuph}") un u xp xpion s : lo.o(f"JvSip xpo fil: {s()}") un Fls f ipofojson(slf, inpuph: s) -> bool: """Ipo bs fo JSON fil""" y: wih opn(inpuph, "", noin="uf-8") s f:  = json.lo(f) slf.uiulu.l() fo ouny in : # onsu ounyuiulu objs uiulu = slf.iouiulu(ouny) if uiulu: slf.uiulu.ppn(uiulu) lo.info( f"Ipo {ln(slf.uiulu)} ounis fo {inpuph}" ) un u xp xpion s : lo.o(f"Ipo fil: {s()}") un Fls f iouiulu(slf, : i) -> Opionl[ounyuiulu]: """onv iiony b o ounyuiulu obj""" y: # onsu ns objs piy = Piyuion(**["piy"]) 12 = 12uion(**["12"]) spil = Spiluion(**["spiluion"]) # onsu univsiy pos univsiy = ["univsiy"] un = [ UnivsiyPo( **{**po, "lvl": UnivsiyLvl(po["lvl"])} ) fo po in univsiy["unus"] ]  = [ UnivsiyPo( **{**po, "lvl": UnivsiyLvl(po["lvl"])} ) fo po in univsiy["us"] ] ool = [ UnivsiyPo( **{**po, "lvl": UnivsiyLvl(po["lvl"])} ) fo po in univsiy["oolpos"] ] pofssionl = [ UnivsiyPo( **{**po, "lvl": UnivsiyLvl(po["lvl"])} ) fo po in univsiy["pofssionls"] ] univsiy = Univsiyuion( unus=un, us=, oolpos=ool, pofssionls=pofssionl, opunivsiis=univsiy["opunivsiis"], shfous=univsiy["shfous"], innionlsunswlo=univsiy[ "innionlsunswlo" ], ) un ounyuiulu( ouny=["ouny"], ion=ion(["ion"]), ounyo=["ounyo"], piy=piy, 12=12, spiluion=spil, univsiy=univsiy, offiillnus=["offiillnus"], uionsysyp=["uionsysyp"], opulsoyuionys=["opulsoyuionys"], liy=["liy"], sus=["sus"], lsup=["lsup"], ) xp xpion s : lo.o(f"o onsuin uiulu: {s()}") un Non f nsisis(slf) -> i[s, ny]: """n ophnsiv sisis bou h bs""" ss = { "olounis": ln(slf.uiulu), "byion": {}, "uionsyss": {}, "vliy": 0, "univsiyposol": 0, "spilov": 0, "lnus": s(), } liysu = 0 spiloun = 0 fo u in slf.uiulu: # ion ouns ionn = u.ion.vlu ss["byion"][ionn] = ss["byion"].(ionn, 0) + 1 # uion sys yps sysyp = u.uionsysyp ss["uionsyss"][sysyp] = ( ss["uionsyss"].(sysyp, 0) + 1 ) # Liy liysu += u.liy # Univsiy pos ss["univsiyposol"] += ( ln(u.univsiy.unus) + ln(u.univsiy.us) + ln(u.univsiy.oolpos) + ln(u.univsiy.pofssionls) ) # Spil uion if u.spiluion.vilblpos: spiloun += 1 # Lnus ss["lnus"].up(u.offiillnus) if ln(slf.uiulu) > 0: ss["vliy"] = liysu / ln(slf.uiulu) ss["spilov"] = ( spiloun / ln(slf.uiulu) ) * 100 ss["lnus"] = lis(ss["lnus"]) un ss # Plfo iniilizion funion f iniilizuiulubn() -> uiuluLibyBn: """ Iniiliz h uiulu liby bn sys PLFO SOU - Innl us only """ lo.info("=" * 60) lo.info("L.I.F.. uion Plfo - uiulu Liby Bn") lo.info("Iniilizin bn sou fo 156-ouny bs") lo.info("=" * 60) bn = uiuluLibyBn() un bn if n == "in": # his uns only fo bn innn n sin pin("=" * 60) pin("L.I.F.. uiulu Liby Bn - Plfo sou") pin("=" * 60) pin("\nhis is  bn infsuu oponn.") pin("No fo i us inion.") pin("\npbiliis:") pin(" n 156-ouny uion bs") pin(" uli-lvl uion suu (Piy, -12, Spil , Univsiy)") pin("  vliion n iniy hs") pin(" xpo o JSON/JvSip fo fonn onsupion") pin(" uo ups n innn") pin("\nSus: Plfo sou iniiliz")