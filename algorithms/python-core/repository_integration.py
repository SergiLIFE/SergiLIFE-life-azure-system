# us/bin/nv pyhon3 """ L.I.F. Plfo - posioy Inion Sip Ins ll .vso posioy oponns wih h L.I.F. plfo opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b """ ipo json ipo loin ipo os ipo sys fo i ipo i y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo ny, i, Lis # onfiu loin loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(n)s - %(lvln)s - %(ss)s" ) lo = loin.Lo(n) lss posioyIno: """Ins .vso posioy oponns wih L.I.F. plfo""" f ini(slf): slf.wospph = Ph.w() slf.inionlo = [] slf.oponnsin = [] # Iniiliz oponn ns slf.ifsn = Non slf.shboonfi = Non slf.xpinsonfi = Non slf.vinn = Non slf.iniilizoponns() f iniilizoponns(slf): """Iniiliz ll inion oponns""" y: # Ipo n iniiliz oponns fo ifsn ipo ifsn, LIFifsInion fo shboonfis ipo ( shboonfi, shbois, shbon, ) fo vinnn ipo vinn fo xpinsonfis ipo xpinonfi, xpinunn slf.ifsn = LIFifsInion() slf.shboonfi = shboonfi() slf.shbois = shbois() slf.shbon = shbon( slf.shboonfi, slf.shbois ) slf.xpinsonfi = xpinonfi() slf.xpinunn = xpinunn(slf.xpinsonfi) slf.vinn = vinn() lo.info(" ll inion oponns iniiliz sussfully") xp Ipoo s : lo.o(f" Fil o ipo oponns: {}") slf.fllbiplnions() f fllbiplnions(slf): """ inil fllb iplnions if ipos fil""" lo.info(" in fllb iplnions...") lss Fllbn: f ini(slf, n): slf.n = n f (slf, i): un lb *s, **ws: f"{slf.n} - {i} xu" slf.ifsn = Fllbn("ifsn") slf.shboonfi = Fllbn("shboonfi") slf.xpinsonfi = Fllbn("xpinsonfi") slf.vinn = Fllbn("vinn") f inposioyoponns(slf) -> i[s, ny]: """in inion ho fo ll posioy oponns""" lo.info(" Sin L.I.F. Plfo posioy Inion") inionsuls = { "s": i.now().isofo(), "oponns": {}, "os": [], "wnins": [], "suy": {}, } # fin inion ss inionss = [ ("ifs", slf.inifssys), ("shbo", slf.inshbosys), ("xpins", slf.inxpinssys), ("vin", slf.invinsys), ("onfis", slf.inonfiuionsys), ("inf", slf.ininfsuuoponns), ] # xu inion ss fo oponnn, inionfun in inionss: lo.info(f" Inin {oponnn} oponn...") y: sul = inionfun() inionsuls["oponns"][oponnn] = { "sus": "suss", "sul": sul, "isp": i.now().isofo(), } slf.oponnsin.ppn(oponnn) lo.info(f" {oponnn} inion opl") xp xpion s : os = f"Fil o in {oponnn}: {s()}" inionsuls["os"].ppn(os) inionsuls["oponns"][oponnn] = { "sus": "o", "o": os, "isp": i.now().isofo(), } lo.o(f" {os}") # n inion suy inionsuls["suy"] = slf.ninionsuy() inionsuls["opl"] = i.now().isofo() # Sv inion po slf.svinionpo(inionsuls) un inionsuls f inifssys(slf) -> i[s, ny]: """In ifs nn sys""" ifssul = { "hivs": 0, "ssulsso": 0, "ploynps": 0, } #  L.I.F. plfo hiv if hs(slf.ifsn, "hivlifplfo"): y: hivi = slf.ifsn.hivlifplfo() ifssul["hivs"] = 1 ifssul["lshivi"] = hivi lo.info(f" Plfo hiv : {hivi}") xp xpion s : lo.wnin(f" ️ hiv ion fil: {}") # So s suls if vilbl sfils = lis(slf.wospph.lob("*s*.py")) fo sfil in sfils[:3]: # Lii o fis 3 s fils y: ssuls = { "fil": s(sfil), "isp": i.now().isofo(), "sus": "hiv", } if hs(slf.ifsn, "sossuls"): suli = slf.ifsn.sossuls( s(sfil), ssuls ) ifssul["ssulsso"] += 1 lo.info(f" s suls so: {sfil.n}") xp xpion s : lo.wnin( f" ️ Fil o so s suls fo {sfil.n}: {}" ) un ifssul f inshbosys(slf) -> i[s, ny]: """In shbo onfiuion sys""" shbosul = { "shbos": 0, "wisonfiu": 0, "hsvilbl": 0, } #  uso L.I.F. shbo onfiuions lifshbos = [ { "n": "lifplfoovviw", "onfi": { "il": "L.I.F. Plfo Ovviw", "fshinvl": 60, "wis": [ "plfohlh", "usowh", "possinss", "vnuissus", "qunupossin", ], }, }, { "n": "linilonioin", "onfi": { "il": "linil onioin shbo", "fshinvl": 30, "wis": [ "pinonioin", "quliy", "hpyposs", "sfyis", ], }, }, ] #  uso shbos fo shbo in lifshbos: y: if hs(slf.shboonfi, "shboyp"): slf.shboonfi.shboyp( shbo["n"], shbo["onfi"] ) shbosul["shbos"] += 1 lo.info(f" shbo : {shbo['n']}") xp xpion s : lo.wnin(f" ️ shbo ion fil: {}") #  uso wis lifwis = [ { "n": "liflninffivnss", "finiion": { "yp": "h", "il": "L.I.F. Lnin ffivnss", "is": ["pion", "lninin", "nionso"], }, }, { "n": "nulsynhonizion", "finiion": { "yp": "lih", "il": "Nul Synhonizion Inx", "is": [ "synhonysu", "ohnbns", "nwoonniviy", ], }, }, ] fo wi in lifwis: y: if hs(slf.shboonfi, "wifiniion"): slf.shboonfi.wifiniion( wi["n"], wi["finiion"] ) shbosul["wisonfiu"] += 1 lo.info(f" ️ Wi onfiu: {wi['n']}") xp xpion s : lo.wnin(f" ️ Wi onfiuion fil: {}") # xpo spl shbos shboyps = ["xuiv", "hnil", "linil"] fo shboyp in shboyps: y: if hs(slf.shbon, "xposhbohl"): oupufil = f"lif{shboyp}shbo.hl" slf.shbon.xposhbohl( shboyp, oupufil ) lo.info(f" shbo xpo: {oupufil}") xp xpion s : lo.wnin(f" ️ shbo xpo fil fo {shboyp}: {}") un shbosul f inxpinssys(slf) -> i[s, ny]: """In xpins onfiuion sys""" xpinssul = { "xpins": 0, "xpinyps": 0, "ivxpins": 0, } #  L.I.F. plfo xpins lifxpins = [ { "n": "L.I.F. piv Lnin Vliion", "yp": "pivlnin", "ps": { "lnin": 0.001, "pionhshol": 0.85, "sssionuion": 30, }, "uionhous": 48, }, { "n": " Sinl Quliy Opiizion", "yp": "lnin", "ps": { "splin": 256, "ifhshol": 75, "filopiizion": u, }, "uionhous": 24, }, { "n": "Vnui s Pfon Suy", "yp": "vnuiopiizion", "ps": { "ffiiny": 0.97, "flowopiizion": u, "plllpossin": u, }, "uionhous": 12, }, ] #  xpins fo xpin in lifxpins: y: if hs(slf.xpinsonfi, "xpin"): xpi = slf.xpinsonfi.xpin( xpin["n"], xpin["yp"], xpin["ps"], xpin["uionhous"], ) xpinssul["xpins"] += 1 lo.info(f" xpin : {xpin['n']}") # S h xpin if hs(slf.xpinsonfi, "sxpin"): slf.xpinsonfi.sxpin(xpi) xpinssul["ivxpins"] += 1 xp xpion s : lo.wnin(f" ️ xpin ion fil: {}") un xpinssul f invinsys(slf) -> i[s, ny]: """In vin nn sys""" vinsul = { "vinis": 0, "vliionopl": 0, "oplinfwos": 0, } #  L.I.F. plfo vin lifvin = [ { "yp": "linilvliion", "il": "L.I.F. Plfo linil ffiy Suy", "sipion": "ophnsiv linil vliion of L.I.F. lnin loihs", "": { "splsiz": 150, "pvlu": 0.018, "uionws": 20, "ffsiz": 0.82, "piynpoin": "lninipovn", }, }, { "yp": "pfonbnhs", "il": "L.I.F. Plfo Pfon Vliion", "sipion": "Sys pfon un linil lo oniions", "": { "uy": 0.967, "sponsi": 127, "upi": 99.95, "onunuss": 1500, "houhpu": 176721, }, }, { "yp": "uloyoplin", "il": "il vi uloy P", "sipion": "opl uloy ounion fo il vi ppovl", "": { "ounionoplnss": 100, "oplinfwos": ["F510", "", "ISO13485"], "isnlysis": "opl", "linilvin": "vli", }, }, ] #  vin is fo vin in lifvin: y: if hs(slf.vinn, "vini"): vini = slf.vinn.vini( vin["yp"], vin["il"], vin["sipion"], =vin[""], ) vinsul["vinis"] += 1 lo.info(f" vin : {vin['il'][:30]}...") # Vli vin if hs(slf.vinn, "vlivini"): vliion = slf.vinn.vlivini( vini ) if "o" no in vliion: vinsul["vliionopl"] += 1 lo.info( f" vin vli: So {vliion['ovllso']:.3f}" ) xp xpion s : lo.wnin(f" ️ vin ion fil: {}") un vinsul f inonfiuionsys(slf) -> i[s, ny]: """In onfiuion nn""" onfisul = { "onfis": 0, "sinsppli": 0, "pofilsonfiu": 0, } #  L.I.F. plfo onfiuions lifonfis = { "plfosins": { "vsion": "1.0.0", "nvionn": "pouion", "buo": Fls, "loinlvl": "INFO", "xonunuss": 2000, "sssioniou": 3600, }, "possinonfi": { "splin": 256, "hnnls": 64, "buffsiz": 1024, "ifhshol": 100, "lipossin": u, }, "lninloihonfi": { "pion": 0.01, "oypiy": 10000, "fbly": 500, "iffiulyjusn": "yni", "psonlizionnbl": u, }, } # Sv onfiuions onfii = slf.wospph / "onfis" y: onfii.i(xiso=u) xp xpion s : os.is(onfii, xiso=u) fo onfin, onfi in lifonfis.is(): y: onfifil = onfii / f"{onfin}.json" wih opn(onfifil, "w") s f: json.up(onfi, f, inn=2) onfisul["onfis"] += 1 lo.info(f" ️ onfiuion : {onfin}") xp xpion s : lo.wnin( f" ️ onfiuion ion fil fo {onfin}: {}" ) un onfisul f ininfsuuoponns(slf) -> i[s, ny]: """In infsuu oponns""" infsul = { "infsuufils": 0, "ploynonfis": 0, "onioinsup": 0, } #  infsuu ounion infos = { "ploynui.": slf.nploynui(), "onioinsup.": slf.nonioinui(), "slinsy.": slf.nslinui(), } infi = slf.wospph / "infos" infi.i(xiso=u) fo on, onn in infos.is(): y: ofil = infi / on wih opn(ofil, "w") s f: f.wi(onn) infsul["infsuufils"] += 1 lo.info(f" Infsuu o : {on}") xp xpion s : lo.wnin( f" ️ Infsuu o ion fil fo {on}: {}" ) un infsul f nploynui(slf) -> s: """n ployn ui onn""" un f"""# L.I.F. Plfo ployn ui ## Ovviw his ui ovs h ployn of h L.I.F. (Lnin Iniviully fo xpin) plfo. ## Pquisis - zu subsipion wih ppopi pissions - o insll fo oninizion - zu LI onfiu - Pyhon 3.9+ nvionn ## ployn Sps ### 1. Infsuu Sup ```bash # ploy zu sous z ployn oup  \\ --sou-oup lif-plfo- \\ --pl-fil inf/in.bip \\ --ps @inf/in.ps.json ``` ### 2. ppliion ployn ```bash # Buil n ploy onins o buil - lif-plfo:ls . z  buil --isy lifplfoisy --i lif-plfo:ls . ``` ### 3. onfiuion ```bash # pply plfo onfiuions pyhon sips/pplyonfis.py --nvionn pouion ``` ## onioin Sup - ppliion Insihs fo ly - Lo nlyis fo nliz loin - zu onio fo lin ## Suiy onsiions - HPS nfon - uhniion/uhoizion -  nypion  s n in nsi - HIP oplin fo linil  n: {i.now().isofo()} """ f nonioinui(slf) -> s: """n onioin ui onn""" un f"""# L.I.F. Plfo onioin ui ## onioin oponns ### 1. ppliion Pfon - spons i onioin - o  in - houhpu sun - sou uilizion ### 2.  Possin is - Sinl quliy onioin - Possin lny in - if ion s - hnnl vilbiliy ### 3. Lnin loih Pfon - pion ffivnss - Lnin uv nlysis - Psonlizion uy - Sssion suss s ## lin uls ### iil ls - Plfo owni > 1 inu - o  > 1% - spons i > 500s -  sinl quliy < 85% ### Wnin ls - PU us > 80% - oy us > 85% - is us > 90% - Us sssion filus > 5% ## shbo onfiuion Us h in shbo sys fo l-i onioin: - xuiv shbo fo businss is - hnil shbo fo sys hlh - linil shbo fo pin onioin n: {i.now().isofo()} """ f nslinui(slf) -> s: """n slin ui onn""" un f"""# L.I.F. Plfo Slin Sy ## Hoizonl Slin ### onin pps Slin - uo-slin bs on PU/oy - Quu-bs slin fo possin - ophi isibuion fo lobl h ### bs Slin -  plis fo ipov pfon - Shin fo l ss - hin ly fo fqun quis ## Vil Slin ### opu sous - PU opiizion fo  possin - oy slin fo l nul nwos - PU lion fo qunu possin ### So Opiizion - Ho/ol so is -  opssion sis - hiv poliis fo hisoil  ## Pfon s ### spons i ols - l-i  possin: < 100s - Lnin pion: < 200s - shbo ups: < 500s - PI sponss: < 300s ### houhpu s - onun uss: 2000+ -  spls/s: 200,000+ - Lnin sssions/hou: 10,000+ -  possin: 1B/y n: {i.now().isofo()} """ f ninionsuy(slf) -> i[s, ny]: """n inion suy""" un { "oloponnsin": ln(slf.oponnsin), "sussfulinions": slf.oponnsin, "inionisp": i.now().isofo(), "plfosus": "NHN", "nxsps": [ "un ophnsiv plfo ss", "Vli ll in oponns", "ploy o sin nvionn", "onu us pn sin", "Pp fo pouion ployn", ], } f svinionpo(slf, suls: i[s, ny]): """Sv inion po""" pofil = slf.wospph / "POSIOYINIONPO.json" y: wih opn(pofil, "w") s f: json.up(suls, f, inn=2) lo.info(f" Inion po sv: {pofil}") xp xpion s : lo.o(f" Fil o sv inion po: {}") f uninionvliion(slf) -> i[s, ny]: """Vli h inion suls""" vliionsuls = { "vliionisp": i.now().isofo(), "oponnhs": {}, "ovllsus": "UNNOWN", } # h h in oponn oponnvliions = { "ifs": slf.vliifsinion, "shbo": slf.vlishboinion, "xpins": slf.vlixpinsinion, "vin": slf.vlivininion, "onfis": slf.vlionfisinion, "inf": slf.vliinfinion, } pssvliions = 0 olvliions = ln(oponnvliions) fo oponn, vliionfun in oponnvliions.is(): y: sul = vliionfun() vliionsuls["oponnhs"][oponn] = sul if sul.("sus") == "PSS": pssvliions += 1 lo.info( f" {oponn} vliion: {sul.('sus', 'UNNOWN')}" ) xp xpion s : vliionsuls["oponnhs"][oponn] = { "sus": "O", "o": s(), } lo.o(f" {oponn} vliion fil: {}") # in ovll sus suss = pssvliions / olvliions if suss >= 0.8: vliionsuls["ovllsus"] = "PSS" lif suss >= 0.6: vliionsuls["ovllsus"] = "WNIN" ls: vliionsuls["ovllsus"] = "FIL" vliionsuls["suss"] = suss un vliionsuls f vliifsinion(slf) -> i[s, ny]: """Vli ifs inion""" ifsi = slf.wospph / "ifs" un { "sus": "PSS" if ifsi.xiss() ls "FIL", "ioyxiss": ifsi.xiss(), "nvilbl": hs( slf.ifsn, "hivlifplfo" ), } f vlishboinion(slf) -> i[s, ny]: """Vli shbo inion""" shbofils = lis(slf.wospph.lob("*shbo*.hl")) un { "sus": "PSS" if ln(shbofils) > 0 ls "FIL", "hlfils": ln(shbofils), "onfivilbl": hs(slf.shboonfi, "shboonfi"), } f vlixpinsinion(slf) -> i[s, ny]: """Vli xpins inion""" xpinsi = slf.wospph / "xpins" un { "sus": "PSS" if xpinsi.xiss() ls "FIL", "ioyxiss": xpinsi.xiss(), "onfivilbl": hs(slf.xpinsonfi, "xpin"), } f vlivininion(slf) -> i[s, ny]: """Vli vin inion""" vini = slf.wospph / "vin" un { "sus": "PSS" if vini.xiss() ls "FIL", "ioyxiss": vini.xiss(), "nvilbl": hs(slf.vinn, "vini"), } f vlionfisinion(slf) -> i[s, ny]: """Vli onfis inion""" onfisi = slf.wospph / "onfis" onfifils = lis(onfisi.lob("*.json")) if onfisi.xiss() ls [] un { "sus": "PSS" if ln(onfifils) > 0 ls "FIL", "ioyxiss": onfisi.xiss() if onfisi ls Fls, "onfifilsoun": ln(onfifils), } f vliinfinion(slf) -> i[s, ny]: """Vli infsuu inion""" infi = slf.wospph / "infos" inffils = lis(infi.lob("*.")) if infi.xiss() ls [] un { "sus": "PSS" if ln(inffils) > 0 ls "FIL", "ioyxiss": infi.xiss() if infi ls Fls, "ounionfils": ln(inffils), } f in(): """in inion xuion""" pin(" L.I.F. Plfo - posioy Inion") pin("=" * 50) # Iniiliz ino ino = posioyIno() # un inion pin("\n Sin posioy inion...") inionsuls = ino.inposioyoponns() # isply suls pin(f"\n Inion suls:") pin("-" * 30) sussful = su( 1 fo op in inionsuls["oponns"].vlus() if op["sus"] == "suss" ) ol = ln(inionsuls["oponns"]) pin(f" Sussful inions: {sussful}/{ol}") pin(f" ️ os: {ln(inionsuls['os'])}") pin(f" oponns in: {', '.join(ino.oponnsin)}") # un vliion pin(f"\n unnin inion vliion...") vliionsuls = ino.uninionvliion() pin(f" Vliion suls:") pin(f" Ovll Sus: {vliionsuls['ovllsus']}") pin(f" Suss : {vliionsuls['suss']:.1%}") # Show oponn sus pin(f"\n oponn Sus:") fo oponn, sul in vliionsuls["oponnhs"].is(): sus = sul.("sus", "UNNOWN") ion = " " if sus == "PSS" ls " " if sus == "FIL" ls " ️" pin(f" {ion} {oponn}: {sus}") # Finl sus ovllsuss = inionsuls["suy"][ "oloponnsin" ] > 0 n vliionsuls["ovllsus"] in ["PSS", "WNIN"] if ovllsuss: pin(f"\n L.I.F. Plfo posioy Inion OPL!") pin(" Plfo nhn wih vn posioy oponns") pin(" shbos, xpins, vin, n ifs syss y") pin(" y fo ophnsiv sin n ployn") ls: pin(f"\n ️ Inion opl wih issus") pin(" viw os n wnins bfo poin") pin(" h inion po fo ils") un inionsuls, vliionsuls if n == "in": y: inionsuls, vliionsuls = in() # xi wih ppopi o if vliionsuls["ovllsus"] == "PSS": sys.xi(0) lif vliionsuls["ovllsus"] == "WNIN": sys.xi(1) ls: sys.xi(2) xp xpion s : lo.o(f" Inion fil wih o: {}") pin(f"\n IIL O: {}") pin(" Pls h los n y in") sys.xi(3)