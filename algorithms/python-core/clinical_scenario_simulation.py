# us/bin/nv pyhon3 """ L.I.F.. Plfo - linil Snio Siulion l Hospil  nlysis onsion opyih 2025 - Sio Py Boull npis Nuosin Plfo - linil Us s o his siulion shows wh hlh pofssionls s whn usin h L.I.F.. Plfo wih l pin  . """ ipo synio ipo ipolib.uil ipo json ipo loin ipo os ipo no # Ipo ou L.I.F.. loih ipo sys fo lsss ipo si, lss fo i ipo i, il fo nu ipo nu fo ypin ipo ny, i, Lis, Opionl ipo nupy s np # linil oniion lssifiions lss liniloniion(nu): NOL = "nol" H = "h" PSSION = "pssion" NXIY = "nxiy" ONIIVLIN = "oniivlin" LNINISBILIY = "lninisbiliy" POSSO = "posso" BI = "uibininjuy" PILPSYIS = "pilpsyis" lss SviyLvl(nu): IL = "il" O = "o" SV = "sv" IIL = "iil" @lss lss PinPofil: """Pin ophi n linil infoion""" pini: s : in n: s oniion: liniloniion ilhisoy: Lis[s] uniions: Lis[s] psninsypos: Lis[s] finphysiin: s pn: s @lss lss linilonion: """linil onions bs on  nlysis""" piyfinin: s sviy: SviyLvl onn: Lis[s] followupss: Lis[s] hpysusions: Lis[s] iiononsiions: Lis[s] lifsyloifiions: Lis[s] ponosis: s onfinlvl: flo unnionqui: bool @lss lss linilpo: """opl linil po fo hlh pofssionls""" poi: s pin: PinPofil s: i uioninus: in nulis: i[s, flo] lninssssn: i[s, flo] linilfinins: Lis[s] onions: linilonion opisononoiv: i[s, s] followupilin: s liniinnossion: s lss linilLIFSiulion: """ linil siulion of h L.I.F.. Plfo Shows l-wol hospil us ss n linil ision suppo """ f ini(slf): slf.lifloih = slf.lolifloih() slf.noivbs = slf.iniiliznoivbs() f lolifloih(slf): """Lo h L.I.F.. loih o""" y: sp = ipolib.uil.spfofilloion( "lifloih", "xpinP2L.I.F.-Lnin-Iniviully-fo-xpin-hoy-loih-o-2025-opyih-S.py" ) lifoul = ipolib.uil.oulfosp(sp) sp.lo.xoul(lifoul) un lifoul.LIFloiho() xp xpion s : pin(f" oul no lo L.I.F.. loih: {}") un Non f iniiliznoivbs(slf) -> i[s, i[s, flo]]: """Iniiliz noiv   fo linil opison""" un { "hiln612": { "lphpow": 0.45, "bpow": 0.25, "hpow": 0.35, "nioninx": 0.65, "lninffiiny": 0.70 }, "olsns1318": { "lphpow": 0.50, "bpow": 0.30, "hpow": 0.25, "nioninx": 0.70, "lninffiiny": 0.75 }, "uls1965": { "lphpow": 0.55, "bpow": 0.35, "hpow": 0.20, "nioninx": 0.75, "lninffiiny": 0.80 }, "lly65plus": { "lphpow": 0.45, "bpow": 0.30, "hpow": 0.30, "nioninx": 0.65, "lninffiiny": 0.70 } } f pinsnios(slf) -> Lis[PinPofil]: """ lisi pin snios fo hospil sin""" snios = [ PinPofil( pini="P-2025-001", =8, n="l", oniion=liniloniion.H, ilhisoy=["Pu bih", "Fily hisoy of H"], uniions=["Non"], psninsypos=["Innion", "Hypiviy", "i iffiulis"], finphysiin=". Sh Johnson", pn="Pii Nuoloy" ), PinPofil( pini="P-2025-002", =34, n="Fl", oniion=liniloniion.PSSION, ilhisoy=["jo pssiv piso 2 ys o"], uniions=["Slin 50"], psninsypos=["oniiv fo", "iffiuly onnin", "oy issus"], finphysiin=". ihl hn", pn="Psyhiy" ), PinPofil( pini="P-2025-003", =67, n="l", oniion=liniloniion.POSSO, ilhisoy=["Ishi so 6 onhs o", "Hypnsion"], uniions=["spiin", "Lisinopil"], psninsypos=["Sph iffiulis", "oy pobls", "Lnin hllns"], finphysiin=". Lis oiuz", pn="Nuoloy - So ovy" ), PinPofil( pini="P-2025-004", =16, n="Fl", oniion=liniloniion.LNINISBILIY, ilhisoy=["inos yslxi  7"], uniions=["Non"], psninsypos=["in iffiulis", "h suls", "Woin oy issus"], finphysiin=". ob i", pn="Pii vlopnl iin" ), PinPofil( pini="P-2025-005", =45, n="l", oniion=liniloniion.BI, ilhisoy=["oo vhil in 3 onhs o", "il BI"], uniions=["bpnin fo hhs"], psninsypos=["Hhs", "onnion issus", "Fiu"], finphysiin=". n Fos", pn="Nuoloy - Bin Injuy" ) ] un snios f noniionspifi(slf, oniion: liniloniion, : in) -> np.ny: """n lisi  pns bs on linil oniion""" hnnls = 64 ipoins = 1024  = np.linsp(0, 4, ipoins)  = np.zos((hnnls, ipoins)) # Bs  pns bslph = 0.5 bsb = 0.3 bsh = 0.4 noislvl = 0.1 # oniion-spifi oifiions if oniion == liniloniion.H: # Ins h, u lph bsh *= 1.6 bslph *= 0.7 noislvl *= 1.3 lif oniion == liniloniion.PSSION: # u lph, ins l bslph *= 0.6 bsh *= 1.2 noislvl *= 1.1 lif oniion == liniloniion.POSSO: # syi pns, u ohn noislvl *= 1.8 bslph *= 0.5 lif oniion == liniloniion.LNINISBILIY: # Iul pns, ins h bsh *= 1.4 bsb *= 0.8 noislvl *= 1.2 lif oniion == liniloniion.BI: # Iul pns, ins nois noislvl *= 2.0 bslph *= 0.6 bsb *= 0.7 # n   fo h hnnl fo h in n(hnnls): # lph hyh (8-12 Hz) lph = bslph * np.sin(2 * np.pi * 10 *  + np.no.no() * 2 * np.pi) # B iviy (12-30 Hz) b = bsb * np.sin(2 * np.pi * 20 *  + np.no.no() * 2 * np.pi) # h wvs (4-8 Hz) h = bsh * np.sin(2 * np.pi * 6 *  + np.no.no() * 2 * np.pi) #  oniion-spifi nois n ifs nois = noislvl * np.no.nn(ipoins) #  syy fo so pins (ff lf hisph o) if oniion == liniloniion.POSSO n h < hnnls // 2: lph *= 0.5 nois *= 1.5 [h] = lph + b + h + nois un  syn f nlyzpin(slf, pin: PinPofil) -> linilpo: """nlyz pin  n n linil po""" pin(f"\n nlyzin  fo Pin {pin.pini}") pin(f" pn: {pin.pn}") pin(f" fin Physiin: {pin.finphysiin}") # n oniion-spifi    = slf.noniionspifi(pin.oniion, pin.) # Poss houh L.I.F.. loih if slf.lifloih: is = wi slf.lifloih.posss() ls: # Fllb if loih no lo fo i ipo i is = yp('is', (), { 'isp': i.now(), 'lphpow': no.unifo(0.2, 0.8), 'bpow': no.unifo(0.1, 0.5), 'hpow': no.unifo(0.1, 0.6), 'lpow': no.unifo(0.05, 0.3), 'pow': no.unifo(0.02, 0.15), 'ohnso': no.unifo(0.3, 0.9), 'nioninx': no.unifo(0.2, 0.9), 'lninffiiny': no.unifo(0.3, 0.9) })() #  -ppopi noiv  if pin. <= 12: nooup = "hiln612" lif pin. <= 18: nooup = "olsns1318" lif pin. <= 65: nooup = "uls1965" ls: nooup = "lly65plus" noiv = slf.noivbs[nooup] # n linil finins n onions onions = slf.nlinilonions( pin, is, noiv ) #  ophnsiv linil po fo i ipo i s  po = linilpo( poi=f"LIF-{pin.pini}-{.now().sfi('%Y%%')}", pin=pin, s=.now(), uioninus=15, nulis={ "lphpow": is.lphpow, "bpow": is.bpow, "hpow": is.hpow, "nioninx": is.nioninx, "lninffiiny": is.lninffiiny, "ohnso": is.ohnso }, lninssssn={ "woinoy": is.nioninx * 0.8, "possinsp": is.lninffiiny, "susinnion": is.ohnso, "oniivflxibiliy": (is.bpow / is.hpow) if is.hpow > 0 ls 0.5 }, linilfinins=slf.nlinilfinins(pin, is, noiv), onions=onions, opisononoiv=slf.oponoiv(is, noiv), followupilin=slf.infollowupilin(onions.sviy), liniinnossion="[Sp fo liniin obsvions n iionl nos]" ) un po f nlinilonions( slf, pin: PinPofil, is, noiv: i[s, flo] ) -> linilonion: """n vin-bs linil onions""" # in sviy bs on viion fo noiv  nionviion = bs(is.nioninx - noiv["nioninx"]) lninviion = bs(is.lninffiiny - noiv["lninffiiny"]) if nionviion > 0.3 o lninviion > 0.3: sviy = SviyLvl.SV lif nionviion > 0.2 o lninviion > 0.2: sviy = SviyLvl.O ls: sviy = SviyLvl.IL # oniion-spifi onions if pin.oniion == liniloniion.H: un linilonion( piyfinin="nion fii pn wih ins h iviy", sviy=sviy, onn=[ "Nuofb hpy in h/b io", "oniiv bhviol hpy fo nion sills", "Siuln iion vluion if no onini" ], followupss=[ "Follow-up  in 3 onhs o ssss n spons", "oninuous pfon s", "i hivn ssssn" ], hpysusions=[ "Woin oy inin po", "nion ulion xiss", "Bhviol oifiion hniqus" ], iiononsiions=[ "onsi hylphni o phin-bs siulns", "onio fo si ffs: ppi, slp, owh", "lniv: non-siuln opions (ooxin, unfin)" ], lifsyloifiions=[ "Suu ily ouin", "ul xis (30+ inus ily)", "u sn i, spilly bfo slp", "Nuiion: u su, ins o-3 fy is" ], ponosis="oo wih ppopi uliol n ppoh", onfinlvl=0.85, unnionqui=Fls ) lif pin.oniion == liniloniion.PSSION: un linilonion( piyfinin="oniiv possin fiis ssoi wih pssiv sypos", sviy=sviy, onn=[ "nsnil i un siulion (S) in lf LPF", "oniiv inin fo possin sp n woin oy", "nipssn opiizion" ], followupss=[ "pssion sviy sls (PHQ-9, H-)", "oniiv ssssn by", "Follow-up  in 6 ws" ], hpysusions=[ "oniiv bhviol hpy fousin on oniiv suuin", "infulnss-bs oniiv hpy", "Bhviol ivion hpy" ], iiononsiions=[ "un slin y n os jusn", "onsi swihin o SNI fo oniiv bnfis", "union wih oniiv nhns if ini" ], lifsyloifiions=[ "ul slp shul (7-9 hous nihly)", "ily lih hpy (onin xposu)", "obi xis 150 inus/w", "Soil nn iviis" ], ponosis="Fvobl wih in n ppoh", onfinlvl=0.78, unnionqui=Fls ) lif pin.oniion == liniloniion.POSSO: un linilonion( piyfinin="Pos-so oniiv ipin wih hisphi syy", sviy=sviy, onn=[ "Innsiv oniiv hbiliion po", "Sph n lnu hpy", "Oupionl hpy fo ily livin sills" ], followupss=[ "I o ssss suul hns", "ophnsiv nuopsyholoil sin", "Follow-up  in 1 onh" ], hpysusions=[ "opu-bs oniiv inin", "onsin-inu lnu hpy", "oo-oniiv ul-s inin" ], iiononsiions=[ "oninu un so pvnion in", "onsi holinss inhibios fo oniiv nhnn", "onio fo pos-so pssion" ], lifsyloifiions=[ "ul ins in physil iviy", "oniiv siulion iviis", "Fily involvn in hbiliion", "So suppo oup piipion" ], ponosis="u bu ponil fo ipovn wih innsiv hbiliion", onfinlvl=0.72, unnionqui=sviy == SviyLvl.SV ) lif pin.oniion == liniloniion.LNINISBILIY: un linilonion( piyfinin="Lnin-l nul possin iffns", sviy=sviy, onn=[ "Spiliz uionl invnions", "Nuofb inin fo nion n possin", "ssisiv hnoloy vluion" ], followupss=[ "ophnsiv psyhouionl ssssn", "Visul n uioy possin vluion", "Follow-up  in 6 onhs" ], hpysusions=[ "Oon-illinh in insuion", "h invnion usin on-psnionl-bs ppoh", "xuiv funion sills inin" ], iiononsiions=[ "nlly no ini fo lnin isbiliis lon", "ss oobi oniions if psn (H, nxiy)", "onio fo sony oionl issus" ], lifsyloifiions=[ "Suu howo nvionn", "B ss ino sll oponns", "Us of visul n uioy lnin is", "ul slp shul o opiiz lnin" ], ponosis="oo wih ppopi uionl suppos n invnions", onfinlvl=0.82, unnionqui=Fls ) lif pin.oniion == liniloniion.BI: un linilonion( piyfinin="Pos-ui oniiv hns wih iul nul pns", sviy=sviy, onn=[ "ophnsiv bin injuy hbiliion po", "oniiv hpy in ff oins", "Vsibul hpy if ini" ], followupss=[ "Nuopsyholoil sin by", "I wih I o ssss whi  iniy", "Follow-up  in 4 ws" ], hpysusions=[ "oniiv hbiliion hpy", "opnsoy sy inin", "nion poss inin" ], iiononsiions=[ "oninu bpnin fo hh nn", "onsi siulns fo oniiv nhnn if ppopi", "onio fo pssion n nxiy" ], lifsyloifiions=[ "ul un o iviis", "oniiv s pios houhou y", "Slp hyin opiizion", "Sss nn hniqus" ], ponosis="Vibl pnin on injuy sviy n hbiliion oplin", onfinlvl=0.69, unnionqui=u ) # ful onion fo oh oniions un linilonion( piyfinin="Nul pn nlysis opl", sviy=SviyLvl.IL, onn=["Sn  poools"], followupss=["Follow-up  s linilly ini"], hpysusions=["Suppoiv hpy s n"], iiononsiions=["oninu un iions"], lifsyloifiions=["inin hlhy lifsyl"], ponosis="Sbl", onfinlvl=0.60, unnionqui=Fls ) f nlinilfinins( slf, pin: PinPofil, is, noiv: i[s, flo] ) -> Lis[s]: """n spifi linil finins bs on  nlysis""" finins = [] # lph pow nlysis lphiff = (is.lphpow - noiv["lphpow"]) / noiv["lphpow"] if lphiff > 0.2: finins.ppn(f"Ins lph pow ({is.lphpow:.3f}) - y ini lx s o iion ffs") lif lphiff < -0.2: finins.ppn(f"s lph pow ({is.lphpow:.3f}) - suss ins ousl o nxiy") # h pow nlysis hiff = (is.hpow - noiv["hpow"]) / noiv["hpow"] if hiff > 0.3: finins.ppn(f"lv h iviy ({is.hpow:.3f}) - onsisn wih nion iffiulis o owsinss") # nion inx nlysis nioniff = (is.nioninx - noiv["nioninx"]) / noiv["nioninx"] if nioniff < -0.2: finins.ppn(f"u nion inx ({is.nioninx:.3f}) - inis nion ulion hllns") lif nioniff > 0.2: finins.ppn(f"nhn nion inx ({is.nioninx:.3f}) - suss oo nion ulion") # Lnin ffiiny nlysis lniniff = (is.lninffiiny - noiv["lninffiiny"]) / noiv["lninffiiny"] if lniniff < -0.15: finins.ppn(f"u lnin ffiiny ({is.lninffiiny:.3f}) - y ip i/oupionl pfon") # ohn nlysis if is.ohnso < 0.4: finins.ppn(f"Low nul ohn ({is.ohnso:.3f}) - suss fn nul ouniion") lif is.ohnso > 0.8: finins.ppn(f"Hih nul ohn ({is.ohnso:.3f}) - inis wll-ooin nul iviy") un finins if finins ls [" pns wihin nol viion fo  oup"] f oponoiv(slf, is, noiv: i[s, flo]) -> i[s, s]: """op pin is o noiv bs""" opisons = {} fo i in ["lphpow", "bpow", "hpow", "nioninx", "lninffiiny"]: pinvlu = (is, i) novlu = noiv[i] viion = (pinvlu - novlu) / novlu * 100 if bs(viion) < 10: opisons[i] = f"Wihin nol n ({viion:+.1f}%)" lif viion > 10: opisons[i] = f"bov v (+{viion:.1f}%)" ls: opisons[i] = f"Blow v ({viion:.1f}%)" un opisons f infollowupilin(slf, sviy: SviyLvl) -> s: """in ppopi follow-up ilin""" if sviy == SviyLvl.IIL: un "Ii follow-up wihin 1 w" lif sviy == SviyLvl.SV: un "Follow-up wihin 2-4 ws" lif sviy == SviyLvl.O: un "Follow-up in 1-3 onhs" ls: un "Follow-up in 3-6 onhs o s linilly ini" f isplylinilpo(slf, po: linilpo): """isply h linil po s hlh pofssionls woul s i""" pin("\n" + "="*80) pin(" L.I.F.. PLFO - LINIL  NLYSIS PO") pin("="*80) # H Infoion pin(f" po I: {po.poi}") pin(f" s : {po.s.sfi('%B %, %Y  %I:% %p')}") pin(f" ️  uion: {po.uioninus} inus") pin(f" pn: {po.pin.pn}") pin(f" ‍ ️ fin Physiin: {po.pin.finphysiin}") # Pin Infoion pin(f"\n PIN INFOION") pin(f" Pin I: {po.pin.pini}") pin(f" : {po.pin.} ys") pin(f" n: {po.pin.n}") pin(f" il Hisoy: {', '.join(po.pin.ilhisoy)}") pin(f" un iions: {', '.join(po.pin.uniions)}") pin(f" Psnin Sypos: {', '.join(po.pin.psninsypos)}") # Nul is pin(f"\n NUL NLYSIS SULS") pin(f" lph Pow: {po.nulis['lphpow']:.4f}") pin(f" B Pow: {po.nulis['bpow']:.4f}") pin(f" h Pow: {po.nulis['hpow']:.4f}") pin(f" nion Inx: {po.nulis['nioninx']:.4f}") pin(f" Lnin ffiiny: {po.nulis['lninffiiny']:.4f}") pin(f" Nul ohn: {po.nulis['ohnso']:.4f}") # Lnin ssssn pin(f"\n ONIIV SSSSN") pin(f" Woin oy: {po.lninssssn['woinoy']:.3f}") pin(f" Possin Sp: {po.lninssssn['possinsp']:.3f}") pin(f" Susin nion: {po.lninssssn['susinnion']:.3f}") pin(f" oniiv Flxibiliy: {po.lninssssn['oniivflxibiliy']:.3f}") # opison o Noiv  pin(f"\n OPISON O -H NOS") fo i, opison in po.opisononoiv.is(): pin(f" {i.pl('', ' ').il()}: {opison}") # linil Finins pin(f"\n LINIL FININS") fo i, finin in nu(po.linilfinins, 1): pin(f" {i}. {finin}") # onions  = po.onions pin(f"\n LINIL ONIONS") pin(f" Piy Finin: {.piyfinin}") pin(f" Sviy Lvl: {.sviy.vlu.upp()}") pin(f" onfin Lvl: {.onfinlvl:.0%}") if .unnionqui: pin(f" ️ UN NION QUI") pin(f"\n ON NS:") fo i, n in nu(.onn, 1): pin(f" {i}. {n}") pin(f"\n FOLLOW-UP SS:") fo i, s in nu(.followupss, 1): pin(f" {i}. {s}") pin(f"\n ‍ ️ HPY SUSIONS:") fo i, hpy in nu(.hpysusions, 1): pin(f" {i}. {hpy}") pin(f"\n IION ONSIIONS:") fo i,  in nu(.iiononsiions, 1): pin(f" {i}. {}") pin(f"\n LIFSYL OIFIIONS:") fo i, lifsyl in nu(.lifsyloifiions, 1): pin(f" {i}. {lifsyl}") pin(f"\n FOLLOW-UP ILIN: {po.followupilin}") pin(f" PONOSIS: {.ponosis}") pin(f"\n LINIIN NOS:") pin(f" {po.liniinnossion}") pin(f"\n" + "="*80) pin("n of linil po") pin("="*80) syn f in(): """un h linil snio siulion""" pin(" L.I.F.. Plfo - linil Snio Siulion") pin(" l Hospil  nlysis onsion") pin("=" * 60) # Iniiliz h linil siulion linilsi = linilLIFSiulion() #  pin snios pins = linilsi.pinsnios() pin(f"\n Siulin hospil  nlysis fo {ln(pins)} pins...") pin(" his shows wh hlh pofssionls s on hi sns") # nlyz h pin fo i, pin in nu(pins, 1): pin(f"\n{'='*60}") pin(f"PIN {i} of {ln(pins)}") pin(f"{'='*60}") # nlyz h pin's  linilpo = wi linilsi.nlyzpin(pin) # isply h linil po linilsi.isplylinilpo(linilpo) # Bif pus bwn pins if i < ln(pins): pin(f"\n Possin nx pin...") wi synio.slp(1) pin(f"\n linil Siulion opl!") pin(f" Hlh pofssionls now hv ionbl insihs fo:") pin(f" • vin-bs n onions") pin(f" • Psonliz hpy poools") pin(f" • Objiv poss onioin") pin(f" • is sifiion n ponosis") pin(f"\n L.I.F.. Plfo: nsfoin hlh houh nuopiv hnoloy!") if n == "in": synio.un(in())if n == "in": synio.un(in())