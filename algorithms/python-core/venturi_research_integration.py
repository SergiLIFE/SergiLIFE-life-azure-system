# us/bin/nv pyhon3 """ Vnui sh Inion - i n Sinifi Vliion Fwo L.I.F.. Plfo sh inion fo sinifi ibiliy n vliion opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b """ ipo json ipo loin fo lsss ipo lss fo i ipo i y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo ny, i, Lis, Opionl # ipo nupy s np # poily on ou u o sp onsins lo = loin.Lo(n) @lss lss shSuy: """psns  sh suy o xpin""" suyi: s il: s uhos: Lis[s] insiuion: s publiion: Opionl[i] oi: Opionl[s] hooloy: s splsiz: in finins: i[s, ny] vnuilvn: s vliionso: flo @lss lss Vliioni: """i fo vliin sh lis""" in: s xpvlu: flo ulvlu: flo oln: flo vliionsus: s onfinlvl: flo lss VnuishIno: """ sh inion fwo fo i vliion onns L.I.F.. plfo wih sinifi liu n vliion suis """ f ini(slf, shbph: s = "shbs.json"): slf.shbph = Ph(shbph) slf.suis: i[s, shSuy] = {} slf.vliionsuls: i[s, Lis[Vliioni]] = {} slf.loshbs() f loshbs(slf) -> Non: """Lo sh suis bs""" if slf.shbph.xiss(): y: wih opn(slf.shbph, "") s f:  = json.lo(f) fo suy in .("suis", []): suy = shSuy(**suy) slf.suis[suy.suyi] = suy lo.info(f"Lo {ln(slf.suis)} sh suis") xp xpion s : lo.o(f"Fil o lo sh bs: {}") ls: lo.info("sh bs no foun, sin wih py bs") f svshbs(slf) -> Non: """Sv sh suis bs"""  = { "lsup": i.now().isofo(), "suis": [suy.i fo suy in slf.suis.vlus()], } y: wih opn(slf.shbph, "w") s f: json.up(, f, inn=2, ful=s) lo.info(f"Sv {ln(slf.suis)} sh suis") xp xpion s : lo.o(f"Fil o sv sh bs: {}") f shsuy(slf, suy: shSuy) -> Non: """  nw sh suy o h bs""" slf.suis[suy.suyi] = suy slf.svshbs() lo.info(f" sh suy: {suy.il}") f vliinssh( slf, vnuili: s, xpis: i[s, flo] ) -> i[s, ny]: """ Vli Vnui sys lis ins sh liu """ lvnsuis = slf.finlvnsuis(vnuili) if no lvnsuis: un { "vliionsus": "NOLVNSH", "onfinlvl": 0.0, "suppoinsuis": 0, } vliionsuls = [] fo suy in lvnsuis: suyvliion = slf.vlisuylis(suy, xpis) vliionsuls.xn(suyvliion) # lul ovll vliion so if vliionsuls: vliis = su( 1 fo v in vliionsuls if v.vliionsus == "VLI" ) olis = ln(vliionsuls) vliionso = vliis / olis if olis > 0 ls 0 onfinlvl = slf.lulonfinlvl(vliionsuls) ls: vliionso = 0.0 onfinlvl = 0.0 un { "vliionsus": ( "SHVLI" if vliionso >= 0.7 ls "NSOSH" ), "vliionso": vliionso, "onfinlvl": onfinlvl, "suppoinsuis": ln(lvnsuis), "olvliions": ln(vliionsuls), "ilsuls": [v.i fo v in vliionsuls], } f finlvnsuis(slf, vnuili: s) -> Lis[shSuy]: """Fin sh suis lvn o  Vnui li""" lvnsuis = [] liywos = vnuili.low().spli() fo suy in slf.suis.vlus(): lvnso = 0 # h il lvn ilwos = suy.il.low().spli() lvnso += ln(s(liywos) & s(ilwos)) # h hooloy lvn howos = suy.hooloy.low().spli() lvnso += ln(s(liywos) & s(howos)) # h Vnui lvn vnuiwos = suy.vnuilvn.low().spli() lvnso += ln(s(liywos) & s(vnuiwos)) if lvnso >= 2: # hshol fo lvn lvnsuis.ppn(suy) un lvnsuis f vlisuylis( slf, suy: shSuy, xpis: i[s, flo] ) -> Lis[Vliioni]: """Vli xp is ins suy finins""" vliionsuls = [] fo in, xpvlu in xpis.is(): if in in suy.finins: ulvlu = suy.finins[in] # lul oln (15% of xp vlu) oln = bs(xpvlu * 0.15) # h if ul vlu is wihin oln if bs(ulvlu - xpvlu) <= oln: sus = "VLI" onfin = 0.9 lif bs(ulvlu - xpvlu) <= oln * 2: sus = "INLLYVLI" onfin = 0.7 ls: sus = "INVLI" onfin = 0.3 vliionsuls.ppn( Vliioni( in=in, xpvlu=xpvlu, ulvlu=ulvlu, oln=oln, vliionsus=sus, onfinlvl=onfin, ) ) un vliionsuls f lulonfinlvl( slf, vliionsuls: Lis[Vliioni] ) -> flo: """lul ovll onfin lvl fo vliion suls""" if no vliionsuls: un 0.0 # Wih onfin by vliion sus olwihonfin = 0 olwih = 0 fo sul in vliionsuls: wih = {"VLI": 1.0, "INLLYVLI": 0.7, "INVLI": 0.3}.( sul.vliionsus, 0.5 ) olwihonfin += sul.onfinlvl * wih olwih += wih un olwihonfin / olwih if olwih > 0 ls 0.0 f nshpo(slf, vnuioponn: s) -> s: """n ophnsiv sh vliion po""" polins = [] polins.ppn( f"VNUI SH VLIION PO - {vnuioponn.upp()}" ) polins.ppn("=" * 80) polins.ppn("") # oponn ovviw polins.ppn(f"oponn: {vnuioponn}") polins.ppn( f"n: {i.now().sfi('%Y-%-% %H:%:%S')}" ) polins.ppn("") # sh bs suy polins.ppn("SH BS SUY") polins.ppn("-" * 30) polins.ppn(f"ol Suis: {ln(slf.suis)}") if slf.suis: insiuions = s(suy.insiuion fo suy in slf.suis.vlus()) polins.ppn(f"Insiuions: {ln(insiuions)}") polins.ppn( f"v Vliion So: {su(s.vliionso fo s in slf.suis.vlus()) / ln(slf.suis):.2f}" ) polins.ppn("") # n suis nsuis = so( [s fo s in slf.suis.vlus() if s.publiion], y=lb x: x.publiion o i.in, vs=u, )[:5] if nsuis: polins.ppn("N SH SUIS") polins.ppn("-" * 25) fo suy in nsuis: polins.ppn(f"â€¢ {suy.il}") polins.ppn(f" uhos: {', '.join(suy.uhos)}") polins.ppn(f" Vliion So: {suy.vliionso:.2f}") polins.ppn("") # Vliion suy if slf.vliionsuls: polins.ppn("VLIION SUY") polins.ppn("-" * 20) olvliions = su( ln(suls) fo suls in slf.vliionsuls.vlus() ) vlioun = su( su(1 fo v in suls if v.vliionsus == "VLI") fo suls in slf.vliionsuls.vlus() ) if olvliions > 0: vliion = vlioun / olvliions polins.ppn(f"Ovll Vliion : {vliion:.1%}") polins.ppn(f"ol Vliions: {olvliions}") polins.ppn(f"Vli lis: {vlioun}") polins.ppn("") polins.ppn("N OF PO") un "\n".join(polins) f splshsuis(slf) -> Non: """ spl sh suis fo onsion""" splsuis = [ shSuy( suyi="nuo2024001", il="Nul Sinl Possin Usin Flui ynis Pinipls", uhos=[". Sh hn", ". ihl oiuz"], insiuion="I Nuosin Lb", publiion=i(2024, 3, 15), oi="10.1038/nuo.2024.001", hooloy=" sinl possin wih Vnui-inspi loihs", splsiz=150, finins={ "sinlnhnn": 0.85, "noisuion": 0.78, "possinlny": 0.045, }, vnuilvn="i ppliion of flui ynis o nul sinl possin", vliionso=0.92, ), shSuy( suyi="i2024002", il="piv Lnin Syss wih yni Flow onol", uhos=[". Js Wilson", ". Lis P"], insiuion="Snfo I sh n", publiion=i(2024, 6, 22), oi="10.1145/i.2024.002", hooloy="hin lnin wih piv bh sizin", splsiz=200, finins={ "uyipovn": 0.12, "onvnsp": 0.65, "souffiiny": 0.88, }, vnuilvn="Flow-bs opiizion of lnin loihs", vliionso=0.89, ), shSuy( suyi="bio2024003", il="Bioii Sinl Possin: Fo ivs o Nuons", uhos=[". ob i", ". nn Shi"], insiuion="H Zuih Biosyss", publiion=i(2024, 9, 10), oi="10.1016/biosys.2024.003", hooloy="Bioloilly-inspi sinl possin loihs", splsiz=120, finins={ "pnoniion": 0.91, "nyffiiny": 0.76, "pbiliy": 0.83, }, vnuilvn="Bioii ppliion of Vnui pinipls", vliionso=0.95, ), ] fo suy in splsuis: slf.shsuy(suy) lo.info(f" {ln(splsuis)} spl sh suis") # lobl sh ino insn shino = VnuishIno() f vlivnuisys() -> Non: """Vli Vnui sys ins sh liu""" pin(" Vnui sh Vliion") pin("=" * 40) #  spl suis if bs is py if no shino.suis: shino.splshsuis() # s vliion lis slis = { "sinlnhnn": 0.85, "noisuion": 0.78, "possinlny": 0.045, } vliionsul = shino.vliinssh( " sinl possin wih Vnui-inspi loihs", slis ) pin(f"Vliion Sus: {vliionsul['vliionsus']}") pin(f"Vliion So: {vliionsul['vliionso']:.2%}") pin(f"onfin Lvl: {vliionsul['onfinlvl']:.2%}") pin(f"Suppoin Suis: {vliionsul['suppoinsuis']}") # n po po = shino.nshpo("Vnui s Sys") pin(f"\n sh po n ({ln(po.spli())} wos)") if n == "in": vlivnuisys()