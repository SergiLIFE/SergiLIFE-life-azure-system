""" L.I.F.. hoy onsion - Lnin Iniviully fo xpin opyih 2025 - Sio Py Boull Iniv onsion of h L.I.F.. (Lnin Iniviully fo xpin) hoy n loih iplnion. his o showss h o pinipls of nuopiv lnin houh l-i  possin n piv loihs. h onsion inlus: - l-i  sinl possin siulion - piv lnin loih visulizion - Pfon is n PI in - Iniv lnin snios """ ipo synio ipo json ipo loin ipo no ipo i fo lsss ipo si, lss fo i ipo i, il fo ypin ipo ny, i, Lis, Opionl ipo nupy s np @lss lss is: """ sinl is""" isp: i lphpow: flo bpow: flo hpow: flo lpow: flo sinlquliy: flo nionlvl: flo oniivlo: flo @lss lss LninOuo: """Lnin ouo is""" isp: i lnins: s pfonso: flo pion: flo nowlnion: flo nulffiiny: flo oniivin: flo @lss lss LIFonsion: """L.I.F.. hoy onsion sssion""" sssioni: s si: i uns: s ollnini: flo uulivpfon: flo pionvns: in nulssvisi: Lis[s] lss LIFonsionnin: """nin fo unnin L.I.F.. hoy onsions""" f ini(slf): slf.lo = loin.Lo(n) # Sup loin loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(n)s - %(lvln)s - %(ss)s", ) # onsion s slf.uno: Opionl[LIFonsion] = Non slf.hisoy: Lis[is] = [] slf.lninhisoy: Lis[LninOuo] = [] # L.I.F.. loih ps slf.lninss = [ "xploion", "pnoniion", "sillquisiion", "sy", "innovion", ] slf.nulss = [ "uious", "fous", "hlln", "ovwhl", "onfin", "fus", "nlihn", ] syn f sonsion( slf, snio: s = "pivlnin" ) -> LIFonsion: """S  nw L.I.F.. onsion sssion""" sssioni = f"lifo{i.now().sfi('%Y%%%H%%S')}" slf.uno = LIFonsion( sssioni=sssioni, si=i.now(), uns="xploion", ollnini=0.0, uulivpfon=0.0, pionvns=0, nulssvisi=[], ) slf.lo.info(f"S L.I.F.. onsion: {sssioni}") un slf.uno syn f siuls(slf, uionsons: in = 60) -> Lis[is]: """Siul l-i   s"""  = [] si = i.now() slf.lo.info(f"Sin  siulion fo {uionsons} sons...") fo i in n(uionsons): # Siul lisi  pns isp = si + il(sons=i) # Bs  pns wih lisi viions lphbs = 25 + no.unifo(-5, 5) # lxion bbs = 20 + no.unifo(-3, 3) # iv hinin hbs = 15 + no.unifo(-2, 2) # oy/in lbs = 10 + no.unifo(-1, 1) # p slp #  lnin-inu viions lninfo = in(1.0, i / 30) # Lnin possion lphpow = lphbs * (1 + lninfo * 0.3) bpow = bbs * (1 + lninfo * 0.5) hpow = hbs * (1 + lninfo * 0.2) lpow = lbs * (1 - lninfo * 0.1) # lul iv is olpow = lphpow + bpow + hpow + lpow sinlquliy = 0.85 + no.unifo(-0.1, 0.1) # 85-95% quliy # nion lvl bs on lph/b io nionlvl = in(1.0, bpow / x(lphpow, 0.1)) # oniiv lo bs on b/h io oniivlo = in(1.0, bpow / x(hpow, 0.1))  = is( isp=isp, lphpow=oun(lphpow, 2), bpow=oun(bpow, 2), hpow=oun(hpow, 2), lpow=oun(lpow, 2), sinlquliy=oun(sinlquliy, 3), nionlvl=oun(nionlvl, 3), oniivlo=oun(oniivlo, 3), ) .ppn() slf.hisoy.ppn() # Sll ly o siul l-i sin wi synio.slp(0.1) slf.lo.info(f" siulion opl: {ln()}  poins") un  syn f unpivlninyl( slf, : Lis[is] ) -> Lis[LninOuo]: """un h piv lnin yl bs on  """ lninouos = [] unsinx = 0 uulivpfon = 0.0 pionvns = 0 slf.lo.info("Sin piv lnin yl...") fo i,  in nu(): # in un lnin s bs on poss possfo = in(1.0, i / ln()) sinx = in( ln(slf.lninss) - 1, in(possfo * ln(slf.lninss)), ) uns = slf.lninss[sinx] # lul pfon bs on nion n oniiv lo bspfon = ( .nionlvl * 0.6 + (1 - .oniivlo) * 0.4 ) pfonso = bspfon * (0.7 + possfo * 0.3) # pion  bs on nul s hns pion = 0.1 + (.sinlquliy - 0.8) * 0.5 # nowl nion ipovs wih lnin poss nowlnion = 0.6 + possfo * 0.4 # Nul ffiiny bs on pow isibuion olpow = ( .lphpow + .bpow + .hpow + .lpow ) nulffiiny = in(1.0, olpow / 100) # oniiv in bs on lnin s vnn oniivin = pfonso * (1 + sinx * 0.2) # h fo pion vns (sinifin hns) if ( i > 0 n bs(pfonso - uulivpfon / x(i, 1)) > 0.2 ): pionvns += 1 uulivpfon += pfonso ouo = LninOuo( isp=.isp, lnins=uns, pfonso=oun(pfonso, 3), pion=oun(pion, 3), nowlnion=oun(nowlnion, 3), nulffiiny=oun(nulffiiny, 3), oniivin=oun(oniivin, 3), ) lninouos.ppn(ouo) slf.lninhisoy.ppn(ouo) # Up onsion s if slf.uno: slf.uno.uns = uns slf.uno.ollnini = ( i.now() - slf.uno.si ).olsons() slf.uno.uulivpfon = uulivpfon / ( i + 1 ) slf.uno.pionvns = pionvns #  nul ss nuls = slf.innuls() if nuls no in slf.uno.nulssvisi: slf.uno.nulssvisi.ppn(nuls) slf.lo.info( f"piv lnin yl opl: {ln(lninouos)} ouos" ) un lninouos f innuls(slf, : is) -> s: """in nul s bs on  is""" if .nionlvl > 0.8 n .oniivlo < 0.3: un "fous" lif .lphpow > .bpow n .oniivlo < 0.4: un "uious" lif .bpow > 30 n .oniivlo > 0.6: un "hlln" lif .oniivlo > 0.8: un "ovwhl" lif .nionlvl > 0.7 n .sinlquliy > 0.9: un "onfin" lif .hpow > .lphpow: un "fus" ls: un "nlihn" syn f uninivsnio( slf, snioyp: s = "sillquisiion" ) -> i[s, ny]: """un n iniv lnin snio""" slf.lo.info(f"Sin iniv snio: {snioyp}") # S onsion o = wi slf.sonsion(snioyp) # Siul  s  = wi slf.siuls(uionsons=30) # un lnin yl lninouos = wi slf.unpivlninyl() # n snio suls suls = { "snio": snioyp, "onsion": si(o), "isoun": ln(), "lninouosoun": ln(lninouos), "finlpfon": ( lninouos[-1].pfonso if lninouos ls 0 ), "olpionvns": o.pionvns, "nulssxplo": ln(o.nulssvisi), "lninffiiny": slf.lullninffiiny( lninouos ), } # xpo suls wi slf.xposniosuls(suls) un suls f lullninffiiny(slf, ouos: Lis[LninOuo]) -> flo: """lul ovll lnin ffiiny""" if no ouos: un 0.0 # ffiiny bs on pfon ipovn ov i iniilpfon = ouos[0].pfonso finlpfon = ouos[-1].pfonso ipovn = (finlpfon - iniilpfon) / x( ln(ouos), 1 ) # Fo in pion vns (o pions = o ffiin lnin) pionfo = in(1.0, ln(ouos) / 100) # Noliz ffiiny = ( finlpfon * 0.7 + ipovn * 0.2 + pionfo * 0.1 ) un x(0.0, in(1.0, ffiiny)) syn f xposniosuls(slf, suls: i[s, ny]): """xpo snio suls o fil""" filn = f"lifosuls{i.now().sfi('%Y%%%H%%S')}.json" wih opn(filn, "w") s f: json.up(suls, f, inn=2, ful=s) slf.lo.info(f"Snio suls xpo o {filn}") syn f onslifpinipls(slf) -> i[s, ny]: """ons o L.I.F.. pinipls houh ulipl snios""" slf.lo.info("Sin ophnsiv L.I.F.. pinipls onsion...") snios = [ "xplooylnin", "sillquisiion", "poblsolvin", "ivhinin", "pivsonin", ] llsuls = {} fo snio in snios: slf.lo.info(f"unnin snio: {snio}") sul = wi slf.uninivsnio(snio) llsuls[snio] = sul # Bif pus bwn snios wi synio.slp(1) #  suls suy = { "onsionyp": "ophnsivlifpinipls", "sniosun": ln(snios), "olpoins": su( ["isoun"] fo  in llsuls.vlus() ), "ollninouos": su( ["lninouosoun"] fo  in llsuls.vlus() ), "vfinlpfon": np.n( [["finlpfon"] fo  in llsuls.vlus()] ), "olpionvns": su( ["olpionvns"] fo  in llsuls.vlus() ), "vlninffiiny": np.n( [["lninffiiny"] fo  in llsuls.vlus()] ), "sniosuls": llsuls, "lifpiniplsons": [ "Iniviul Lnin P pion", "xpin-Bs nowl Builin", "Nul S-w hin", "l-i Pfon Opiizion", "oniiv Lo nn", ], } # xpo ophnsiv suls filn = ( f"lifpiniplso{i.now().sfi('%Y%%%H%%S')}.json" ) wih opn(filn, "w") s f: json.up(suy, f, inn=2, ful=s) slf.lo.info(f"ophnsiv L.I.F.. pinipls onsion opl") un suy f onsionhisoy(slf) -> i[s, ny]: """ hisoy of ll onsion """ un { "hisoy": [ si() fo  in slf.hisoy[-100:] ], # Ls 100 ins "lninhisoy": [ si(ouo) fo ouo in slf.lninhisoy[-50:] ], # Ls 50 ouos "uno": si(slf.uno) if slf.uno ls Non, } syn f in(): """in onsion funion""" pin("L.I.F.. hoy onsion") pin("Lnin Iniviully fo xpin") pin("=" * 75) pin("opyih 2025 - Sio Py Boull") pin() nin = LIFonsionnin() y: # un ophnsiv onsion pin("unnin ophnsiv L.I.F.. pinipls onsion...") suls = wi nin.onslifpinipls() pin("\nonsion Suy:") pin(f" Snios opl: {suls['sniosun']}") pin(f"   Poins: {suls['olpoins']}") pin(f" Lnin Ouos: {suls['ollninouos']}") pin(f" v Pfon: {suls['vfinlpfon']:.3f}") pin(f" pion vns: {suls['olpionvns']}") pin(f" Lnin ffiiny: {suls['vlninffiiny']:.3f}") pin("\nL.I.F.. Pinipls ons:") fo pinipl in suls["lifpiniplsons"]: pin(f" - {pinipl}") pin("\nsuls xpo o JSON fils") pin("L.I.F.. hoy onsion opl sussfully!") xp xpion s : pin(f"onsion fil: {}") if n == "in": synio.un(in())