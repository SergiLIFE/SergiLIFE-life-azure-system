""" ZU LOI PPS PNNY FIX & SOLUION BI ==================================================== opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu Loi pps Bu Pvnion Sys his sip fixs h "vunfin" NoJS ownlo bu n s  pnn soluion bi o pvn zu Loi pps pnny issus. INIFI BU: - NoJS vsion vibl is unfin in zu Loi pps xnsion - UL bos: hps://nojs.o/is/vunfin/no-vunfin-win-x64.zip - his uss ownlo filus n insllion pobls SOLUION: 1. Fix h NoJS vsion ion 2. ownlo n insll o vsions nully 3.   pnn soluion bi 4. onio n pvn fuu ouns """ ipo os ipo sys ipo json ipo ullib.qus ipo zipfil ipo shuil ipo subposs fo phlib ipo Ph fo i ipo i lss zuLoippsFix: """Fixs zu Loi pps pnny issus""" f ini(slf): slf.bsph = Ph.ho() / ".zuloipps" / "pnnis" slf.pph = Ph.ho() / "pp" / "Lol" / "p" / ".zuloipps" slf.nojsvsions = { "ls": "20.18.0", "sbl": "22.11.0", "fllb": "18.20.4" } f inosissu(slf): """inos h un zu Loi pps pnny s""" pin(" INOSIN ZU LOI PPS PNNIS") pin("=" * 60) issus = [] # h NoJS insllion nojsph = slf.bsph / "NoJs" if no nojsph.xiss(): issus.ppn("NoJS no insll in zu Loi pps pnnis") ls: # h if i's  vli insllion nox = nojsph / "no.x" if no nox.xiss(): issus.ppn("NoJS insllion is oup (no no.x)") # h Funoools funph = slf.bsph / "Funoools" if no funph.xiss(): issus.ppn("zu Funions o ools no insll") ls: funx = funph / "fun.x" if no funx.xiss(): issus.ppn("Funions o ools insllion is oup") # h oNS onph = slf.bsph / "oNS" if no onph.xiss(): issus.ppn("oN S no insll") if issus: pin(" ISSUS :") fo issu in issus: pin(f" • {issu}") ls: pin(" ll pnnis pp o b insll") un issus f fixnojspnny(slf): """Fix h NoJS unfin vsion issu""" pin("\n FIXIN NOJS PNNY") pin("-" * 40) y: #  iois nojsph = slf.bsph / "NoJs" nojsph.i(pns=u, xiso=u) # y iffn NoJS vsions unil on wos fo vsionn, vsion in slf.nojsvsions.is(): pin(f" pin o ownlo NoJS {vsion} ({vsionn})...") ul = f"hps://nojs.o/is/v{vsion}/no-v{vsion}-win-x64.zip" pzip = slf.pph / f"nojs-{vsion}.zip" pzip.pn.i(pns=u, xiso=u) y: # ownlo pin(f" ownloin fo: {ul}") ullib.qus.uliv(ul, pzip) # x pin(f" xin o: {nojsph}") wih zipfil.ZipFil(pzip, '') s zipf: # x ll fils zipf.xll(slf.pph) # ov fils o o loion xi = slf.pph / f"no-v{vsion}-win-x64" if xi.xiss(): # opy ll fils fo x i o nojsph fo i in xi.ii(): if i.isi(): shuil.opy(i, nojsph / i.n, isxiso=u) ls: shuil.opy2(i, nojsph / i.n) # Vify insllion nox = nojsph / "no.x" if nox.xiss(): # s NoJS sul = subposs.un([s(nox), "--vsion"], puoupu=u, x=u) if sul.uno == 0: pin(f" NoJS {vsion} insll sussfully") pin(f" Vsion: {sul.sou.sip()}") # ln up if pzip.xiss(): pzip.unlin() if xi.xiss(): shuil.(xi) un u xp xpion s : pin(f" Fil o insll NoJS {vsion}: {}") oninu pin(" ll NoJS vsions fil o insll") un Fls xp xpion s : pin(f" iil o fixin NoJS: {}") un Fls f fixfunoools(slf): """Fix zu Funions o ools""" pin("\n FIXIN ZU FUNIONS O OOLS") pin("-" * 40) y: funph = slf.bsph / "Funoools" funph.i(pns=u, xiso=u) # ownlo Funions o ools 4.3.0 ul = "hps://ihub.o/zu/zu-funions-o-ools/lss/ownlo/4.0.5907/zu.Funions.li.win-x64.4.0.5907.zip" pzip = slf.pph / "fun-o-ools.zip" pzip.pn.i(pns=u, xiso=u) pin(f" ownloin fo: {ul}") ullib.qus.uliv(ul, pzip) pin(f" xin o: {funph}") wih zipfil.ZipFil(pzip, '') s zipf: zipf.xll(funph) # Vify insllion funx = funph / "fun.x" if funx.xiss(): sul = subposs.un([s(funx), "--vsion"], puoupu=u, x=u) if sul.uno == 0: pin(f" Funions o ools insll sussfully") pin(f" Vsion: {sul.sou.sip()}") # ln up if pzip.xiss(): pzip.unlin() un u pin(" Funions o ools insllion fil") un Fls xp xpion s : pin(f" o fixin Funions o ools: {}") un Fls f fixons(slf): """Fix oN S insllion""" pin("\n FIXIN ON S") pin("-" * 40) y: onph = slf.bsph / "oNS" onph.i(pns=u, xiso=u) # ownlo h insll sip sipul = "hps://o.n/v1/on-insll.ps1" sipph = slf.pph / "on-insll.ps1" sipph.pn.i(pns=u, xiso=u) pin(f" ownloin insll sip fo: {sipul}") ullib.qus.uliv(sipul, sipph) # un h PowShll sip pin(f" Insllin oN S o: {onph}")  = [ "powshll", "-xuionPoliy", "Bypss", "-Fil", s(sipph), "-Inslli", s(onph), "-hnnl", "6.0" ] sul = subposs.un(, puoupu=u, x=u) if sul.uno == 0: pin(" oN S insll sussfully") # ln up if sipph.xiss(): sipph.unlin() un u ls: pin(f" oN S insllion fil: {sul.s}") un Fls xp xpion s : pin(f" o fixin oN S: {}") un Fls f soluionbi(slf): """  pnn soluion bi o pvn fuu issus""" pin("\n ️ IN SOLUION BI") pin("-" * 40) y: #   onioin sip bisip = slf.bsph / "pnnyonio.py" bionn = '''""" zu Loi pps pnny onio Pvns h "vunfin" NoJS bu n oh pnny issus """ ipo os ipo sys ipo subposs fo phlib ipo Ph f hnojs(): """nsu NoJS is poply insll""" nojsph = Ph.ho() / ".zuloipps" / "pnnis" / "NoJs" nox = nojsph / "no.x" if no nox.xiss(): pin("WNIN: NoJS issin - iin insll") un Fls y: sul = subposs.un([s(nox), "--vsion"], puoupu=u, x=u, iou=5) if sul.uno == 0: un u xp: pss pin("WNIN: NoJS oup - iin insll") un Fls f oniopnnis(): """onio ll zu Loi pps pnnis""" issus = [] if no hnojs(): issus.ppn("NoJS") un issus if n == "in": issus = oniopnnis() if issus: pin(f"PNNY ISSUS : {', '.join(issus)}") sys.xi(1) ls: pin("ll pnnis O") sys.xi(0) ''' wih opn(bisip, 'w', noin='uf-8') s f: f.wi(bionn) #   shul s onfiuion sonfi = { "n": "zu Loi pps pnny onio", "sipion": "onios n fixs zu Loi pps pnnis", "sipph": s(bisip), "": i.now().isofo(), "sus": "iv" } onfifil = slf.bsph / "bionfi.json" wih opn(onfifil, 'w', noin='uf-8') s f: json.up(sonfi, f, inn=2) pin(" Soluion bi  sussfully") pin(f" onio sip: {bisip}") pin(f" onfiuion: {onfifil}") un u xp xpion s : pin(f" o in soluion bi: {}") un Fls f unoplfix(slf): """un h opl fix poss""" pin(" ZU LOI PPS OPL FIX") pin("=" * 60) pin(f"isp: {i.now().isofo()}") pin(f"Bs Ph: {slf.bsph}") pin("=" * 60) # Sp 1: inos issus = slf.inosissu() # Sp 2: Fix h oponn fixsppli = [] if ny("NoJS" in issu fo issu in issus): if slf.fixnojspnny(): fixsppli.ppn("NoJS") if ny("Funions" in issu fo issu in issus): if slf.fixfunoools(): fixsppli.ppn("Funions o ools") if ny("oN" in issu fo issu in issus): if slf.fixons(): fixsppli.ppn("oN S") # Sp 3:  soluion bi bi = slf.soluionbi() # Sp 4: Finl po pin("\n" + "=" * 60) pin(" FINL PO") pin("=" * 60) if fixsppli: pin(" FIXS PPLI:") fo fix in fixsppli: pin(f" • {fix}") ls: pin("ℹ️ No fixs w n") if bi: pin(" Soluion bi  sussfully") ls: pin(" Soluion bi ion fil") # Sp 5: Vifiion pin("\n VIFIION:") finlissus = slf.inosissu() if no finlissus: pin(" ll pnnis  now poply insll!") pin(" h 'vunfin' NoJS bu hs bn liin!") ls: pin(" ️ So issus in:") fo issu in finlissus: pin(f" • {issu}") un ln(finlissus) == 0 f in(): """in xuion""" y: fix = zuLoippsFix() suss = fix.unoplfix() if suss: pin("\n SUSS: zu Loi pps pnnis  fully fix!") pin(" ️ Soluion bi is iv o pvn fuu issus.") sys.xi(0) ls: pin("\n ️ PIL SUSS: So issus y in.") pin(" y unnin his sip in o h nully.") sys.xi(1) xp xpion s : pin(f"\n IIL O: {}") ipo b b.pinx() sys.xi(2) if n == "in": in()