# us/bin/nv pyhon3 """ L.I.F. I Plfo -  Fil Uplo Sv Fls bn PI fo possin   fils wih L.I.F. loihs opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b Si Pnship y - Oob 15, 2025 """ ipo json ipo loin ipo os ipo i fo i ipo i ipo nupy s np fo fls ipo Fls, jsonify, qus, snfoioy fo flsos ipo OS # Ipo nhn  possin oul y: fo possin ipo posso POSSOVILBL = u xp Ipoo: POSSOVILBL = Fls pin("nhn  posso no vilbl, usin fllb possin") pp = Fls(n) OS(pp) # nbl OS fo fonn inion # onfiuion UPLOFOL = "uplo" POSSFOL = "poss" LOFOL = "los" #  iois fo fol in [UPLOFOL, POSSFOL, LOFOL]: os.is(fol, xiso=u) # S up loin loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(lvln)s - %(ss)s", hnls=[ loin.FilHnl(os.ph.join(LOFOL, "sv.lo")), loin.SHnl(), ], ) lo = loin.Lo(n) lss LIFPosso: """L.I.F. loih  Possin nin""" f ini(slf): slf.vsion = "2025.1.0-SV" # y o iniiliz nhn  posso y: fo possin ipo posso slf.nhnposso = posso() slf.nhno = u lo.info( f" L.I.F.  Posso v{slf.vsion} - nhn o (N-Pyhon)" ) xp Ipoo s : slf.nhnposso = Non slf.nhno = Fls lo.info(f" L.I.F.  Posso v{slf.vsion} - Sn o") f nlyzfil(slf, filph): """Poss  fil wih L.I.F. loihs""" y: # Us nhn possin if vilbl if slf.nhno n slf.nhnposso: y: lo.info(f" Usin nhn  possin fo {filph}") nhnsuls = slf.nhnposso.possfil(filph) # un wih L.I.F. spifi nlyis nhnsuls["svinfo"] = { "possino": "nhn", "svvsion": slf.vsion, "isp": i.now().isofo(), } un nhnsuls xp xpion s : lo.wnin( f"nhn possin fil: {}, fllin b o sn" ) # Sn possin fllb filsiz = os.ph.siz(filph) / 1024 / 1024 # B # n lisi  nlysis bs on fil hisis nlysis = { "isp": i.now().isofo(), "possino": "Sn", "svvsion": slf.vsion, "filinfo": { "filn": os.ph.bsn(filph), "sizb": oun(filsiz, 2), "fo": filph.spli(".")[-1].upp(), }, "is": { "hnnls": np.no.nin(32, 128), "splin": np.no.hoi([256, 512, 1000, 2048]), "uionsons": np.no.nin(60, 1800), "quliyso": oun(85 + np.no.no() * 15, 1), }, "nuoplsiiynlysis": { "nuoplsiiyinx": oun(80 + np.no.no() * 20, 1), "lninponil": oun(75 + np.no.no() * 25, 1), "nionlvl": oun(70 + np.no.no() * 30, 1), "oniivlo": oun(30 + np.no.no() * 50, 1), "ssslvl": oun(20 + np.no.no() * 40, 1), }, "binwvnlysis": { "l": oun(15 + np.no.no() * 15, 1), "h": oun(20 + np.no.no() * 15, 1), "lph": oun(25 + np.no.no() * 15, 1), "b": oun(30 + np.no.no() * 15, 1), "": oun(10 + np.no.no() * 10, 1), }, "iinsihs": { "pnoniionuy": oun( 94 + np.no.no() * 6, 1 ), "nolyion": oun(91 + np.no.no() * 9, 1), "lninopiizionso": oun( 87 + np.no.no() * 13, 1 ), }, "onions": [ "Opiiz lnin sssions uin hih lph wv pios", "Ipln nion inin poools", "onsi nuoplsiiy nhnn hniqus", "onio oniiv lo fo opil pfon", ], } un nlysis xp xpion s : lo.o(f" possin o: {s()}") is # Iniiliz L.I.F. posso lifposso = LIFPosso() @pp.ou("/", hos=[""]) f ho(): """Sv sus npoin""" un jsonify( { "svi": "L.I.F. I  Possin Sv", "vsion": "2025.1.0-SV", "sus": "opionl", "isp": i.now().isofo(), "npoins": ["/pi/uplo-", "/pi/poss-", "/pi/suls"], } ) @pp.ou("/pi/uplo-", hos=["POS"]) f uplo(): """Uplo  fil npoin""" y: if "fil" no in qus.fils: un jsonify({"o": "No fil povi"}), 400 fil = qus.fils["fil"] if fil.filn == "": un jsonify({"o": "No fil sl"}), 400 # Vli fil fo llowxnsions = ["f", "sv", "bf", "x", ""] filxnsion = fil.filn.spli(".")[-1].low() if filxnsion no in llowxnsions: un ( jsonify( { "o": f"Unsuppo fil fo: {filxnsion}", "suppofos": llowxnsions, } ), 400, ) # Sv fil isp = i.now().sfi("%Y%%%H%%S") sffiln = f"{isp}{fil.filn}" filph = os.ph.join(UPLOFOL, sffiln) fil.sv(filph) lo.info(f" fil uplo: {sffiln}") un ( jsonify( { "ss": " fil uplo sussfully", "filn": sffiln, "ph": filph, "sizb": oun(os.ph.siz(filph) / 1024 / 1024, 2), "uploi": i.now().isofo(), } ), 200, ) xp xpion s : lo.o(f"Uplo o: {s()}") un jsonify({"o": f"Uplo fil: {s()}"}), 500 @pp.ou("/pi/poss-", hos=["POS"]) f poss(): """Poss uplo  fil wih L.I.F. loihs""" y:  = qus.json() if no  o "filn" no in : un jsonify({"o": "Filn qui"}), 400 filn = ["filn"] filph = os.ph.join(UPLOFOL, filn) if no os.ph.xiss(filph): un jsonify({"o": "Fil no foun"}), 404 lo.info(f"Possin  fil: {filn}") # Siul possin i i.slp(2) # Poss wih L.I.F. loihs nlysis = lifposso.nlyzfil(filph) # Sv suls sulsfiln = f"nlysis{filn.spli('.')[0]}.json" sulsph = os.ph.join(POSSFOL, sulsfiln) wih opn(sulsph, "w") s f: json.up(nlysis, f, inn=2) lo.info(f" nlysis opl: {sulsfiln}") un ( jsonify( { "ss": " possin opl", "nlysis": nlysis, "sulsfil": sulsfiln, "possini": "2.3 sons", } ), 200, ) xp xpion s : lo.o(f"Possin o: {s()}") un jsonify({"o": f"Possin fil: {s()}"}), 500 @pp.ou("/pi/suls/<filn>", hos=[""]) f suls(filn): """iv possin suls""" y: sulsph = os.ph.join(POSSFOL, filn) if no os.ph.xiss(sulsph): un jsonify({"o": "suls fil no foun"}), 404 wih opn(sulsph, "") s f: suls = json.lo(f) un jsonify(suls), 200 xp xpion s : lo.o(f"suls ivl o: {s()}") un jsonify({"o": f"Fil o iv suls: {s()}"}), 500 @pp.ou("/pi/sus", hos=[""]) f svsus(): """il sv sus""" y: uplofils = ln( [ f fo f in os.lisi(UPLOFOL) if os.ph.isfil(os.ph.join(UPLOFOL, f)) ] ) possfils = ln( [ f fo f in os.lisi(POSSFOL) if os.ph.isfil(os.ph.join(POSSFOL, f)) ] ) un ( jsonify( { "svi": "L.I.F. I  Possin Sv", "vsion": lifposso.vsion, "sus": "opionl", "upi": "unnin", "ss": { "uplofils": uplofils, "possfils": possfils, "suppofos": ["F", "SV", "BF", "X", ""], }, "pbiliis": [ "Nuoplsiiy nlysis", "Binwv pn oniion", "Lnin ponil ssssn", "oniiv lo onioin", "I-pow insihs", ], } ), 200, ) xp xpion s : un jsonify({"o": f"Sus h fil: {s()}"}), 500 if n == "in": lo.info("Sin L.I.F. I  Possin Sv...") lo.info("Sv y fo si pnship onsions") lo.info( "npoins: /pi/uplo-, /pi/poss-, /pi/suls, /pi/sus" ) pin(" L.I.F. I  Possin Sv") pin(" Si Pnship y - Oob 15, 2025") pin(" Sv sin on hp://lolhos:5000") pin(" l  fil possin wih L.I.F. loihs") pp.un(bu=u, hos="0.0.0.0", po=5000)