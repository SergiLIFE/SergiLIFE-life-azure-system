# us/bin/nv pyhon3 """ L.I.F. Plfo - Pouion ployn n opl ployn ohsion fo in L.I.F. plfo his oul ns h opl pouion ployn of h in L.I.F. plfo inluin zu infsuu, ubns ployn, onioin sup, n vliion. opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b """ ipo synio ipo json ipo loin ipo os ipo subposs ipo i fo lsss ipo lss fo i ipo i fo ypin ipo ny, i, Lis, Opionl # onfiu loin loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(lvln)s - %(ss)s" ) lo = loin.Lo(n) @lss lss ploynonfi: """ployn onfiuion sins""" nvionn: s subsipioni: s sououp: s loion: s ppn: s nblonioin: bool = u nbluoslin: bool = u nblslfhlin: bool = u @lss lss ploynsul: """sul of  ployn opion""" opion: s suss: bool ss: s uionsons: flo sous: Lis[s] os: Lis[s] lss Pouionploynn: """ns opl pouion ployn of L.I.F. plfo""" f ini(slf, onfi: ploynonfi): slf.onfi = onfi slf.ploynsuls: Lis[ploynsul] = [] slf.si = Non syn f ployoplplfo(slf) -> i[s, ny]: """ploy opl L.I.F. plfo o pouion""" lo.info(" Sin L.I.F. Plfo Pouion ployn") lo.info("=" * 70) lo.info(f"nvionn: {slf.onfi.nvionn}") lo.info(f"Subsipion: {slf.onfi.subsipioni}") lo.info(f"sou oup: {slf.onfi.sououp}") lo.info(f"Loion: {slf.onfi.loion}") lo.info("=" * 70) slf.si = i.now() ploynphss = [ ("zu Infsuu Sup", slf.ployzuinfsuu), ("o Funion ployn", slf.ployofunions), ("Plfo oponns", slf.ployplfooponns), ("onioin & lin", slf.suponioin), ("uo-slin onfiuion", slf.onfiuuoslin), ("Slf-Hlin Sup", slf.supslfhlin), ("Nwo Suiy", slf.onfiusuiy), ("Pouion Vliion", slf.vlipouionployn), ("NS & SSL onfiuion", slf.onfiunsssl), ("Bup & ovy", slf.supbupovy), ] y: fo phsn, phsfunion in ploynphss: lo.info(f" xuin: {phsn}") sul = wi slf.xuploynphs( phsn, phsfunion ) slf.ploynsuls.ppn(sul) if sul.suss: lo.info(f" SUSS ({sul.uionsons:.1f}s)") ls: lo.o(f" FIL ({sul.uionsons:.1f}s)") fo o in sul.os: lo.o(f" o: {o}") # iil phs filu - bo ployn if phsn in [ "zu Infsuu Sup", "o Funion ployn", ]: lo.o(" iil phs fil - boin ployn") wi slf.ollbployn() un slf.nploynpo(suss=Fls) # n finl ployn po po = slf.nploynpo(suss=u) # isply ployn suy slf.isplyploynsuy(po) un po xp xpion s : lo.o(f" ployn o: {}") wi slf.ollbployn() un slf.nploynpo(suss=Fls, o=s()) syn f xuploynphs( slf, n: s, phsfunion ) -> ploynsul: """xu iniviul ployn phs wih iin n o hnlin""" si = i.i() y: phssul = wi phsfunion() uion = i.i() - si un ploynsul( opion=n, suss=phssul.("suss", Fls), ss=phssul.("ss", ""), uionsons=uion, sous=phssul.("sous", []), os=phssul.("os", []), ) xp xpion s : uion = i.i() - si un ploynsul( opion=n, suss=Fls, ss=f"Phs xuion fil: {}", uionsons=uion, sous=[], os=[s()], ) syn f ployzuinfsuu(slf) -> i[s, ny]: """ploy zu infsuu oponns""" lo.info(" ️ ployin zu infsuu...") y: #  sou oup if i osn' xis sul = wi slf.sououp() if no sul.("suss"): un { "suss": Fls, "os": ["Fil o  sou oup"], "sous": [], } # ploy infsuu oponns oponns = [ ("So oun", slf.ploysooun), ("y Vul", slf.ployyvul), ("ppliion Insihs", slf.ployppinsihs), ("Svi Bus", slf.ploysvibus), ("osos B", slf.ployososb), ("vn Hubs", slf.ployvnhubs), ("onin isy", slf.ployoninisy), ] sous = [] fo oponnn, ployfun in oponns: lo.info(f" ployin {oponnn}...") sul = wi ployfun() if sul.("suss"): sous.xn(sul.("sous", [])) ls: un { "suss": Fls, "os": [f"Fil o ploy {oponnn}"], "sous": sous, } un { "suss": u, "ss": "zu infsuu ploy sussfully", "sous": sous, } xp xpion s : un { "suss": Fls, "os": [f"Infsuu ployn o: {}"], "sous": [], } syn f ployofunions(slf) -> i[s, ny]: """ploy o L.I.F. funions""" lo.info(" ployin o funions...") y: #  Funion pp funionppsul = wi slf.funionpp() if no funionppsul.("suss"): un { "suss": Fls, "os": ["Fil o  Funion pp"], "sous": [], } # ploy funion o funionsoploy = [ "lifofunion.py", "plfoslfoniz.py", "xpinollo.py", "iniilizinplfo.py", ] ployfunions = [] fo funionfil in funionsoploy: lo.info(f" ployin {funionfil}...") sul = wi slf.ployfuniono(funionfil) if sul.("suss"): ployfunions.ppn(funionfil) ls: un { "suss": Fls, "os": [f"Fil o ploy {funionfil}"], "sous": ployfunions, } # onfiu funion sins sinssul = wi slf.onfiufunionsins() un { "suss": sinssul.("suss", u), "ss": "o funions ploy sussfully", "sous": ployfunions, } xp xpion s : un { "suss": Fls, "os": [f"o funions ployn o: {}"], "sous": [], } syn f ployplfooponns(slf) -> i[s, ny]: """ploy plfo oponns""" lo.info(" ployin plfo oponns...") y: # ploy ubns lus ssul = wi slf.ployslus() if no ssul.("suss"): un { "suss": Fls, "os": ["Fil o ploy S lus"], "sous": [], } # ploy plfo svis o ubns svis = [ ("shbo Svi", slf.ployshbosvi), (" Possin Svi", slf.ploysvi), ("pin n Svi", slf.ploypinsvi), ("onioin Svi", slf.ployonioinsvi), ] ploysvis = [] fo svin, ployfun in svis: lo.info(f" ployin {svin}...") sul = wi ployfun() if sul.("suss"): ploysvis.xn(sul.("svis", [])) ls: un { "suss": Fls, "os": [f"Fil o ploy {svin}"], "sous": ploysvis, } un { "suss": u, "ss": "Plfo oponns ploy sussfully", "sous": ploysvis, } xp xpion s : un { "suss": Fls, "os": [f"Plfo oponns ployn o: {}"], "sous": [], } syn f suponioin(slf) -> i[s, ny]: """Sup onioin n lin""" lo.info(" Sin up onioin...") y: onioinoponns = [] # onfiu ppliion Insihs insihssul = wi slf.onfiuppinsihs() if insihssul.("suss"): onioinoponns.ppn("ppliion Insihs") # Sup zu onio ls lssul = wi slf.suponiols() if lssul.("suss"): onioinoponns.xn(lssul.("ls", [])) # onfiu Lo nlyis lossul = wi slf.suplonlyis() if lossul.("suss"): onioinoponns.ppn("Lo nlyis") # Sup uso shbos shbosul = wi slf.onioinshbos() if shbosul.("suss"): onioinoponns.xn(shbosul.("shbos", [])) un { "suss": ln(onioinoponns) > 0, "ss": "onioin sup opl", "sous": onioinoponns, } xp xpion s : un { "suss": Fls, "os": [f"onioin sup o: {}"], "sous": [], } syn f onfiuuoslin(slf) -> i[s, ny]: """onfiu inllin uo-slin""" lo.info(" onfiuin uo-slin...") y: if no slf.onfi.nbluoslin: un { "suss": u, "ss": "uo-slin isbl by onfiuion", "sous": [], } uoslinonfis = [] # onfiu Funion pp uoslin funionsslin = wi slf.onfiufunionsuoslin() if funionsslin.("suss"): uoslinonfis.ppn("Funion pp Slin") # onfiu S uoslin sslin = wi slf.onfiusuoslin() if sslin.("suss"): uoslinonfis.ppn("S lus Slin") # Sup piiv slin piivslin = wi slf.suppiivslin() if piivslin.("suss"): uoslinonfis.ppn("Piiv Slin") un { "suss": ln(uoslinonfis) > 0, "ss": "uo-slin onfiu sussfully", "sous": uoslinonfis, } xp xpion s : un { "suss": Fls, "os": [f"uo-slin onfiuion o: {}"], "sous": [], } syn f supslfhlin(slf) -> i[s, ny]: """Sup slf-hlin pbiliis""" lo.info(" Sin up slf-hlin...") y: if no slf.onfi.nblslfhlin: un { "suss": u, "ss": "Slf-hlin isbl by onfiuion", "sous": [], } hlinoponns = [] # onfiu hlh hs hlhhs = wi slf.onfiuhlhhs() if hlhhs.("suss"): hlinoponns.xn(hlhhs.("hs", [])) # Sup uo-ovy ovysup = wi slf.supuoovy() if ovysup.("suss"): hlinoponns.ppn("uo ovy") # onfiu filu ion filuion = wi slf.onfiufiluion() if filuion.("suss"): hlinoponns.ppn("Filu ion") un { "suss": ln(hlinoponns) > 0, "ss": "Slf-hlin sup opl", "sous": hlinoponns, } xp xpion s : un { "suss": Fls, "os": [f"Slf-hlin sup o: {}"], "sous": [], } syn f onfiusuiy(slf) -> i[s, ny]: """onfiu nwo suiy n ss onols""" lo.info(" onfiuin suiy...") y: suiyonfis = [] # onfiu Nwo Suiy oups nssul = wi slf.onfiunwosuiy() if nssul.("suss"): suiyonfis.ppn("Nwo Suiy oups") # Sup zu  uhniion uhsul = wi slf.supzuuh() if uhsul.("suss"): suiyonfis.ppn("zu  uhniion") # onfiu y Vul ss poliis yvulsul = wi slf.onfiuyvulpoliis() if yvulsul.("suss"): suiyonfis.ppn("y Vul Poliis") # Sup PI nn pisul = wi slf.suppinn() if pisul.("suss"): suiyonfis.ppn("PI nn") un { "suss": ln(suiyonfis) > 0, "ss": "Suiy onfiuion opl", "sous": suiyonfis, } xp xpion s : un { "suss": Fls, "os": [f"Suiy onfiuion o: {}"], "sous": [], } syn f vlipouionployn(slf) -> i[s, ny]: """Vli pouion ployn""" lo.info(" Vliin pouion ployn...") y: vliionsuls = [] # s o funionliy os = wi slf.sofunionliy() vliionsuls.ppn( ("o Funionliy", os.("suss", Fls)) ) # s uo-slin slins = wi slf.suoslin() vliionsuls.ppn( ("uo-slin", slins.("suss", Fls)) ) # s slf-hlin hlins = wi slf.sslfhlin() vliionsuls.ppn( ("Slf-hlin", hlins.("suss", Fls)) ) # s onioin onioins = wi slf.sonioin() vliionsuls.ppn( ("onioin", onioins.("suss", Fls)) ) # s suiy suiys = wi slf.ssuiy() vliionsuls.ppn(("Suiy", suiys.("suss", Fls))) pssss = [n fo n, pss in vliionsuls if pss] filss = [n fo n, pss in vliionsuls if no pss] suss = ( ln(pssss) / ln(vliionsuls) if vliionsuls ls 0 ) ploynvli = suss >= 0.8 # 80% pss  qui un { "suss": ploynvli, "ss": f"Vliion opl - {suss:.1%} pss ", "sous": pssss, "os": ( [f"Fil vliion: {s}" fo s in filss] if filss ls [] ), } xp xpion s : un { "suss": Fls, "os": [f"Pouion vliion o: {}"], "sous": [], } syn f onfiunsssl(slf) -> i[s, ny]: """onfiu NS n SSL ifis""" lo.info(" onfiuin NS n SSL...") y: nsonfis = [] # onfiu uso oin oinsul = wi slf.onfiuusooin() if oinsul.("suss"): nsonfis.ppn("uso oin") # Sup SSL ifis sslsul = wi slf.supsslifis() if sslsul.("suss"): nsonfis.ppn("SSL ifis") # onfiu N nsul = wi slf.supn() if nsul.("suss"): nsonfis.ppn("N onfiuion") un { "suss": ln(nsonfis) > 0, "ss": "NS n SSL onfiuion opl", "sous": nsonfis, } xp xpion s : un { "suss": Fls, "os": [f"NS/SSL onfiuion o: {}"], "sous": [], } syn f supbupovy(slf) -> i[s, ny]: """Sup bup n iss ovy""" lo.info(" Sin up bup n ovy...") y: buponfis = [] # onfiu bs bups bbup = wi slf.onfiubsbups() if bbup.("suss"): buponfis.ppn("bs Bups") # Sup blob so bups blobbup = wi slf.onfiublobbups() if blobbup.("suss"): buponfis.ppn("Blob So Bups") # onfiu iss ovy sup = wi slf.supissovy() if sup.("suss"): buponfis.ppn("iss ovy") un { "suss": ln(buponfis) > 0, "ss": "Bup n ovy sup opl", "sous": buponfis, } xp xpion s : un { "suss": Fls, "os": [f"Bup/ovy sup o: {}"], "sous": [], } syn f ollbployn(slf) -> Non: """ollb ployn in s of filu""" lo.wnin(" Iniiin ployn ollb...") y: #  lis of  sous fo sussful phss sous = [] fo sul in slf.ploynsuls: if sul.suss: sous.xn(sul.sous) if no sous: lo.info("No sous o ollb") un # p o ln up sous lo.info(f"ollin b {ln(sous)} sous...") # his is  siplifi ollb - in pouion, you' wn o sophisi lnup ollbsul = wi slf.lnupsous(sous) if ollbsul.("suss"): lo.info(" ollb opl sussfully") ls: lo.o( " ollb noun os - nul lnup y b qui" ) xp xpion s : lo.o(f" ollb fil: {}") f nploynpo( slf, suss: bool, o: s = Non ) -> i[s, ny]: """n ophnsiv ployn po""" olphss = ln(slf.ploynsuls) sussfulphss = ln([ fo  in slf.ploynsuls if .suss]) filphss = olphss - sussfulphss oli = ( (i.now() - slf.si).olsons() if slf.si ls 0 ) llsous = [] llos = [] fo sul in slf.ploynsuls: llsous.xn(sul.sous) llos.xn(sul.os) un { "ploynisp": i.now(), "nvionn": slf.onfi.nvionn, "subsipioni": slf.onfi.subsipioni, "sououp": slf.onfi.sououp, "suy": { "suss": suss, "olphss": olphss, "sussfulphss": sussfulphss, "filphss": filphss, "oluionsons": oli, "sousoun": ln(llsous), "osoun": ln(llos), }, "phssuls": [ { "opion": .opion, "suss": .suss, "ss": .ss, "uionsons": .uionsons, "sous": .sous, "os": .os, } fo  in slf.ploynsuls ], "sous": llsous, "os": llos + ([o] if o ls []), "sus": "SUSS" if suss ls "FIL", } f isplyploynsuy(slf, po: i[s, ny]) -> Non: """isply ployn suy""" suy = po["suy"] lo.info("=" * 70) lo.info(" L.I.F. PLFO POUION PLOYN OPL") lo.info("=" * 70) lo.info(f" nvionn: {po['nvionn']}") lo.info(f" Subsipion: {po['subsipioni']}") lo.info(f" sou oup: {po['sououp']}") lo.info(f" ol Phss: {suy['olphss']}") lo.info(f" Sussful: {suy['sussfulphss']}") lo.info(f" Fil: {suy['filphss']}") lo.info(f" ️ sous : {suy['sousoun']}") lo.info(f" ️ ol i: {suy['oluionsons']:.1f}s") lo.info("=" * 70) if suy["suss"]: lo.info(" PLOYN: SUSSFUL") lo.info(" L.I.F. Plfo is now liv in pouion") ls: lo.o(" PLOYN: FIL") lo.o(" h os n y ployn") lo.info("=" * 70) # Plhol hos fo zu sou ployn # In pouion, hs woul onin ul zu LI/S lls syn f sououp(slf) -> i[s, bool]: wi synio.slp(0.5) un {"suss": u} syn f ploysooun(slf) -> i[s, ny]: wi synio.slp(1.0) un {"suss": u, "sous": ["so-oun"]} syn f ployyvul(slf) -> i[s, ny]: wi synio.slp(0.8) un {"suss": u, "sous": ["y-vul"]} syn f ployppinsihs(slf) -> i[s, ny]: wi synio.slp(0.6) un {"suss": u, "sous": ["pp-insihs"]} syn f ploysvibus(slf) -> i[s, ny]: wi synio.slp(0.7) un {"suss": u, "sous": ["svi-bus"]} syn f ployososb(slf) -> i[s, ny]: wi synio.slp(1.2) un {"suss": u, "sous": ["osos-b"]} syn f ployvnhubs(slf) -> i[s, ny]: wi synio.slp(0.9) un {"suss": u, "sous": ["vn-hubs"]} syn f ployoninisy(slf) -> i[s, ny]: wi synio.slp(0.8) un {"suss": u, "sous": ["onin-isy"]} syn f funionpp(slf) -> i[s, bool]: wi synio.slp(1.5) un {"suss": u} syn f ployfuniono(slf, funionfil: s) -> i[s, bool]: wi synio.slp(0.8) un {"suss": u} syn f onfiufunionsins(slf) -> i[s, bool]: wi synio.slp(0.5) un {"suss": u} syn f ployslus(slf) -> i[s, bool]: wi synio.slp(3.0) # S s lon un {"suss": u} syn f ployshbosvi(slf) -> i[s, ny]: wi synio.slp(1.0) un {"suss": u, "svis": ["shbo-svi"]} syn f ploysvi(slf) -> i[s, ny]: wi synio.slp(1.2) un {"suss": u, "svis": ["-svi"]} syn f ploypinsvi(slf) -> i[s, ny]: wi synio.slp(0.8) un {"suss": u, "svis": ["pin-svi"]} syn f ployonioinsvi(slf) -> i[s, ny]: wi synio.slp(0.9) un {"suss": u, "svis": ["onioin-svi"]} syn f onfiuppinsihs(slf) -> i[s, bool]: wi synio.slp(0.4) un {"suss": u} syn f suponiols(slf) -> i[s, ny]: wi synio.slp(0.6) un {"suss": u, "ls": ["hih-lny-l", "o--l"]} syn f suplonlyis(slf) -> i[s, bool]: wi synio.slp(0.5) un {"suss": u} syn f onioinshbos(slf) -> i[s, ny]: wi synio.slp(0.7) un { "suss": u, "shbos": ["pfon-shbo", "hlh-shbo"], } syn f onfiufunionsuoslin(slf) -> i[s, bool]: wi synio.slp(0.4) un {"suss": u} syn f onfiusuoslin(slf) -> i[s, bool]: wi synio.slp(0.6) un {"suss": u} syn f suppiivslin(slf) -> i[s, bool]: wi synio.slp(0.5) un {"suss": u} syn f onfiuhlhhs(slf) -> i[s, ny]: wi synio.slp(0.4) un {"suss": u, "hs": ["livnss-h", "inss-h"]} syn f supuoovy(slf) -> i[s, bool]: wi synio.slp(0.6) un {"suss": u} syn f onfiufiluion(slf) -> i[s, bool]: wi synio.slp(0.5) un {"suss": u} syn f onfiunwosuiy(slf) -> i[s, bool]: wi synio.slp(0.7) un {"suss": u} syn f supzuuh(slf) -> i[s, bool]: wi synio.slp(0.8) un {"suss": u} syn f onfiuyvulpoliis(slf) -> i[s, bool]: wi synio.slp(0.4) un {"suss": u} syn f suppinn(slf) -> i[s, bool]: wi synio.slp(1.0) un {"suss": u} syn f sofunionliy(slf) -> i[s, bool]: wi synio.slp(1.0) un {"suss": u} syn f suoslin(slf) -> i[s, bool]: wi synio.slp(0.8) un {"suss": u} syn f sslfhlin(slf) -> i[s, bool]: wi synio.slp(0.9) un {"suss": u} syn f sonioin(slf) -> i[s, bool]: wi synio.slp(0.6) un {"suss": u} syn f ssuiy(slf) -> i[s, bool]: wi synio.slp(0.7) un {"suss": u} syn f onfiuusooin(slf) -> i[s, bool]: wi synio.slp(0.8) un {"suss": u} syn f supsslifis(slf) -> i[s, bool]: wi synio.slp(0.9) un {"suss": u} syn f supn(slf) -> i[s, bool]: wi synio.slp(0.7) un {"suss": u} syn f onfiubsbups(slf) -> i[s, bool]: wi synio.slp(0.6) un {"suss": u} syn f onfiublobbups(slf) -> i[s, bool]: wi synio.slp(0.5) un {"suss": u} syn f supissovy(slf) -> i[s, bool]: wi synio.slp(0.8) un {"suss": u} syn f lnupsous(slf, sous: Lis[s]) -> i[s, bool]: wi synio.slp(2.0) un {"suss": u} syn f in(): """in funion fo pouion ployn""" pin(" L.I.F. Plfo - Pouion ployn n") pin("=" * 60) pin("opl pouion ployn ohsion") pin("opyih 2025 - Sio Py Boull") pin("=" * 60) pin() # Pouion ployn onfiuion onfi = ploynonfi( nvionn="pouion", subsipioni="588f6-f243-497-98f-66086575", sououp="-lif-plfo-po", loion="sus2", ppn="lif-plfo-po", nblonioin=u, nbluoslin=u, nblslfhlin=u, ) # Iniiliz ployn n ploynn = Pouionploynn(onfi) y: # un opl ployn po = wi ploynn.ployoplplfo() # Sv ployn po isp = i.now().sfi("%Y%%%H%%S") pofil = f"lifpouionploynpo{isp}.json" # onv i o sin fo JSON silizion silizblpo = po.opy() silizblpo["ploynisp"] = po[ "ploynisp" ].isofo() wih opn(pofil, "w") s f: json.up(silizblpo, f, inn=2) lo.info(f" ployn po sv: {pofil}") # un ppopi xi o un 0 if po["suy"]["suss"] ls 1 xp yboInup: lo.info(" ployn inup by us") un 2 xp xpion s : lo.o(f" ployn o: {}") un 3 if n == "in": ipo sys y: xio = synio.un(in()) sys.xi(xio) xp xpion s : pin(f" iil o: {}") sys.xi(4)