# us/bin/nv pyhon3 """ L.I.F.. Plfo - oplin h uo oplin vliion fo uloy sns his oul povis ophnsiv oplin hin pbiliis fo h L.I.F.. Plfo, nsuin hn o uloy sns inluin HIP, P, SO2, ISO27001, n zu suiy quins. opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b """ ipo synio ipo json ipo loin ipo os ipo  fo onun.fuus ipo hPoolxuo fo lsss ipo lss, fil fo i ipo i, il fo nu ipo nu y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo ny, i, Lis, Opionl # onfiu loin loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(n)s - %(lvln)s - %(ss)s" ) lo = loin.Lo(n) lss oplinSn(nu): """oplin sns""" HIP = "hip" P = "p" SO2 = "so2" ISO27001 = "iso27001" NIS = "nis" PISS = "piss" ZUSUIY = "zusuiy" P = "p" FP = "fp" lss oplinSus(nu): """oplin h sus""" OPLIN = "oplin" NONOPLIN = "nonoplin" NOPPLIBL = "nopplibl" OPNSINONOL = "opnsinonol" UNVIW = "unviw" lss oplinSviy(nu): """oplin violion sviy""" IIL = "iil" HIH = "hih" IU = "iu" LOW = "low" INFO = "info" @lss lss oplinquin: """oplin quin finiion""" quini: s sn: oplinSn oy: s il: s sipion: s sviy: oplinSviy uoh: bool = u vinqui: Lis[s] = fil(fulfoy=lis) iionsps: Lis[s] = fil(fulfoy=lis) fns: Lis[s] = fil(fulfoy=lis) @lss lss oplinhsul: """sul of  oplin h""" hi: s quin: oplinquin sus: oplinSus vinfoun: Lis[s] = fil(fulfoy=lis) violions: Lis[s] = fil(fulfoy=lis) iionions: Lis[s] = fil(fulfoy=lis) h: i = fil(fulfoy=i.now) nos: s = "" @lss lss oplinssssn: """Ovll oplin ssssn""" ssssni: s sn: oplinSn si: i ni: Opionl[i] = Non uionsons: flo = 0.0 ovllsus: oplinSus = oplinSus.UNVIW oplinso: flo = 0.0 olquins: in = 0 oplinquins: in = 0 nonoplinquins: in = 0 noppliblquins: in = 0 iilviolions: in = 0 hihviolions: in = 0 ilsuls: Lis[oplinhsul] = fil(fulfoy=lis) suy: i[s, ny] = fil(fulfoy=i) onions: Lis[s] = fil(fulfoy=lis) lss oplinh: """ oplin h fo L.I.F.. Plfo Povis uo oplin vliion ins ulipl uloy sns inluin HIP, P, SO2, ISO27001, n zu suiy. """ f ini(slf, wospph: Opionl[s] = Non): slf.wospph = Ph(wospph o os.w()) # oplin quins bs slf.quins = slf.iniilizquins() # ssssn hisoy slf.ssssnhisoy: Lis[oplinssssn] = [] # h pool fo plll hin slf.xuo = hPoolxuo(xwos=4) lo.info( f"oplin h iniiliz fo wosp: {slf.wospph}" ) f iniilizquins( slf, ) -> i[oplinSn, Lis[oplinquin]]: """Iniiliz oplin quins fo h sn""" quins = {} # HIP quins quins[oplinSn.HIP] = [ oplinquin( quini="hipnypion", sn=oplinSn.HIP, oy=" Poion", il=" nypion", sipion="Po Hlh Infoion (PHI) us b nyp  s n in nsi", sviy=oplinSviy.IIL, vinqui=[ "nypions", "nypioninnsi", "ynn", ], iionsps=[ "Ipln S-256 nypion fo   s", "Us LS 1.3 fo  in nsi", "Ipln pop y nn wih zu y Vul", ], ), oplinquin( quini="hipssonol", sn=oplinSn.HIP, oy="ss onol", il="ss onol", sipion="Ipln ol-bs ss onol fo PHI ss", sviy=oplinSviy.HIH, vinqui=[ "biplnion", "ssloin", "lspivil", ], iionsps=[ "Ipln zu B fo sou ss", "nbl ss loin n onioin", "pply pinipl of ls pivil", ], ), oplinquin( quini="hipuiloin", sn=oplinSn.HIP, oy="ui & onioin", il="ui Loin", sipion="ll ss o PHI us b lo n uibl", sviy=oplinSviy.HIH, vinqui=["sslos", "lonion", "loiniy"], iionsps=[ "nbl ophnsiv ui loin", "Ipln lo nion poliis (6+ ys)", "nsu lo iniy n poion", ], ), ] # P quins quins[oplinSn.P] = [ oplinquin( quini="piniizion", sn=oplinSn.P, oy=" Poion", il=" iniizion", sipion="oll n poss only nssy psonl ", sviy=oplinSviy.IU, vinqui=[ "invnoy", "puposliiion", "nionpoliis", ], iionsps=[ "onu  invnoy n lssifiion", "fin l  possin puposs", "Ipln  nion shuls", ], ), oplinquin( quini="ponsnnn", sn=oplinSn.P, oy="onsn & ihs", il="onsn nn", sipion="Obin n n us onsn fo  possin", sviy=oplinSviy.HIH, vinqui=[ "onsnhnis", "onsnwihwl", "onsnos", ], iionsps=[ "Ipln l onsn hniss", "Povi sy onsn wihwl opions", "inin il onsn os", ], ), oplinquin( quini="ppobiliy", sn=oplinSn.P, oy=" Subj ihs", il=" Pobiliy", sipion="nbl  pobiliy fo  subjs", sviy=oplinSviy.IU, vinqui=[ "xpofunionliy", "fos", "uoxpos", ], iionsps=[ "Ipln  xpo funionliy", "Suppo oon  fos (JSON, SV)", "nbl uo  xpos", ], ), ] # zu Suiy quins quins[oplinSn.ZUSUIY] = [ oplinquin( quini="zuyvul", sn=oplinSn.ZUSUIY, oy="Ss nn", il="zu y Vul Us", sipion="Ss us b so n n in zu y Vul", sviy=oplinSviy.HIH, vinqui=[ "yvulinion", "soion", "sspoliis", ], iionsps=[ "In zu y Vul fo s nn", "Ipln uoi s oion", "onfiu pop ss poliis", ], ), oplinquin( quini="zuonioin", sn=oplinSn.ZUSUIY, oy="onioin & Loin", il="zu onio Inion", sipion="Ipln ophnsiv onioin n lin", sviy=oplinSviy.IU, vinqui=[ "zuoniosup", "luls", "lonlyis", ], iionsps=[ "onfiu zu onio fo ll sous", "S up ppopi l uls", "nbl Lo nlyis wosp", ], ), oplinquin( quini="zunwosuiy", sn=oplinSn.ZUSUIY, oy="Nwo Suiy", il="Nwo Suiy onols", sipion="Ipln nwo suiy bs pis", sviy=oplinSviy.HIH, vinqui=[ "nssonfiu", "fiwlluls", "pivnpoins", ], iionsps=[ "onfiu Nwo Suiy oups (NSs)", "S up zu Fiwll uls", "Us Piv npoins wh pplibl", ], ), ] # ISO 27001 quins (subs) quins[oplinSn.ISO27001] = [ oplinquin( quini="isoisssssn", sn=oplinSn.ISO27001, oy="is nn", il="is ssssn", sipion="onu ul is ssssns n ipln onols", sviy=oplinSviy.IU, vinqui=[ "isis", "ssssnpos", "onoliplnion", ], iionsps=[ "inin up-o- is is", "onu nnul is ssssns", "Ipln inifi onols", ], ), oplinquin( quini="isossnn", sn=oplinSn.ISO27001, oy="ss onol", il="ss nn", sipion="Ipln ophnsiv ss nn onols", sviy=oplinSviy.HIH, vinqui=[ "uspovisionin", "ssviws", "inionpous", ], iionsps=[ "Ipln uo us povisionin", "onu ul ss viws", "sblish l inion pous", ], ), ] un quins syn f ssssoplin( slf, sn: oplinSn, inluuoonly: bool = u ) -> oplinssssn: """ Pfo oplin ssssn fo  spifi sn s: sn: oplin sn o ssss inluuoonly: Only inlu quins wih uo hs uns: oplinssssn wih il suls """ ssssn = oplinssssn( ssssni=f"opssss{sn.vlu}{in(i.now().isp())}", sn=sn, si=i.now(), ) lo.info(f"Sin oplin ssssn fo {sn.vlu}") y: #  quins fo his sn quins = slf.quins.(sn, []) if inluuoonly: quins = [ fo  in quins if .uoh] ssssn.olquins = ln(quins) # Pfo hs in plll hss = [] fo quin in quins: s = slf.hquinsyn(quin) hss.ppn(s) # Wi fo ll hs o opl hsuls = wi synio.h(*hss) ssssn.ilsuls = hsuls # lul ssssn is ssssn.ni = i.now() ssssn.uionsons = ( ssssn.ni - ssssn.si ).olsons() slf.lulssssnis(ssssn) # n suy n onions ssssn.suy = slf.nssssnsuy(ssssn) ssssn.onions = slf.nonions(ssssn) xp xpion s : lo.o(f"oplin ssssn fil: {}") ssssn.suy["o"] = s() slf.ssssnhisoy.ppn(ssssn) lo.info( f"oplin ssssn opl in {ssssn.uionsons:.2f}s" ) un ssssn syn f hquinsyn( slf, quin: oplinquin ) -> oplinhsul: """h  sinl quin synhonously""" loop = synio.vnloop() sul = wi loop.uninxuo( slf.xuo, slf.hquinsyn, quin ) un sul f hquinsyn( slf, quin: oplinquin ) -> oplinhsul: """h  sinl quin synhonously""" sul = oplinhsul( hi=f"h{quin.quini}{in(i.now().isp())}", quin=quin, sus=oplinSus.UNVIW, ) y: # Pfo uo hs bs on quin if quin.quini == "hipnypion": sul = slf.hnypionoplin(quin) lif quin.quini == "hipssonol": sul = slf.hssonoloplin(quin) lif quin.quini == "hipuiloin": sul = slf.huiloinoplin(quin) lif quin.quini == "piniizion": sul = slf.hiniizionoplin(quin) lif quin.quini == "ponsnnn": sul = slf.honsnnnoplin(quin) lif quin.quini == "zuyvul": sul = slf.hyvuloplin(quin) lif quin.quini == "zuonioin": sul = slf.honioinoplin(quin) lif quin.quini == "zunwosuiy": sul = slf.hnwosuiyoplin(quin) ls: # ful:  s nul viw qui sul.sus = oplinSus.UNVIW sul.nos = "nul viw qui - no uo h ipln" xp xpion s : lo.wnin( f"oplin h fil fo {quin.quini}: {}" ) sul.sus = oplinSus.UNVIW sul.nos = f"h fil: {s()}" un sul f hnypionoplin( slf, quin: oplinquin ) -> oplinhsul: """h nypion oplin""" sul = oplinhsul( hi=f"h{quin.quini}", quin=quin ) vinfoun = [] # h fo nypion-l onfiuions zuonfi = slf.wospph / "zuonfi.py" if zuonfi.xiss(): wih opn(zuonfi, "", noin="uf-8", os="ino") s f: onn = f.() # Loo fo nypion sins if .sh( "nyp.*u|nypion.*nbl", onn, .INOS ): vinfoun.ppn( "nypion onfiuion foun in zuonfi.py" ) if "yvul" in onn.low(): vinfoun.ppn("y Vul inion ") # h zu ployn fils zuyl = slf.wospph / "zu.yl" if zuyl.xiss(): wih opn(zuyl, "", noin="uf-8", os="ino") s f: onn = f.() if "nyp" in onn.low() o "ssl" in onn.low(): vinfoun.ppn("nypion sins foun in zu.yl") # in oplin sus if ln(vinfoun) >= 2: sul.sus = oplinSus.OPLIN sul.vinfoun = vinfoun lif ln(vinfoun) == 1: sul.sus = oplinSus.OPNSINONOL sul.vinfoun = vinfoun sul.violions = ["Lii nypion vin foun"] sul.iionions = ["Ipln ophnsiv nypion sy"] ls: sul.sus = oplinSus.NONOPLIN sul.violions = ["No nypion iplnion "] sul.iionions = quin.iionsps un sul f hssonoloplin( slf, quin: oplinquin ) -> oplinhsul: """h ss onol oplin""" sul = oplinhsul( hi=f"h{quin.quini}", quin=quin ) vinfoun = [] # h fo B onfiuions zuyl = slf.wospph / "zu.yl" if zuyl.xiss(): wih opn(zuyl, "", noin="uf-8", os="ino") s f: onn = f.() if "ol" in onn.low() o "b" in onn.low(): vinfoun.ppn("B onfiuion foun in zu.yl") # h fo uhniion in o pyhonfils = lis(slf.wospph.lob("*.py")) uhfoun = Fls fo filph in pyhonfils: y: wih opn(filph, "", noin="uf-8", os="ino") s f: onn = f.() if .sh("uh|loin|on|jw", onn, .INOS): uhfoun = u b xp xpion: oninu if uhfoun: vinfoun.ppn("uhniion hniss  in obs") # in oplin sus if ln(vinfoun) >= 2: sul.sus = oplinSus.OPLIN sul.vinfoun = vinfoun ls: sul.sus = oplinSus.NONOPLIN sul.violions = ["Insuffiin ss onol iplnion"] sul.iionions = quin.iionsps un sul f huiloinoplin( slf, quin: oplinquin ) -> oplinhsul: """h ui loin oplin""" sul = oplinhsul( hi=f"h{quin.quini}", quin=quin ) vinfoun = [] # h fo loin onfiuions pyhonfils = lis(slf.wospph.lob("*.py")) loinfoun = Fls fo filph in pyhonfils: y: wih opn(filph, "", noin="uf-8", os="ino") s f: onn = f.() if .sh("loin|lo\.", onn, .INOS): loinfoun = u vinfoun.ppn(f"Loin  in {filph.n}") b xp xpion: oninu # h zu onio onfiuion zuyl = slf.wospph / "zu.yl" if zuyl.xiss(): wih opn(zuyl, "", noin="uf-8", os="ino") s f: onn = f.() if "onio" in onn.low() o "lo" in onn.low(): vinfoun.ppn("zu onio onfiuion foun") # in oplin sus if loinfoun n ln(vinfoun) >= 2: sul.sus = oplinSus.OPLIN sul.vinfoun = vinfoun ls: sul.sus = oplinSus.NONOPLIN sul.violions = ["Insuffiin ui loin iplnion"] sul.iionions = quin.iionsps un sul f hiniizionoplin( slf, quin: oplinquin ) -> oplinhsul: """h P  iniizion oplin""" sul = oplinhsul( hi=f"h{quin.quini}", quin=quin ) # Fo L.I.F.. Plfo,  iniizion is piily nul sul.sus = oplinSus.UNVIW sul.nos = ( " iniizion quis nul viw of  ollion pis" ) sul.iionions = quin.iionsps un sul f honsnnnoplin( slf, quin: oplinquin ) -> oplinhsul: """h P onsn nn oplin""" sul = oplinhsul( hi=f"h{quin.quini}", quin=quin ) # h fo onsn-l o pyhonfils = lis(slf.wospph.lob("*.py")) onsnfoun = Fls fo filph in pyhonfils: y: wih opn(filph, "", noin="uf-8", os="ino") s f: onn = f.() if .sh("onsn|n|p", onn, .INOS): onsnfoun = u sul.vinfoun.ppn( f"onsn hnlin foun in {filph.n}" ) b xp xpion: oninu if onsnfoun: sul.sus = oplinSus.OPLIN ls: sul.sus = oplinSus.UNVIW sul.nos = "onsn nn quis nul vifiion" sul.iionions = quin.iionsps un sul f hyvuloplin( slf, quin: oplinquin ) -> oplinhsul: """h zu y Vul oplin""" sul = oplinhsul( hi=f"h{quin.quini}", quin=quin ) vinfoun = [] # h fo y Vul fns in o pyhonfils = lis(slf.wospph.lob("*.py")) vfoun = Fls fo filph in pyhonfils: y: wih opn(filph, "", noin="uf-8", os="ino") s f: onn = f.() if "yvul" in onn.low() o "yvul" in onn.low(): vfoun = u vinfoun.ppn( f"y Vul inion foun in {filph.n}" ) b xp xpion: oninu # h zu onfiuion zuyl = slf.wospph / "zu.yl" if zuyl.xiss(): wih opn(zuyl, "", noin="uf-8", os="ino") s f: onn = f.() if "yvul" in onn.low(): vinfoun.ppn("y Vul onfiu in zu.yl") if vfoun: sul.sus = oplinSus.OPLIN sul.vinfoun = vinfoun ls: sul.sus = oplinSus.NONOPLIN sul.violions = ["zu y Vul no ipln"] sul.iionions = quin.iionsps un sul f honioinoplin( slf, quin: oplinquin ) -> oplinhsul: """h zu onioin oplin""" sul = oplinhsul( hi=f"h{quin.quini}", quin=quin ) vinfoun = [] # h zu onfiuion fo onioin zuyl = slf.wospph / "zu.yl" if zuyl.xiss(): wih opn(zuyl, "", noin="uf-8", os="ino") s f: onn = f.() if "onio" in onn.low() o "insihs" in onn.low(): vinfoun.ppn("zu onio onfiu in zu.yl") # h fo onioin in o pyhonfils = lis(slf.wospph.lob("*.py")) oniofoun = Fls fo filph in pyhonfils: y: wih opn(filph, "", noin="uf-8", os="ino") s f: onn = f.() if .sh("onio|is|ly", onn, .INOS): oniofoun = u vinfoun.ppn( f"onioin o foun in {filph.n}" ) b xp xpion: oninu if oniofoun n vinfoun: sul.sus = oplinSus.OPLIN sul.vinfoun = vinfoun ls: sul.sus = oplinSus.NONOPLIN sul.violions = ["zu onioin no fully ipln"] sul.iionions = quin.iionsps un sul f hnwosuiyoplin( slf, quin: oplinquin ) -> oplinhsul: """h zu nwo suiy oplin""" sul = oplinhsul( hi=f"h{quin.quini}", quin=quin ) vinfoun = [] # h zu onfiuion fo nwo suiy zuyl = slf.wospph / "zu.yl" if zuyl.xiss(): wih opn(zuyl, "", noin="uf-8", os="ino") s f: onn = f.() if ( "ns" in onn.low() o "fiwll" in onn.low() o "piv" in onn.low() ): vinfoun.ppn( "Nwo suiy onols onfiu in zu.yl" ) if vinfoun: sul.sus = oplinSus.OPLIN sul.vinfoun = vinfoun ls: sul.sus = oplinSus.UNVIW sul.nos = ( "Nwo suiy quis nul vifiion of zu onfiuion" ) sul.iionions = quin.iionsps un sul f lulssssnis(slf, ssssn: oplinssssn) -> Non: """lul ssssn is""" suls = ssssn.ilsuls oplin = su(1 fo  in suls if .sus == oplinSus.OPLIN) nonoplin = su( 1 fo  in suls if .sus == oplinSus.NONOPLIN ) nopplibl = su( 1 fo  in suls if .sus == oplinSus.NOPPLIBL ) opnsin = su( 1 fo  in suls if .sus == oplinSus.OPNSINONOL ) ssssn.oplinquins = oplin + opnsin ssssn.nonoplinquins = nonoplin ssssn.noppliblquins = nopplibl # lul iil n hih violions fo sul in suls: if sul.sus in [oplinSus.NONOPLIN]: if sul.quin.sviy == oplinSviy.IIL: ssssn.iilviolions += 1 lif sul.quin.sviy == oplinSviy.HIH: ssssn.hihviolions += 1 # lul oplin so olhbl = oplin + nonoplin + opnsin if olhbl > 0: ssssn.oplinso = ( (oplin + opnsin) / olhbl * 100 ) ls: ssssn.oplinso = 0.0 # in ovll sus if ssssn.iilviolions > 0: ssssn.ovllsus = oplinSus.NONOPLIN lif ssssn.hihviolions > 0: ssssn.ovllsus = oplinSus.OPNSINONOL lif ssssn.oplinso >= 80: ssssn.ovllsus = oplinSus.OPLIN ls: ssssn.ovllsus = oplinSus.NONOPLIN f nssssnsuy( slf, ssssn: oplinssssn ) -> i[s, ny]: """n ssssn suy""" un { "sn": ssssn.sn.vlu, "oplinso": ssssn.oplinso, "ovllsus": ssssn.ovllsus.vlu, "olquins": ssssn.olquins, "oplinquins": ssssn.oplinquins, "nonoplinquins": ssssn.nonoplinquins, "iilviolions": ssssn.iilviolions, "hihviolions": ssssn.hihviolions, "ssssnuion": ssssn.uionsons, } f nonions(slf, ssssn: oplinssssn) -> Lis[s]: """n oplin onions""" onions = [] if ssssn.iilviolions > 0: onions.ppn("ss iil oplin violions iily") if ssssn.hihviolions > 0: onions.ppn( "viw n i hih-sviy oplin issus" ) if ssssn.oplinso < 80: onions.ppn( "Ipov ovll oplin posu o  uloy quins" ) #  spifi onions bs on violions fo sul in ssssn.ilsuls: if sul.sus == oplinSus.NONOPLIN: onions.xn( sul.iionions[:2] ) # Lii o 2 p violion # ov uplis n lii ol onions onions = lis(s(onions))[:10] if no onions: onions.ppn( "oplin posu is pbl - oninu onioin" ) un onions f ssssnhisoy( slf, sn: Opionl[oplinSn] = Non, lii: in = 10 ) -> Lis[oplinssssn]: """ ssssn hisoy""" ssssns = slf.ssssnhisoy if sn: ssssns = [ fo  in ssssns if .sn == sn] un ssssns[-lii:] f oplinns( slf, sn: oplinSn, ys: in = 30 ) -> i[s, ny]: """ oplin ns ov i""" uoff = i.now() - il(ys=ys) lvnssssns = [  fo  in slf.ssssnhisoy if .sn == sn n .si >= uoff ] ns = { "sn": sn.vlu, "pioys": ys, "olssssns": ln(lvnssssns), "oplinn": [], "violionn": [], } fo ssssn in so(lvnssssns, y=lb x: x.si): ns["oplinn"].ppn( { "": ssssn.si.().isofo(), "so": ssssn.oplinso, } ) ns["violionn"].ppn( { "": ssssn.si.().isofo(), "iil": ssssn.iilviolions, "hih": ssssn.hihviolions, } ) un ns f xpossssnpo( slf, ssssn: oplinssssn, filph: s ) -> bool: """xpo oplin ssssn po""" y: xpo = { "ssssni": ssssn.ssssni, "sn": ssssn.sn.vlu, "si": ssssn.si.isofo(), "ni": ( ssssn.ni.isofo() if ssssn.ni ls Non ), "uionsons": ssssn.uionsons, "suy": ssssn.suy, "onions": ssssn.onions, "ilsuls": [ { "quini": sul.quin.quini, "il": sul.quin.il, "sus": sul.sus.vlu, "sviy": sul.quin.sviy.vlu, "vinfoun": sul.vinfoun, "violions": sul.violions, "iionions": sul.iionions, "nos": sul.nos, } fo sul in ssssn.ilsuls ], } wih opn(filph, "w") s f: json.up(xpo, f, inn=2, ful=s) lo.info(f"oplin ssssn po xpo o {filph}") un u xp xpion s : lo.o(f"Fil o xpo ssssn po: {}") un Fls # Foy funion fo sy insniion f oplinh( wospph: Opionl[s] = Non, ) -> oplinh: """ Foy funion o  oplin h s: wospph: Ph o wosp ioy uns: onfiu oplinh insn """ un oplinh(wospph=wospph) # on-lin inf f in(): """in LI funion fo oplin hin""" ipo ps ps = ps.unPs(sipion="L.I.F.. Plfo oplin h") ps.un( "--wosp", "-w", ful=Non, hlp="Wosp ioy ph" ) ps.un( "--sn", "-s", hois=[s.vlu fo s in oplinSn], qui=u, hlp="oplin sn o ssss", ) ps.un( "--xpo", "-", hlp="xpo ssssn suls o spifi JSON fil" ) ps.un( "--vbos", "-v", ion="sou", hlp="nbl vbos loin" ) s = ps.pss() if s.vbos: loin.Lo().sLvl(loin.BU) #  oplin h h = oplinh(wospph=s.wosp) # p sin o nu snp = {s.vlu: s fo s in oplinSn} sn = snp.(s.sn) if no sn: pin(f"Invli sn: {s.sn}") un 1 pin("L.I.F.. Plfo - oplin h") pin("=" * 40) y: # Pfo ssssn pin(f"Pfoin oplin ssssn fo {s.sn.upp()}...") ssssn = synio.un(h.ssssoplin(sn)) pin("\nssssn suls:") pin(f" ssssn I: {ssssn.ssssni}") pin(f" Sn: {ssssn.sn.vlu.upp()}") pin(f" uion: {ssssn.uionsons:.2f}s") pin(f" oplin So: {ssssn.oplinso:.1f}/100") pin(f" Ovll Sus: {ssssn.ovllsus.vlu.upp()}") pin(f" quins h: {ssssn.olquins}") pin(f" oplin: {ssssn.oplinquins}") pin(f" Non-oplin: {ssssn.nonoplinquins}") pin(f" iil Violions: {ssssn.iilviolions}") pin(f" Hih Violions: {ssssn.hihviolions}") if ssssn.onions: pin("\nonions:") fo  in ssssn.onions[:5]: # Show fis 5 pin(f" • {}") if s.xpo: if h.xpossssnpo(ssssn, s.xpo): pin(f"\nssssn po xpo o {s.xpo}") ls: pin("\nFil o xpo ssssn po") un 1 # xi wih ppopi o bs on ssssn if ssssn.ovllsus == oplinSus.NONOPLIN: pin("\n NON-OPLIN: iil oplin issus foun!") un 1 lif ssssn.ovllsus == oplinSus.OPNSINONOL: pin("\n ️ OPNSIN ONOLS: viw hih-pioiy issus") un 0 ls: pin("\n OPLIN: oplin quins ") un 0 xp yboInup: pin("\nssssn inup by us") un 1 xp xpion s : pin(f"\noplin ssssn fil: {}") un 1 if n == "in": ipo sys sys.xi(in())