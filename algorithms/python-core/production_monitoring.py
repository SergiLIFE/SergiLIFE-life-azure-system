# us/bin/nv pyhon3 """ L.I.F.. Plfo - Pouion onioin Sui l-i onioin n lin fo pouion ployns his oul povis ophnsiv onioin pbiliis fo pouion ployns, inluin hlh hs, pfon onioin, n uo lin. opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b """ ipo synio ipo json ipo loin ipo os ipo sys ipo hin ipo i fo onun.fuus ipo hPoolxuo fo lsss ipo lss, fil fo i ipo i, il fo nu ipo nu y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo ny, llbl, i, Lis, Opionl # onfiu loin loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(n)s - %(lvln)s - %(ss)s" ) lo = loin.Lo(n) lss onioinoponn(nu): """oponns h n b onio""" ZUFUNIONS = "zufunions" ZUSO = "zuso" ZUBS = "zubs" ZUYVUL = "zuyvul" ZUSVIBUS = "zusvibus" ZUONIO = "zuonio" POSSO = "posso" LIFLOIH = "lifloih" PINPOINS = "pinpoins" SYSSOUS = "syssous" NWOONNIVIY = "nwoonniviy" lss lSviy(nu): """l sviy lvls""" IIL = "iil" HIH = "hih" IU = "iu" LOW = "low" INFO = "info" lss lSus(nu): """l sus""" IV = "iv" SOLV = "solv" NOWL = "nowl" SUPPSS = "suppss" lss iyp(nu): """yps of is""" OUN = "oun" U = "u" HISO = "hiso" SUY = "suy" @lss lss iVlu: """Iniviul i sun""" n: s vlu: flo isp: i = fil(fulfoy=i.now) lbls: i[s, s] = fil(fulfoy=i) iyp: iyp = iyp.U @lss lss lul: """l ul finiion""" uli: s n: s sipion: s oponn: onioinoponn sviy: lSviy oniion: s # xpssion o vlu hshol: flo winowsons: in = 300 # 5 inus ful oolownsons: in = 3600 # 1 hou ful nbl: bool = u lsi: Opionl[i] = Non ioun: in = 0 @lss lss l: """l insn""" li: s uli: s oponn: onioinoponn sviy: lSviy il: s sipion: s isp: i = fil(fulfoy=i.now) sus: lSus = lSus.IV vlu: flo = 0.0 hshol: flo = 0.0 lbls: i[s, s] = fil(fulfoy=i) solv: Opionl[i] = Non nowl: Opionl[i] = Non nowlby: Opionl[s] = Non @lss lss Hlhh: """Hlh h finiion""" hi: s n: s oponn: onioinoponn hfunion: llbl[[], i[s, ny]] invlsons: in = 60 iousons: in = 30 nbl: bool = u lsun: Opionl[i] = Non lssul: Opionl[i[s, ny]] = Non onsuivfilus: in = 0 xonsuivfilus: in = 3 @lss lss onioinpo: """ophnsiv onioin po""" poi: s isp: i = fil(fulfoy=i.now) uionsons: flo = 0.0 oponnsh: in = 0 oponnshlhy: in = 0 oponns: in = 0 oponnsunhlhy: in = 0 ivls: in = 0 iills: in = 0 olis: in = 0 syshlhso: flo = 100.0 oponnhlh: i[s, i[s, ny]] = fil(fulfoy=i) lssuy: i[s, in] = fil(fulfoy=i) onions: Lis[s] = fil(fulfoy=lis) lss PouiononioinSui: """ Pouion onioin Sui fo L.I.F.. Plfo Povis ophnsiv onioin, lin, n hlh hin fo pouion ployns wih l-i is ollion. """ f ini(slf, wospph: Opionl[s] = Non): slf.wospph = Ph(wospph o os.w()) slf.luls: Lis[lul] = [] slf.ivls: Lis[l] = [] slf.hlhhs: Lis[Hlhh] = [] slf.isbuff: Lis[iVlu] = [] slf.onioinpos: Lis[onioinpo] = [] # hin n syn nn slf.xuo = hPoolxuo(xwos=4) slf.onioiniv = Fls slf.onioinh: Opionl[hin.h] = Non slf.llo = hin.Lo() slf.islo = hin.Lo() # Iniiliz onioin oponns slf.iniilizluls() slf.iniilizhlhhs() lo.info( f"Pouion onioin Sui iniiliz fo wosp: {slf.wospph}" ) f iniilizluls(slf): """Iniiliz ful l uls""" uls = [ lul( uli="puhih", n="Hih PU Us", sipion="PU us xs hshol", oponn=onioinoponn.SYSSOUS, sviy=lSviy.HIH, oniion="pupn > hshol", hshol=85.0, winowsons=300, ), lul( uli="oyhih", n="Hih oy Us", sipion="oy us xs hshol", oponn=onioinoponn.SYSSOUS, sviy=lSviy.HIH, oniion="oypn > hshol", hshol=90.0, winowsons=300, ), lul( uli="issplow", n="Low is Sp", sipion="vilbl is sp blow hshol", oponn=onioinoponn.SYSSOUS, sviy=lSviy.IIL, oniion="isfpn < hshol", hshol=10.0, winowsons=3600, ), lul( uli="zufunionsos", n="zu Funions os", sipion="Hih o  in zu Funions", oponn=onioinoponn.ZUFUNIONS, sviy=lSviy.IIL, oniion="o > hshol", hshol=5.0, winowsons=300, ), lul( uli="possinlny", n=" Possin Lny", sipion=" possin lny xs hshol", oponn=onioinoponn.POSSO, sviy=lSviy.HIH, oniion="vlnys > hshol", hshol=100.0, winowsons=300, ), lul( uli="pisponsi", n="PI spons i", sipion="PI spons i xs hshol", oponn=onioinoponn.PINPOINS, sviy=lSviy.IU, oniion="vsponsis > hshol", hshol=2000.0, winowsons=300, ), lul( uli="soopionsfil", n="So Opions Fil", sipion="So opion filu  xs hshol", oponn=onioinoponn.ZUSO, sviy=lSviy.HIH, oniion="filu > hshol", hshol=1.0, winowsons=600, ), ] slf.luls = uls f iniilizhlhhs(slf): """Iniiliz ful hlh hs""" hs = [ Hlhh( hi="syssous", n="Sys sous", oponn=onioinoponn.SYSSOUS, hfunion=slf.hsyssous, invlsons=60, ), Hlhh( hi="zufunions", n="zu Funions", oponn=onioinoponn.ZUFUNIONS, hfunion=slf.hzufunions, invlsons=120, ), Hlhh( hi="zuso", n="zu So", oponn=onioinoponn.ZUSO, hfunion=slf.hzuso, invlsons=300, ), Hlhh( hi="posso", n=" Posso", oponn=onioinoponn.POSSO, hfunion=slf.hposso, invlsons=60, ), Hlhh( hi="lifloih", n="L.I.F.. loih", oponn=onioinoponn.LIFLOIH, hfunion=slf.hlifloih, invlsons=120, ), Hlhh( hi="pinpoins", n="PI npoins", oponn=onioinoponn.PINPOINS, hfunion=slf.hpinpoins, invlsons=60, ), Hlhh( hi="nwoonniviy", n="Nwo onniviy", oponn=onioinoponn.NWOONNIVIY, hfunion=slf.hnwoonniviy, invlsons=300, ), ] slf.hlhhs = hs syn f sonioin(slf, oninuous: bool = u) -> Non: """S h onioin sui""" if slf.onioiniv: lo.wnin("onioin is ly iv") un slf.onioiniv = u lo.info("Sin pouion onioin sui") if oninuous: # S oninuous onioin in boun h slf.onioinh = hin.h( =slf.oninuousonioinloop, on=u ) slf.onioinh.s() ls: # un sinl onioin yl wi slf.unonioinyl() f soponioin(slf) -> Non: """Sop h onioin sui""" if no slf.onioiniv: lo.wnin("onioin is no iv") un slf.onioiniv = Fls lo.info("Soppin pouion onioin sui") if slf.onioinh n slf.onioinh.isliv(): slf.onioinh.join(iou=5.0) f oninuousonioinloop(slf) -> Non: """oninuous onioin loop""" loop = synio.nwvnloop() synio.svnloop(loop) y: whil slf.onioiniv: # un onioin yl loop.ununilopl(slf.unonioinyl()) # Wi bfo nx yl i.slp(30) # 30 son invls xp xpion s : lo.o(f"onioin loop o: {}") finlly: loop.los() syn f unonioinyl(slf) -> Non: """un  opl onioin yl""" yls = i.i() y: # un hlh hs wi slf.unhlhhs() # oll is wi slf.ollis() # vlu l uls wi slf.vlululs() # n onioin po po = wi slf.nonioinpo() slf.onioinpos.ppn(po) yluion = i.i() - yls lo.info(f"onioin yl opl in {yluion:.2f}s") xp xpion s : lo.o(f"onioin yl fil: {}") syn f unhlhhs(slf) -> Non: """un ll nbl hlh hs""" ss = [] fo h in slf.hlhhs: if h.nbl: ss.ppn(slf.unsinlhlhh(h)) if ss: wi synio.h(*ss, unxpions=u) syn f unsinlhlhh(slf, h: Hlhh) -> Non: """un  sinl hlh h""" y: # un h wih iou sul = wi synio.wifo( synio.vnloop().uninxuo( slf.xuo, h.hfunion ), iou=h.iousons, ) h.lsun = i.now() h.lssul = sul if sul.("hlhy", Fls): h.onsuivfilus = 0 ls: h.onsuivfilus += 1 xp synio.iouo: lo.wnin(f"Hlh h {h.hi} i ou") h.onsuivfilus += 1 h.lssul = {"hlhy": Fls, "o": "iou"} xp xpion s : lo.o(f"Hlh h {h.hi} fil: {}") h.onsuivfilus += 1 h.lssul = {"hlhy": Fls, "o": s()} syn f ollis(slf) -> Non: """oll sys n ppliion is""" y: # oll sys is wi slf.ollsysis() # oll ppliion is wi slf.ollppliionis() # oll zu is wi slf.ollzuis() xp xpion s : lo.o(f"is ollion fil: {}") syn f ollsysis(slf) -> Non: """oll sys sou is""" y: ipo psuil # PU is pupn = psuil.pupn(invl=1) slf.i("syspupn", pupn, {"yp": "us"}) # oy is oy = psuil.viuloy() slf.i("sysoypn", oy.pn, {"yp": "us"}) slf.i( "sysoyusb", oy.us / (1024**3), {"yp": "bsolu"} ) # is is is = psuil.isus("/") slf.i("sysispn", is.pn, {"yp": "us"}) slf.i( "sysisfb", is.f / (1024**3), {"yp": "bsolu"} ) # Nwo is nwo = psuil.nioouns() slf.i( "sysnwobyssn", nwo.byssn, {"yp": "oun"} ) slf.i( "sysnwobysv", nwo.bysv, {"yp": "oun"} ) xp Ipoo: lo.wnin("psuil no vilbl fo sys is") xp xpion s : lo.o(f"Sys is ollion fil: {}") syn f ollppliionis(slf) -> Non: """oll ppliion-spifi is""" y: #  possin is wi slf.ollis() # PI is wi slf.ollpiis() # loih pfon is wi slf.ollloihis() xp xpion s : lo.o(f"ppliion is ollion fil: {}") syn f ollis(slf) -> Non: """oll  possin is""" y: # h if  posso is unnin unnin = slf.hpossunnin("posso.py") slf.i( "possounnin", 1.0 if unnin ls 0.0, {"yp": "sus"} ) # o lny is (woul b oll fo ul posso) slf.i("possinlnys", 45.2, {"yp": "pfon"}) slf.i( "possinhouhpu", 120.5, {"yp": "houhpu", "uni": "spls/s"}, ) xp xpion s : lo.o(f" is ollion fil: {}") syn f ollpiis(slf) -> Non: """oll PI pfon is""" y: # o PI is (woul b oll fo ul PI) slf.i( "piqussol", 1250, {"yp": "oun", "ho": "ll"} ) slf.i("pisponsis", 150.3, {"yp": "pfon"}) slf.i("pio", 0.02, {"yp": ""}) xp xpion s : lo.o(f"PI is ollion fil: {}") syn f ollloihis(slf) -> Non: """oll loih pfon is""" y: # h if loih is unnin lounnin = slf.hpossunnin("xpinP2L") slf.i( "lifloihunnin", 1.0 if lounnin ls 0.0, {"yp": "sus"}, ) # o loih is slf.i("lifloihuy", 0.823, {"yp": "pfon"}) slf.i( "lifloihpossinis", 38.7, {"yp": "pfon"} ) xp xpion s : lo.o(f"loih is ollion fil: {}") syn f ollzuis(slf) -> Non: """oll zu svi is""" y: # o zu is (woul us zu onio PI) slf.i("zufunionsinvoions", 450, {"yp": "oun"}) slf.i("zusoopions", 1250, {"yp": "oun"}) slf.i("zufunionsos", 5, {"yp": "oun"}) xp xpion s : lo.o(f"zu is ollion fil: {}") f i( slf, n: s, vlu: flo, lbls: i[s, s] = Non ) -> Non: """  i o h buff""" wih slf.islo: i = iVlu(n=n, vlu=vlu, lbls=lbls o {}) slf.isbuff.ppn(i) # p buff siz nbl (ls 1000 is) if ln(slf.isbuff) > 1000: slf.isbuff = slf.isbuff[-1000:] syn f vlululs(slf) -> Non: """vlu ll l uls ins un is""" fo ul in slf.luls: if no ul.nbl: oninu y: wi slf.vlusinllul(ul) xp xpion s : lo.o(f"l ul vluion fil fo {ul.uli}: {}") syn f vlusinllul(slf, ul: lul) -> Non: """vlu  sinl l ul""" #  lvn is fo h i winow winows = i.now() - il(sons=ul.winowsons) lvnis = [  fo  in slf.isbuff if .n in ul.oniion n .isp >= winows ] if no lvnis: un # lul i vlu bs on ul oniion if "pupn" in ul.oniion: vlus = [ .vlu fo  in lvnis if .n == "syspupn" ] lif "oypn" in ul.oniion: vlus = [ .vlu fo  in lvnis if .n == "sysoypn" ] lif "isfpn" in ul.oniion: vlus = [ .vlu fo  in lvnis if .n == "sysispn" ] vlus = [100 - v fo v in vlus] # onv o f pn lif "o" in ul.oniion: # lul o  fo zu is olops = su( .vlu fo  in lvnis if "zufunionsinvoions" in .n ) os = su( .vlu fo  in lvnis if "zufunionsos" in .n ) vlus = [os / olops * 100 if olops > 0 ls 0] ls: # ful o v of lvn is vlus = [.vlu fo  in lvnis] if no vlus: un unvlu = su(vlus) / ln(vlus) # h if l shoul b i shouli = Fls if ">" in ul.oniion n unvlu > ul.hshol: shouli = u lif "<" in ul.oniion n unvlu < ul.hshol: shouli = u if shouli: # h oolown pio if ul.lsi: isinls = (i.now() - ul.lsi).olsons() if isinls < ul.oolownsons: un #  l l = l( li=f"l{ul.uli}{in(i.now().isp())}", uli=ul.uli, oponn=ul.oponn, sviy=ul.sviy, il=ul.n, sipion=ul.sipion, vlu=unvlu, hshol=ul.hshol, lbls={"ul": ul.uli}, ) wih slf.llo: slf.ivls.ppn(l) ul.lsi = i.now() ul.ioun += 1 lo.wnin( f"l i: {l.il} (vlu: {unvlu:.2f}, hshol: {ul.hshol})" ) f hsyssous(slf) -> i[s, ny]: """h sys sous hlh""" y: ipo psuil pupn = psuil.pupn(invl=1) oy = psuil.viuloy() is = psuil.isus("/") hlhy = pupn < 90 n oy.pn < 95 n is.pn < 95 un { "hlhy": hlhy, "pupn": pupn, "oypn": oy.pn, "ispn": is.pn, "ils": { "puus": f"{pupn:.1f}%", "oyus": f"{oy.pn:.1f}%", "isus": f"{is.pn:.1f}%", }, } xp xpion s : un {"hlhy": Fls, "o": s()} f hzufunions(slf) -> i[s, ny]: """h zu Funions hlh""" y: # h if zu Funions onfiuion xiss onfifils = ["zufunionsonfi.py", "zuonfi.py"] onfixiss = ny( (slf.wospph / f).xiss() fo f in onfifils ) if no onfixiss: un { "hlhy": Fls, "o": "zu Funions onfiuion no foun", } # o hlh h (woul h ul zu sus) un { "hlhy": u, "sus": "opionl", "ils": { "funionsoun": 5, "lsployn": "2025-01-1510:30:00Z", }, } xp xpion s : un {"hlhy": Fls, "o": s()} f hzuso(slf) -> i[s, ny]: """h zu So hlh""" y: # h so onfiuion zuonfi = slf.wospph / "zuonfi.py" if no zuonfi.xiss(): un {"hlhy": Fls, "o": "zu onfiuion no foun"} # o hlh h un { "hlhy": u, "sus": "onn", "ils": {"oninsoun": 3, "olsizb": 25.7}, } xp xpion s : un {"hlhy": Fls, "o": s()} f hposso(slf) -> i[s, ny]: """h  posso hlh""" y: # h if  posso fils xis fils = ["posso.py", "nhnposso.py"] filsxis = ny((slf.wospph / f).xiss() fo f in fils) if no filsxis: un {"hlhy": Fls, "o": " posso fils no foun"} # h if poss is unnin unnin = slf.hpossunnin("posso") if no unnin: unnin = slf.hpossunnin("nhnposso") un { "hlhy": unnin, "sus": "unnin" if unnin ls "sopp", "ils": { "possunnin": unnin, "lsh": i.now().isofo(), }, } xp xpion s : un {"hlhy": Fls, "o": s()} f hlifloih(slf) -> i[s, ny]: """h L.I.F.. loih hlh""" y: # h if loih fil xiss lofil = ( slf.wospph / "xpinP2L.I.F.-Lnin-Iniviully-fo-xpin-hoy-loih-o-2025-opyih-S.py" ) if no lofil.xiss(): un {"hlhy": Fls, "o": "L.I.F.. loih fil no foun"} # h if poss is unnin unnin = slf.hpossunnin("xpinP2L") un { "hlhy": unnin, "sus": "unnin" if unnin ls "sopp", "ils": {"possunnin": unnin, "filxiss": u}, } xp xpion s : un {"hlhy": Fls, "o": s()} f hpinpoins(slf) -> i[s, ny]: """h PI npoins hlh""" y: # h if PI fil xiss pifil = slf.wospph / "lifplfopi.py" if no pifil.xiss(): un {"hlhy": Fls, "o": "PI fil no foun"} # o PI hlh h un { "hlhy": u, "sus": "opionl", "ils": {"npoinsoun": 8, "sponsis": 145}, } xp xpion s : un {"hlhy": Fls, "o": s()} f hnwoonniviy(slf) -> i[s, ny]: """h nwo onniviy""" y: ipo so # s bsi onniviy so.onnion(("8.8.8.8", 53), iou=5) un { "hlhy": u, "sus": "onn", "ils": {"lnys": 25, "ploss": 0.0}, } xp xpion s : un {"hlhy": Fls, "o": s()} f hpossunnin(slf, possn: s) -> bool: """h if  poss is unnin""" y: ipo psuil fo po in psuil.possi(["pi", "n", "lin"]): y: if ( possn.low() in " ".join(po.info["lin"] o []).low() ): un u xp (psuil.NoSuhPoss, psuil.ssni): oninu un Fls xp Ipoo: # Fllb wihou psuil y: ipo subposs sul = subposs.un( ["pp", "-f", possn], puoupu=u, x=u ) un sul.uno == 0 xp xpion: un Fls xp xpion: un Fls syn f nonioinpo(slf) -> onioinpo: """n ophnsiv onioin po""" po = onioinpo( poi=f"oniopo{in(i.now().isp())}", isp=i.now(), ) # nlyz hlh hs hlhyoun = 0 oun = 0 unhlhyoun = 0 fo h in slf.hlhhs: if no h.lssul: oninu po.oponnsh += 1 if h.lssul.("hlhy", Fls): hlhyoun += 1 lif h.onsuivfilus > 0: if h.onsuivfilus >= h.xonsuivfilus: unhlhyoun += 1 ls: oun += 1 po.oponnshlhy = hlhyoun po.oponns = oun po.oponnsunhlhy = unhlhyoun # nlyz ls wih slf.llo: po.ivls = ln(slf.ivls) po.iills = ln( [ fo  in slf.ivls if .sviy == lSviy.IIL] ) # lul sys hlh so oloponns = po.oponnsh if oloponns > 0: hlhso = ( po.oponnshlhy * 100 + po.oponns * 50 ) / oloponns # Pnliz fo iv ls lpnly = in(po.ivls * 5, 50) po.syshlhso = x(0, hlhso - lpnly) # Buil oponn hlh ils fo h in slf.hlhhs: if h.lssul: po.oponnhlh[h.oponn.vlu] = { "hlhy": h.lssul.("hlhy", Fls), "sus": h.lssul.("sus", "unnown"), "lsh": ( h.lsun.isofo() if h.lsun ls Non ), "onsuivfilus": h.onsuivfilus, "ils": h.lssul.("ils", {}), } # Buil ls suy sviyouns = {} fo l in slf.ivls: sviyouns[l.sviy.vlu] = ( sviyouns.(l.sviy.vlu, 0) + 1 ) po.lssuy = sviyouns # n onions po.onions = slf.nonioinonions(po) un po f nonioinonions( slf, po: onioinpo ) -> Lis[s]: """n onioin onions""" onions = [] if po.oponnsunhlhy > 0: onions.ppn( f"ss {po.oponnsunhlhy} unhlhy oponns iily" ) if po.iills > 0: onions.ppn(f"solv {po.iills} iil ls") if po.syshlhso < 70: onions.ppn( "Ovll sys hlh is  - invsi oponn issus" ) if po.oponns > 0: onions.ppn( f"onio {po.oponns}  oponns losly" ) if no onions: onions.ppn("ll syss opin nolly") un onions f ivls( slf, oponn: Opionl[onioinoponn] = Non ) -> Lis[l]: """ iv ls, opionlly fil by oponn""" wih slf.llo: if oponn: un [ fo  in slf.ivls if .oponn == oponn] un slf.ivls.opy() f nowll(slf, li: s, nowlby: s) -> bool: """nowl n l""" wih slf.llo: fo l in slf.ivls: if l.li == li: l.sus = lSus.NOWL l.nowl = i.now() l.nowlby = nowlby lo.info(f"l {li} nowl by {nowlby}") un u un Fls f solvl(slf, li: s) -> bool: """solv n l""" wih slf.llo: fo l in slf.ivls: if l.li == li: l.sus = lSus.SOLV l.solv = i.now() slf.ivls.ov(l) lo.info(f"l {li} solv") un u un Fls f nis( slf, n: Opionl[s] = Non, lii: in = 100 ) -> Lis[iVlu]: """ n is, opionlly fil by n""" wih slf.islo: is = slf.isbuff[-lii:] if n: is = [ fo  in is if .n == n] un is.opy() f xpoonioinpo( slf, filph: s, po: Opionl[onioinpo] = Non ) -> bool: """xpo onioin po o fil""" if po is Non: po = slf.onioinpos[-1] if slf.onioinpos ls Non if no po: lo.wnin("No onioin po vilbl o xpo") un Fls y: xpo = { "poi": po.poi, "isp": po.isp.isofo(), "uionsons": po.uionsons, "syshlhso": po.syshlhso, "oponns": { "ol": po.oponnsh, "hlhy": po.oponnshlhy, "": po.oponns, "unhlhy": po.oponnsunhlhy, }, "ls": { "iv": po.ivls, "iil": po.iills, "suy": po.lssuy, }, "oponnhlh": po.oponnhlh, "onions": po.onions, } wih opn(filph, "w") s f: json.up(xpo, f, inn=2, ful=s) lo.info(f"onioin po xpo o {filph}") un u xp xpion s : lo.o(f"Fil o xpo onioin po: {}") un Fls # Foy funion fo sy insniion f pouiononioinsui( wospph: Opionl[s] = Non, ) -> PouiononioinSui: """ Foy funion o  pouion onioin sui s: wospph: Ph o wosp ioy uns: onfiu PouiononioinSui insn """ un PouiononioinSui(wospph=wospph) # on-lin inf f in(): """in LI funion fo pouion onioin""" ipo ps ps = ps.unPs( sipion="L.I.F.. Plfo Pouion onioin Sui" ) ps.un( "--wosp", "-w", ful=Non, hlp="Wosp ioy ph" ) ps.un( "--oninuous", "-", ion="sou", hlp="un oninuous onioin" ) ps.un( "--xpo", "-", hlp="xpo onioin po o spifi fil" ) ps.un( "--ls", "-", ion="sou", hlp="Show iv ls" ) ps.un( "--is", "-", hlp="Show n is fo spifi n" ) ps.un( "--hlh", ion="sou", hlp="Show oponn hlh sus" ) ps.un( "--vbos", "-v", ion="sou", hlp="nbl vbos loin" ) s = ps.pss() if s.vbos: loin.Lo().sLvl(loin.BU) #  onioin sui sui = pouiononioinsui(wospph=s.wosp) pin("L.I.F.. Plfo - Pouion onioin Sui") pin("=" * 55) y: if s.ls: # Show iv ls ls = sui.ivls() pin(f"\niv ls: {ln(ls)}") fo l in ls[:10]: # Show fis 10 pin(f" {l.sviy.vlu.upp()}: {l.il}") pin(f" {l.sipion}") pin(f" Vlu: {l.vlu:.2f}, hshol: {l.hshol}") pin(f" i: {l.isp}") pin() lif s.is: # Show n is is = sui.nis(n=s.is, lii=20) pin(f"\nn is fo '{s.is}': {ln(is)}") fo i in is: pin(f" {i.isp}: {i.vlu:.2f} {i.lbls}") lif s.hlh: # Show oponn hlh pin("\noponn Hlh Sus:") fo h in sui.hlhhs: if h.lssul: sus = " " if h.lssul.("hlhy") ls " " pin( f" {sus} {h.n}: {h.lssul.('sus', 'unnown')}" ) ls: # un onioin pin("unnin onioin yl...") # un sinl yl synio.un(sui.unonioinyl()) #  ls po if sui.onioinpos: po = sui.onioinpos[-1] pin("\nonioin suls:") pin(f" Sys Hlh So: {po.syshlhso:.1f}%") pin(f" oponns h: {po.oponnsh}") pin(f" Hlhy: {po.oponnshlhy}") pin(f" : {po.oponns}") pin(f" Unhlhy: {po.oponnsunhlhy}") pin(f" iv ls: {po.ivls}") pin(f" iil ls: {po.iills}") if po.onions: pin("\nonions:") fo  in po.onions: pin(f" â€¢ {}") if s.xpo: if sui.xpoonioinpo(s.xpo): pin(f"\nonioin po xpo o {s.xpo}") ls: pin("\nFil o xpo onioin po") un 1 un 0 xp yboInup: pin("\nOpion inup by us") sui.soponioin() un 1 xp xpion s : pin(f"\nonioin fil: {}") sui.soponioin() un 1 finlly: if no s.oninuous: sui.soponioin() if n == "in": ipo sys sys.xi(in())