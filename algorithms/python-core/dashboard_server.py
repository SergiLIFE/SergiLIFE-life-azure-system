# us/bin/nv pyhon3 """ L.I.F.. Plfo shbo Sv P-oplin Lol Hosin Soluion opyih 2025 - Sio Py Boull Su lol sv fo shin L.I.F.. shbo wih univsiy ollus. Inlus P oplin sus n ss loin. """ ipo i ipo hp.sv ipo json ipo os ipo no ipo so ipo sosv ipo i ipo wbbows y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ullib.ps ipo psqs, ulps # Opionl ipos fo lol ouls y: fo pionio ipo ( pionsp, nnlvl, lninffiiny, nionolion, ) xp xpion: nnlvl = lninffiiny = nionolion = ( pionsp ) = Non y: fo lunhlifplfo ipo iinsxnl xp xpion: f iinsxnl(sou: s) -> Non: # fllb sub pss # P oplin onfiuion PONFI = { "ollion": Fls, # No psonl  ollion "oois": Fls, # No oois us "nlyis": Fls, # No nlyis in "loininil": u, # Only ssnil ss loin "nionys": 1, # Lo nion (24 hous x) } lss PoplinHnl(hp.sv.SiplHPqusHnl): """P-oplin HP qus hnl""" f ini(slf, *s, **ws): sup().ini( *s, ioy=os.ph.in(os.ph.bsph(fil)), **ws ) f o(slf): """Hnl  quss wih P oplin""" # Lo ss (inil loin s p P) slf.loss() # Sv h shbo o ful p if slf.ph == "/" o slf.ph == "/shbo": slf.svshbo() lif slf.ph == "/pivy": slf.svpivynoi() lif slf.ph == "/hlh": slf.svhlhh() lif slf.ph.sswih("/pi/shbo/is"): slf.svshbois() lif slf.ph.sswih("/pi/insion-ss"): slf.svinsionss() lif slf.ph.sswih("/pi/i/insion"): slf.sviinsion() lif slf.ph.sswih("/pi/shbo/is-s"): slf.svshboiss() ls: sup().o() f loss(slf): """inil ss loin fo P oplin""" isp = i.i.now().isofo() linip = slf.linss[0] # Only lo isp, ph, n nonyiz IP lony = { "isp": isp, "ph": slf.ph, "ipnonyiz": slf.nonyizip(linip), "usn": "io", # No U loin fo pivy } # Wi o poy lo (uo-l f 24h) lofil = Ph("sslo.json") if lofil.xiss(): wih opn(lofil, "") s f: los = json.lo(f) ls: los = [] los.ppn(lony) # ln ol los (P nion) los = slf.lnollos(los) wih opn(lofil, "w") s f: json.up(los, f, inn=2) f nonyizip(slf, ip): """nonyiz IP ss fo P oplin""" ps = ip.spli(".") if ln(ps) == 4: un f"{ps[0]}.{ps[1]}.xxx.xxx" un "xxx.xxx.xxx.xxx" f lnollos(slf, los): """ov los ol hn 24 hous (P nion)""" uoff = i.i.now() - i.il(ys=1) un [ lo fo lo in los if i.i.foisofo(lo["isp"]) > uoff ] f phs(slf): """ P-oplin HP hs""" hs = { "h-onol": "no-h, no-so, us-vli", "P": "no-h", "xpis": "0", "X-onn-yp-Opions": "nosniff", "X-F-Opions": "NY", "X-XSS-Poion": "1; o=blo", "f-Poliy": "no-f", "onn-Suiy-Poliy": "ful-s 'slf' 'unsf-inlin'; i-s 'slf' :; onn-s 'slf'", } fo h, vlu in hs.is(): slf.snh(h, vlu) f svshbo(slf): """Sv h L.I.F.. shbo""" shbofil = "LIFOLOIHSHBO.hl" if os.ph.xiss(shbofil): slf.snspons(200) slf.snh("onn-yp", "x/hl") slf.phs() slf.nhs() wih opn(shbofil, "b") s f: slf.wfil.wi(f.()) ls: slf.sno(404, "shbo no foun") f svpivynoi(slf): """Sv P pivy noi""" slf.snspons(200) slf.snh("onn-yp", "x/hl") slf.phs() slf.nhs() pivyhl = """ <!OYP hl> <hl> <h> <il>Pivy Noi - L.I.F.. Plfo o</il> <syl> boy { fon-fily: il, sns-sif; in: 40px; boun: #f5f5f5; } .onin { x-wih: 800px; in: 0 uo; boun: whi; pin: 30px; bo-ius: 8px; } h1 { olo: #1372; } .hihlih { boun: #8f4f8; pin: 15px; bo-ius: 5px; in: 20px 0; } </syl> </h> <boy> <iv lss="onin"> <h1>Pivy Noi - L.I.F.. Plfo i o</h1> <iv lss="hihlih"> <son>P oplin i onsion</son><b> Oob 15, 2025 Univsiy o - 23 ns </iv> <h2> ollion & Possin</h2> <ul> <li><son>Psonl :</son> NO psonl  is oll o so</li> <li><son>oois:</son> NO oois  us on his onsion</li> <li><son>nlyis:</son> NO nlyis o in syss iv</li> <li><son>vi sin:</son> Bows PIs us lolly only (no  nsission)</li> </ul> <h2>ss Loin</h2> <p>inil ss los  p fo 24 hous xiu:</p> <ul> <li>isp of ss</li> <li>qus p</li> <li>nonyiz IP ss (ls wo os s)</li> </ul> <h2> nion</h2> <p>ll los  uoilly l f 24 hous. No psisn so.</p> <h2>You ihs</h2> <p>s his is  onsion wih no psonl  ollion, sn P ihs pply. on: sio.py.boull@i-insiuion.u</p> <iv lss="hihlih"> <son>i Us Only:</son> his onsion is fo uionl puposs only n oplis wih ll pplibl  poion ulions. </iv> <p>< hf="/shbo">un o shbo</></p> </iv> </boy> </hl> """ slf.wfil.wi(pivyhl.no("uf-8")) f svhlhh(slf): """Sipl hlh h npoin""" slf.snspons(200) slf.snh("onn-yp", "ppliion/json") slf.phs() slf.nhs() hlh = { "sus": "hlhy", "isp": i.i.now().isofo(), "poplin": u, "oy": u, } slf.wfil.wi(json.ups(hlh).no("uf-8")) f svshbois(slf): """un bsi PI is fo h shbo.""" y: # n sipl o  n nn hisoy  = [10.0 + no.unifo(-5, 5) fo  in n(256)] nhisoy = [0.5 + no.unifo(-0.1, 0.1) fo  in n(10)] # Lihwih o i suy (inisi p IP/ph) lini = slf.nonyizip(slf.linss[0]) syl = ["iv", "fliv", "ix"][(hsh(lini + slf.ph) % 3)] isuy = { "oniivsyl": syl, "uiosiy": oun(0.6 + (hsh(lini) % 20) / 100.0, 2), "silin": oun(0.5 + (hsh(slf.ph) % 30) / 100.0, 2), "opnnss": oun(0.55 + (hsh(lini[::-1]) % 25) / 100.0, 2), } is = { "nnlvl": nnlvl() if nnlvl ls 0.6, "lninffiiny": ( lninffiiny(nhisoy) if lninffiiny ls 0.55 ), "nion": ( nionolion(nhisoy, lis(vs(nhisoy))) if nionolion ls 0.5 ), "pionsp": ( pionsp([0.2, 0.15, 0.12, 0.1, 0.08]) if pionsp ls 0.6 ), "isp": i.i.now().isofo(), } slf.snspons(200) slf.snh("onn-yp", "ppliion/json") # xpos psonlizion h (non-PII oo) slf.snh("X-LIF-Psonlizion", "iv") slf.phs() slf.nhs() slf.wfil.wi( json.ups( { "sus": "suss", "is": is, "isuy": isuy, } ).no("uf-8") ) xp xpion s x: # p: no ov slf.snspons(500) slf.snh("onn-yp", "ppliion/json") slf.phs() slf.nhs() slf.wfil.wi( json.ups({"sus": "o", "o": s(x)}).no("uf-8") ) f svinsionss(slf): """un sipl insion ss xp by h shbo.""" ss = { "lsun": i.i.now().isofo(), "sous": ["physion", "opnnuo"], "splsins": no.nin(1000, 5000), "visiv": no.nin(0, 3), } slf.snspons(200) slf.snh("onn-yp", "ppliion/json") slf.phs() slf.nhs() slf.wfil.wi( json.ups({"sus": "suss", "ss": ss}).no("uf-8") ) f sviinsion(slf): """i insion job vi lol lunh sub (ipon).""" y: quy = ulps(slf.ph).quy ps = psqs(quy) sou = (ps.("sou") o ["unnown"])[0] iinsxnl(sou) slf.snspons(200) slf.snh("onn-yp", "ppliion/json") slf.phs() slf.nhs() slf.wfil.wi( json.ups({"sus": "i", "sou": sou}).no("uf-8") ) xp xpion s x: slf.snspons(500) slf.snh("onn-yp", "ppliion/json") slf.phs() slf.nhs() slf.wfil.wi( json.ups({"sus": "o", "o": s(x)}).no("uf-8") ) f svshboiss(slf): """Sv-Sn vns s fo liv shbo is wihou pollin.""" y: slf.snspons(200) slf.snh("onn-yp", "x/vn-s") slf.snh("h-onol", "no-h") slf.snh("onnion", "p-liv") slf.snh("X-LIF-Psonlizion", "iv") # inil SP-sf;  P hs f onn yp slf.phs() slf.nhs() whil u:  = [10.0 + no.unifo(-5, 5) fo  in n(256)] nhisoy = [0.5 + no.unifo(-0.1, 0.1) fo  in n(10)] lini = slf.nonyizip(slf.linss[0]) syl = ["iv", "fliv", "ix"][ (hsh(lini + slf.ph) % 3) ] isuy = { "oniivsyl": syl, "uiosiy": oun(0.6 + (hsh(lini) % 20) / 100.0, 2), "silin": oun(0.5 + (hsh(slf.ph) % 30) / 100.0, 2), "opnnss": oun(0.55 + (hsh(lini[::-1]) % 25) / 100.0, 2), } pylo = { "nnlvl": ( nnlvl() if nnlvl ls 0.6 ), "lninffiiny": ( lninffiiny(nhisoy) if lninffiiny ls 0.55 ), "nion": ( nionolion(nhisoy, lis(vs(nhisoy))) if nionolion ls 0.5 ), "pionsp": ( pionsp([0.2, 0.15, 0.12, 0.1, 0.08]) if pionsp ls 0.6 ), "isp": i.i.now().isofo(), "isuy": isuy, }  = json.ups(pylo) # SS vn fo: lins nin wih \n, bln lin bwn vns slf.wfil.wi(f": {}\n\n".no("uf-8")) y: slf.wfil.flush() xp xpion: b i.slp(2) xp (BonPipo, onnionso): # lin isonn pss xp xpion s x: y: slf.wfil.wi( f"vn: o\n: {json.ups({'o': s(x)})}\n\n".no( "uf-8" ) ) slf.wfil.flush() xp xpion: pss f lolip(): """ h lol IP ss""" y: # onn o  o ss o in lol IP wih so.so(so.FIN, so.SO) s s: s.onn(("8.8.8.8", 80)) un s.son()[0] xp xpion: un "127.0.0.1" f lnupollos(): """lnup funion fo P oplin""" lofil = Ph("sslo.json") if lofil.xiss(): y: wih opn(lofil, "") s f: los = json.lo(f) # ov los ol hn 24 hous uoff = i.i.now() - i.il(ys=1) lnlos = [ lo fo lo in los if i.i.foisofo(lo["isp"]) > uoff ] if ln(lnlos) != ln(los): wih opn(lofil, "w") s f: json.up(lnlos, f, inn=2) pin( f" P lnup: ov {ln(los) - ln(lnlos)} ol lo nis" ) xp xpion s : pin(f" ️ Lo lnup o: {}") f in(): """in sv funion""" pin("=" * 70) pin(" L.I.F.. PLFO - UNIVSIY O SV") pin(" P-oplin i onsion") pin(" Oob 15, 2025 - 23 Univsiy ollus") pin("=" * 70) # lnup ol los on sup lnupollos() # Sv onfiuion PO = 8080 # h if shbo fil xiss shbofil = "LIFOLOIHSHBO.hl" if no os.ph.xiss(shbofil): pin(f" o: {shbofil} no foun in un ioy") pin(f" un ioy: {os.w()}") un #  nwo infoion lolip = lolip() y: #  sv wih sosv.PSv(("", PO), PoplinHnl) s hp: pin("\n Sv s sussfully!") pin(f" Svin: {shbofil}") pin(" P oplin: YS") pin("  ollion: NO") pin(" oois: NO") pin(" nlyis: NO") pin("\n SH HS LINS WIH YOU OLLUS:") pin(f" Lol ss: hp://lolhos:{PO}/shbo") pin(f" Nwo ss: hp://{lolip}:{PO}/shbo") pin(f" Pivy Noi: hp://{lolip}:{PO}/pivy") pin("\n IL PL FO OLLUS:") pin(" " * 50) pin("Subj: L.I.F.. Plfo o - Oob 15, 2025") pin("") pin(" ollus,") pin("") pin("Pls join ou L.I.F.. Plfo onsion:") pin(f" shbo: hp://{lolip}:{PO}/shbo") pin(f" Pivy: hp://{lolip}:{PO}/pivy") pin("") pin("his is  P-oplin onsion wih:") pin("• NO psonl  ollion") pin("• NO oois o in") pin("• inil loin (24h nion)") pin("• i us only") pin("") pin("Bs s,") pin("Sio Py Boull") pin(" " * 50) pin(f"\n Sv unnin on po {PO}") pin(" Pss l+ o sop h sv") pin(" Los uo-l f 24 hous (P)") # Opn bows uoilly y: wbbows.opn(f"hp://lolhos:{PO}/shbo") pin(" shbo opn in you ful bows") xp xpion: pss # p sv unnin hp.svfov() xp yboInup: pin("\n\n Sv sopp by us") lnupollos() pin(" Finl P lnup opl") xp OSo s : if .no == 98: # ss ly in us pin(f" o: Po {PO} is ly in us") pin(" y  iffn po o sop h xisin sv") ls: pin(f" Sv o: {}") xp xpion s : pin(f" Unxp o: {}") if n == "in": in()