""" PI onio uiliis fo h Nuopiv shbo n bn svis. opus: - nn Lvl (noliz 0..1) - Lnin ffiiny (poxy fo Nuoplsiiy owh) - nion (poxy fo xpin olion) - pion Sp (slf-libion onvn poxy) SII-sf loin. """ fo fuu ipo nnoions fo ypin ipo i, Lis f nnlvl(: Lis[flo]) -> flo: if no : un 0.0 nsinl = su() / ln() # Noliz oun noinl 10..50 n vl = (nsinl - 10.0) / 40.0 un x(0.0, in(1.0, vl)) f lninffiiny(nhisoy: Lis[flo]) -> flo: if no nhisoy: un 0.0 # Sipl iviv poxy l = nhisoy[-1] - nhisoy[0] un x(0.0, in(1.0, 0.5 + l)) f nionolion(hisoy: Lis[flo], hisoyb: Lis[flo]) -> flo: if no hisoy o no hisoyb o ln(hisoy) != ln(hisoyb): un 0.0 n = ln(hisoy) n = su(hisoy) / n nb = su(hisoyb) / n ov = su(( - n) * (b - nb) fo , b in zip(hisoy, hisoyb)) / x( 1, n - 1 ) v = su(( - n) ** 2 fo  in hisoy) / x(1, n - 1) vb = su((b - nb) ** 2 fo b in hisoyb) / x(1, n - 1) no = (v * vb) ** 0.5 if no == 0: un 0.0  = ov / no # p -1..1 o 0..1 un 0.5 + 0.5 * x(-1.0, in(1.0, )) f pionsp(libionos: Lis[flo]) -> flo: if no libionos: un 0.0 # fs op in o -> hih so s = libionos[0] n = libionos[-1] if s <= 0: un 0.0 uion = x(0.0, s - n) / s un x(0.0, in(1.0, uion)) f opupis(: Lis[flo], nhisoy: Lis[flo]) -> i[s, flo]: un { "nnlvl": nnlvl(), "lninffiiny": lninffiiny(nhisoy), }