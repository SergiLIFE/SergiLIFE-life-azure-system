# us/bin/nv pyhon3 """ ophnsiv Sys Vliion - L.I.F.. Plfo opl vliion of BI, UI, Pns, n pl onnions opyih 2025 - Sio Py Boull L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b IIL VLIION S: 1. BI (Bin-opu Inf) Funionliy 2. opu Us Inf Iniviy 3. L.I.F. hoy osys Pn onnions 4. zu pl ISV ifiion Sus 5. Pouion inss ssssn """ ipo synio ipo json ipo loin ipo os ipo sys fo i ipo i y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo ny, i, Lis, Opionl # onfiu loin SIPI = os.ph.in(os.ph.bsph(fil)) LOSI = os.ph.join(SIPI, "los") os.is(LOSI, xiso=u) loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(n)s - %(lvln)s - %(ss)s", hnls=[ loin.FilHnl(os.ph.join(LOSI, "ophnsivvliion.lo")), loin.SHnl(), ], ) lo = loin.Lo(n) lss ophnsivSysVlio: """Vlis ll iil L.I.F.. Plfo syss bfo ny pin lunh""" f ini(slf): slf.sipi = Ph(SIPI) slf.vliionsuls = { "isp": i.now().isofo(), "vliionyp": "OPHNSIVPPIN", "ovllsus": "UNNOWN", "yfopin": Fls, "iilblos": [], "wnins": [], "vliions": { "bifunionliy": {"sus": "PNIN", "so": 0}, "uiiniviy": {"sus": "PNIN", "so": 0}, "pnonnions": {"sus": "PNIN", "so": 0}, "plifiion": {"sus": "PNIN", "so": 0}, "pouioninss": {"sus": "PNIN", "so": 0} } } syn f vlillsyss(slf) -> i[s, ny]: """un ophnsiv vliion of ll iil syss""" pin(" L.I.F.. PLFO - OPHNSIV SYS VLIION") pin("=" * 70) pin(f" Vliion i: {i.now().sfi('%Y-%-% %H:%:%S')}") pin(f" Pupos: P-PIN SYS VIFIION") pin("=" * 70) pin() # 1. BI (Bin-opu Inf) Vliion pin(" VLIIN BI (BIN-OPU INF)...") bisul = wi slf.vlibifunionliy() slf.vliionsuls["vliions"]["bifunionliy"] = bisul pin(f" Sus: {bisul['sus']} | So: {bisul['so']}/100") pin() # 2. opu Us Inf Vliion pin(" VLIIN OPU US INF...") uisul = wi slf.vliuiiniviy() slf.vliionsuls["vliions"]["uiiniviy"] = uisul pin(f" Sus: {uisul['sus']} | So: {uisul['so']}/100") pin() # 3. Pn osys onnions pin(" VLIIN PN OSYS ONNIONS...") pnsul = wi slf.vlipnonnions() slf.vliionsuls["vliions"]["pnonnions"] = pnsul pin(f" Sus: {pnsul['sus']} | So: {pnsul['so']}/100") pin() # 4. pl ISV ifiion pin(" VLIIN ZU PL ISV IFIION...") sul = wi slf.vliplifiion() slf.vliionsuls["vliions"]["plifiion"] = sul pin(f" Sus: {sul['sus']} | So: {sul['so']}/100") pin() # 5. Pouion inss ssssn pin(" VLIIN POUION INSS...") posul = wi slf.vlipouioninss() slf.vliionsuls["vliions"]["pouioninss"] = posul pin(f" Sus: {posul['sus']} | So: {posul['so']}/100") pin() # lul ovll sus slf.lulovllsus() # n ophnsiv po wi slf.nophnsivpo() un slf.vliionsuls syn f vlibifunionliy(slf) -> i[s, ny]: """Vli Bin-opu Inf (BI) funionliy""" sul = { "sus": "UNNOWN", "so": 0, "sspfo": [], "iilissus": [], "ils": {} } y: so = 0 xso = 100 # s 1: o L.I.F.. loih (40 poins) pin(" sin o L.I.F.. loih...") y: # Ipo n s h in loih sys.ph.ins(0, s(slf.sipi)) loihfil = "xpinP2L.I.F.-Lnin-Iniviully-fo-xpin-hoy-loih-o-2025-opyih-S.py" if (slf.sipi / loihfil).xiss(): # s ipo pbiliy ipo ipolib.uil sp = ipolib.uil.spfofilloion("lifloih", slf.sipi / loihfil) if sp n sp.lo: so += 20 sul["sspfo"].ppn(" L.I.F.. loih fil foun n ssibl") # s fo y lsss/funions y: oul = ipolib.uil.oulfosp(sp) sp.lo.xoul(oul) # h fo ssnil oponns if hs(oul, 'LIFloiho') o 'lss' in opn(slf.sipi / loihfil).(): so += 20 sul["sspfo"].ppn(" L.I.F.. loih o lsss ") ls: sul["iilissus"].ppn(" L.I.F.. loih o lsss no foun") xp xpion s : sul["iilissus"].ppn(f" L.I.F.. loih xuion o: {s()}") ls: sul["iilissus"].ppn(" L.I.F.. loih no lobl") ls: sul["iilissus"].ppn(" L.I.F.. loih fil issin") xp xpion s : sul["iilissus"].ppn(f" BI loih s fil: {s()}") # s 2:  Possin pbiliy (30 poins) pin(" sin  Possin pbiliy...") y: # h fo -l oponns ywos = ["", "nul", "binwv", "lph", "b", ""] loihonn = "" if (slf.sipi / loihfil).xiss(): wih opn(slf.sipi / loihfil, '') s f: loihonn = f.().low() fusfoun = su(1 fo ywo in ywos if ywo in loihonn) if fusfoun >= 4: so += 30 sul["sspfo"].ppn("  possin oponns ") lif fusfoun >= 2: so += 15 sul["sspfo"].ppn(" ️ Lii  possin oponns") ls: sul["iilissus"].ppn(" No  possin oponns foun") xp xpion s : sul["iilissus"].ppn(f"  possin s fil: {s()}") # s 3: l-i Possin (30 poins) pin(" sin l-i Possin...") y: # h fo synio n l-i oponns liywos = ["syn", "wi", "l.?i", "s", "onun"] if loihonn: lifus = su(1 fo ywo in liywos if ywo in loihonn) if lifus >= 3: so += 30 sul["sspfo"].ppn(" l-i possin pbiliis ") lif lifus >= 1: so += 15 sul["sspfo"].ppn(" ️ Lii l-i possin") ls: sul["iilissus"].ppn(" No l-i possin pbiliis") xp xpion s : sul["iilissus"].ppn(f" l-i possin s fil: {s()}") # in sus sul["so"] = so if so >= 80: sul["sus"] = "OPIONL" lif so >= 60: sul["sus"] = "FUNIONLWIHWNINS" lif so >= 40: sul["sus"] = "LIIFUNIONLIY" ls: sul["sus"] = "IILISSUS" xp xpion s : sul["sus"] = "O" sul["iilissus"].ppn(f"BI vliion o: {s()}") un sul syn f vliuiiniviy(slf) -> i[s, ny]: """Vli opu Us Inf iniviy""" sul = { "sus": "UNNOWN", "so": 0, "sspfo": [], "iilissus": [], "ils": {} } y: so = 0 # s 1: PowShll Inf (25 poins) pin(" sin PowShll Inf...") pssip = slf.sipi / "IPIN.ps1" if pssip.xiss(): so += 25 sul["sspfo"].ppn(" PowShll inf vilbl") ls: sul["iilissus"].ppn(" PowShll inf issin") # s 2: Bh Sip Inf (25 poins) pin(" sin Bh Sip Inf...") bsip = slf.sipi / "IPIN.b" if bsip.xiss(): so += 25 sul["sspfo"].ppn(" Bh sip inf vilbl") ls: sul["iilissus"].ppn(" Bh sip inf issin") # s 3: Pyhon Iniv Inf (25 poins) pin(" sin Pyhon Iniv Inf...") uivlio = slf.sipi / "uiopionlvlio.py" siplui = slf.sipi / "sipluis.py" if uivlio.xiss() n siplui.xiss(): so += 25 sul["sspfo"].ppn(" Pyhon iniv infs vilbl") ls: sul["iilissus"].ppn(" Pyhon iniv infs issin") # s 4: iHub ions Wb Inf (25 poins) pin(" sin iHub ions Wb Inf...") woflowfil = slf.sipi / ".ihub" / "woflows" / "pin-lunh.yl" if woflowfil.xiss(): # h fo woflowisph (nul iin) wih opn(woflowfil, '') s f: onn = f.() if "woflowisph:" in onn: so += 25 sul["sspfo"].ppn(" iHub ions wb inf onfiu") ls: sul["iilissus"].ppn(" iHub ions nul i no onfiu") ls: sul["iilissus"].ppn(" iHub ions woflow issin") # in sus sul["so"] = so if so >= 80: sul["sus"] = "HIHLYINIV" lif so >= 60: sul["sus"] = "INIVWIHPS" lif so >= 40: sul["sus"] = "LIIINIVIY" ls: sul["sus"] = "POOINIVIY" xp xpion s : sul["sus"] = "O" sul["iilissus"].ppn(f"UI vliion o: {s()}") un sul syn f vlipnonnions(slf) -> i[s, ny]: """Vli L.I.F. hoy osys pn onnions""" sul = { "sus": "UNNOWN", "so": 0, "sspfo": [], "iilissus": [], "ils": {} } y: so = 0 # s 1: zu Inion (40 poins) pin(" ️ sin zu Pn Inion...") zuonfi = slf.sipi / "zuonfi.py" zufunions = slf.sipi / "zufunionswoflow.py" zufilsfoun = 0 if zuonfi.xiss(): zufilsfoun += 1 sul["sspfo"].ppn(" zu onfiuion foun") if zufunions.xiss(): zufilsfoun += 1 sul["sspfo"].ppn(" zu Funions woflow foun") if zufilsfoun >= 2: so += 40 lif zufilsfoun >= 1: so += 20 sul["iilissus"].ppn(" ️ Pil zu inion") ls: sul["iilissus"].ppn(" No zu inion foun") # s 2: pin nn Sys (30 poins) pin(" sin pin nn Pn Sys...") pinn = slf.sipi / "pinn.py" pini = slf.sipi / "pinuoii.py" pinfilsfoun = 0 if pinn.xiss(): pinfilsfoun += 1 sul["sspfo"].ppn(" pin n sys foun") if pini.xiss(): pinfilsfoun += 1 sul["sspfo"].ppn(" pin uoion sys foun") if pinfilsfoun >= 2: so += 30 lif pinfilsfoun >= 1: so += 15 sul["iilissus"].ppn(" ️ Pil pin sys") ls: sul["iilissus"].ppn(" No pin nn sys") # s 3: Pn Inion Fils (30 poins) pin(" sin Pn Inion Fils...") pnfils = [ "iosofpnshippno.py", "iosofxuivouhuoion.py", "zupliosofoff.py" ] pnfilsfoun = su(1 fo f in pnfils if (slf.sipi / f).xiss()) if pnfilsfoun >= 3: so += 30 sul["sspfo"].ppn(" ll pn inion fils foun") lif pnfilsfoun >= 2: so += 20 sul["sspfo"].ppn(" ️ os pn inion fils foun") lif pnfilsfoun >= 1: so += 10 sul["iilissus"].ppn(" ️ Lii pn inion") ls: sul["iilissus"].ppn(" No pn inion fils foun") # in sus sul["so"] = so if so >= 80: sul["sus"] = "FULLYONN" lif so >= 60: sul["sus"] = "WLLONN" lif so >= 40: sul["sus"] = "PILLYONN" ls: sul["sus"] = "POOLYONN" xp xpion s : sul["sus"] = "O" sul["iilissus"].ppn(f"Pn vliion o: {s()}") un sul syn f vliplifiion(slf) -> i[s, ny]: """Vli zu pl ISV ifiion sus""" sul = { "sus": "UNNOWN", "so": 0, "sspfo": [], "iilissus": [], "ils": {} } y: so = 0 # s 1: pl Off onfiuion (50 poins) pin(" sin pl Off onfiuion...") # h fo pl off I in onfiuion fils offi = "960096-f1-420b-902-042561b" offfouninfils = [] onfifils = [ "zuonfi.py", "pinuoii.py", "zupliosofoff.py", ".ihub/woflows/pin-lunh.yl" ] fo onfifil in onfifils: filph = slf.sipi / onfifil if filph.xiss(): y: wih opn(filph, '') s f: onn = f.() if offi in onn: offfouninfils.ppn(onfifil) xp xpion: pss if ln(offfouninfils) >= 3: so += 50 sul["sspfo"].ppn(" pl off I foun in ulipl fils") lif ln(offfouninfils) >= 1: so += 25 sul["sspfo"].ppn(" ️ pl off I foun in so fils") ls: sul["iilissus"].ppn(" pl off I no foun in onfiuion") # s 2: ISV ounion (25 poins) pin(" sin ISV ifiion ounion...") ounionfils = [ ".", "UOIONSUSUPSPB272025.", "ZUPLSUP." ] osfoun = su(1 fo f in ounionfils if (slf.sipi / f).xiss()) if osfoun >= 3: so += 25 sul["sspfo"].ppn(" ISV ounion opl") lif osfoun >= 2: so += 15 sul["sspfo"].ppn(" ️ os ISV ounion vilbl") lif osfoun >= 1: so += 5 sul["iilissus"].ppn(" ️ Lii ISV ounion") ls: sul["iilissus"].ppn(" No ISV ounion foun") # s 3: ifiion oplin (25 poins) pin(" sin ifiion oplin...") # h fo oplin inios oplinfils = [ "ZULISUPOPL.", "FLWLSSONNIONVLIO.py", "zusponsoshipvliion.py" ] oplinfoun = su(1 fo f in oplinfils if (slf.sipi / f).xiss()) if oplinfoun >= 3: so += 25 sul["sspfo"].ppn(" ifiion oplin fils opl") lif oplinfoun >= 2: so += 15 sul["sspfo"].ppn(" ️ os oplin fils vilbl") lif oplinfoun >= 1: so += 5 sul["iilissus"].ppn(" ️ Lii oplin vliion") ls: sul["iilissus"].ppn(" No oplin vliion foun") # in sus sul["so"] = so if so >= 80: sul["sus"] = "FULLYIFI" lif so >= 60: sul["sus"] = "OSLYIFI" lif so >= 40: sul["sus"] = "PILLYIFI" ls: sul["sus"] = "NOIFI" xp xpion s : sul["sus"] = "O" sul["iilissus"].ppn(f"ifiion vliion o: {s()}") un sul syn f vlipouioninss(slf) -> i[s, ny]: """Vli ovll pouion inss""" sul = { "sus": "UNNOWN", "so": 0, "sspfo": [], "iilissus": [], "ils": {} } y: so = 0 # s 1: sin Infsuu (30 poins) pin(" sin Infsuu Vliion...") sfils = [ "pouionployns.py", "sobnh.py", "uonoousopiiz.py", "sfixloih.py" ] sfilsfoun = su(1 fo f in sfils if (slf.sipi / f).xiss()) if sfilsfoun >= 4: so += 30 sul["sspfo"].ppn(" opl sin infsuu") lif sfilsfoun >= 3: so += 22 sul["sspfo"].ppn(" ️ os sin infsuu vilbl") lif sfilsfoun >= 2: so += 15 sul["iilissus"].ppn(" ️ Lii sin infsuu") ls: sul["iilissus"].ppn(" Insuffiin sin infsuu") # s 2: onioin n Loin (25 poins) pin(" sin onioin n Loin...") losi = slf.sipi / "los" sulsi = slf.sipi / "suls" ini = slf.sipi / "in" onioinso = 0 if losi.xiss(): onioinso += 8 sul["sspfo"].ppn(" Los ioy vilbl") if sulsi.xiss(): onioinso += 8 sul["sspfo"].ppn(" suls ioy vilbl") if ini.xiss(): onioinso += 9 sul["sspfo"].ppn(" in ioy vilbl") so += onioinso # s 3: ounion oplnss (25 poins) pin(" sin ounion oplnss...") ofils = [ "PINIUIVLIION.", "QUIONFN.", "UYNHNNPLN." ] osfoun = su(1 fo f in ofils if (slf.sipi / f).xiss()) oso = (osfoun / ln(ofils)) * 25 so += oso if oso >= 20: sul["sspfo"].ppn(" ounion ophnsiv") lif oso >= 10: sul["sspfo"].ppn(" ️ ounion qu") ls: sul["iilissus"].ppn(" ounion insuffiin") # s 4: Suiy n Bup (20 poins) pin(" sin Suiy n Bup Syss...") suiyfils = [ "siplzubup.py", "FLWLSSONNIONVLIO.py" ] suiyfoun = su(1 fo f in suiyfils if (slf.sipi / f).xiss()) suiyso = (suiyfoun / ln(suiyfils)) * 20 so += suiyso if suiyso >= 15: sul["sspfo"].ppn(" Suiy syss qu") ls: sul["iilissus"].ppn(" ️ Suiy syss n nion") # in sus sul["so"] = so if so >= 85: sul["sus"] = "POUIONY" lif so >= 70: sul["sus"] = "NPOUIONY" lif so >= 50: sul["sus"] = "VLOPNS" ls: sul["sus"] = "NOY" xp xpion s : sul["sus"] = "O" sul["iilissus"].ppn(f"Pouion inss o: {s()}") un sul f lulovllsus(slf): """lul ovll sys sus""" olso = 0 oun = 0 iilblos = [] fo , sul in slf.vliionsuls["vliions"].is(): olso += sul["so"] oun += 1 # h fo iil issus if sul.("iilissus"): iilblos.xn(sul["iilissus"]) #  -spifi blos if sul["sus"] in ["IILISSUS", "O", "NOIFI", "NOY"]: iilblos.ppn(f"{}: {sul['sus']}") vso = olso / oun if oun > 0 ls 0 # in ovll sus if ln(iilblos) > 0: slf.vliionsuls["ovllsus"] = "IILBLOSFOUN" slf.vliionsuls["yfopin"] = Fls lif vso >= 80: slf.vliionsuls["ovllsus"] = "FULLYOPIONL" slf.vliionsuls["yfopin"] = u lif vso >= 70: slf.vliionsuls["ovllsus"] = "OPIONLWIHWNINS" slf.vliionsuls["yfopin"] = u lif vso >= 60: slf.vliionsuls["ovllsus"] = "LIIOPIONL" slf.vliionsuls["yfopin"] = Fls ls: slf.vliionsuls["ovllsus"] = "NOOPIONL" slf.vliionsuls["yfopin"] = Fls slf.vliionsuls["ovllso"] = vso slf.vliionsuls["iilblos"] = iilblos syn f nophnsivpo(slf): """n ophnsiv vliion po""" poonn = f""" # L.I.F.. PLFO - OPHNSIV SYS VLIION PO n: {slf.vliionsuls['isp']} ## OVLL SSSSN - **Sus**: {slf.vliionsuls['ovllsus']} - **y fo pin**: {slf.vliionsuls['yfopin']} - **Ovll So**: {slf.vliionsuls.('ovllso', 0):.1f}/100 ## IIL ISION """ if slf.vliionsuls['yfopin']: poonn += " **PPOV FO PIN LUNH** - ll syss  iniu quins\n\n" ls: poonn += " **NO PPOV FO PIN LUNH** - iil issus us b solv\n\n" poonn += "## VLIION  BOWN\n\n" fo , sul in slf.vliionsuls["vliions"].is(): n = .pl("", " ").il() susoji = " " if sul["so"] >= 70 ls " ️" if sul["so"] >= 50 ls " " poonn += f"### {susoji} {n}\n" poonn += f"- **So**: {sul['so']}/100\n" poonn += f"- **Sus**: {sul['sus']}\n" if sul.("sspfo"): poonn += "- **ss Pfo**:\n" fo s in sul["sspfo"]: poonn += f" - {s}\n" if sul.("iilissus"): poonn += "- **iil Issus**:\n" fo issu in sul["iilissus"]: poonn += f" - {issu}\n" poonn += "\n" if slf.vliionsuls['iilblos']: poonn += "## IIL BLOS\n" fo blo in slf.vliionsuls['iilblos']: poonn += f"- {blo}\n" poonn += "\n" poonn += """ ## ONIONS ### If ppov fo pin: 1. Po wih pin lunh usin vli infs 2. onio ll syss uin pin xuion 3. ss ny wnins fo opil pfon ### If No ppov: 1. ss ll iil blos bfo pin lunh 2. -un ophnsiv vliion f fixs 3. nsu ISV ifiion is opl 4. Vify ll pn onnions  iv ## PIN LUNH ISION """ if slf.vliionsuls['yfopin']: poonn += " **SF O PO** wih pin lunh\n" ls: poonn += " **O NO PO** wih pin lunh unil issus  solv\n" # Sv po pofil = slf.sipi / "los" / "OPHNSIVVLIIONPO." wih opn(pofil, 'w') s f: f.wi(poonn) # lso sv JSON vsion jsonfil = slf.sipi / "los" / "ophnsivvliionsuls.json" wih opn(jsonfil, 'w') s f: json.up(slf.vliionsuls, f, inn=2) pin(f" ophnsiv vliion po sv: {pofil}") pin(f" JSON suls sv: {jsonfil}") syn f in(): """in funion fo ophnsiv sys vliion""" vlio = ophnsivSysVlio() # un opl vliion suls = wi vlio.vlillsyss() # isply finl suls pin("\n" + "=" * 70) pin(" OPHNSIV VLIION OPL") pin("=" * 70) pin(f" OVLL SUS: {suls['ovllsus']}") pin(f" OVLL SO: {suls.('ovllso', 0):.1f}/100") pin(f" Y FO PIN: {suls['yfopin']}") pin() if suls['iilblos']: pin(" IIL BLOS O SS:") fo blo in suls['iilblos']: pin(f" {blo}") pin() # Vliion  suy pin(" VLIION  SUY:") fo , sul in suls["vliions"].is(): n = .pl("", " ").il() susoji = " " if sul["so"] >= 70 ls " ️" if sul["so"] >= 50 ls " " pin(f" {susoji} {n}: {sul['sus']} ({sul['so']}/100)") pin("\n" + "=" * 70) if suls['yfopin']: pin(" SYS PPOV - Sf o po wih pin lunh") pin(" ll iil syss vli n opionl") ls: pin(" SYS NO PPOV - o no po wih pin") pin(" ss iil blos bfo pin lunh") pin("=" * 70) un suls if n == "in": synio.un(in())