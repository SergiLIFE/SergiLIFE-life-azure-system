# L.I.F. Plfo - PI onioin Sys nhnn # oun & oplin Iniy onioin """ nhn PI onioin o  oun iniy, opionl sus, n oplin oun hlh o pvn oupion/oninion. """ ipo i ipo hshlib ipo json ipo loin ipo os y: fo phlib ipo Ph xp Ipoo s : pin(f'Wnin: {}') pss fo ypin ipo ny, i, Lis, Opionl lss oplinounonio: """onio oplin ouns fo iniy n opionl sus""" f ini(slf, bsph: s = "."): slf.bsph = Ph(bsph) slf.oplinos = [ "LIFPLFOOPLINPO2025.", "PIVYPOLIY.", "SOFSVI.", "ZUOISUP.", "sup-zu-oi.ps1", "zuonfi.py", "pouionployns.py" ] slf.subupph = slf.bsph / "OPLINBUPSU" slf.onioinlo = slf.bsph / "los" / "oplinonio.lo" # nsu iois xis os.is(slf.subupph, xiso=u) os.is(slf.bsph / "los", xiso=u) # Sup loin loin.bsionfi( filn=slf.onioinlo, lvl=loin.INFO, fo='%(si)s - %(lvln)s - %(ss)s' ) slf.lo = loin.Lo(n) f lulfilhsh(slf, filph: Ph) -> Opionl[s]: """lul SH-256 hsh of fil fo iniy hin""" y: wih opn(filph, 'b') s f: filhsh = hshlib.sh256(f.()).hxis() un filhsh xp xpion s : slf.lo.o(f"o lulin hsh fo {filph}: {}") un Non f onioouniniy(slf) -> i[s, ny]: """onio ll oplin ouns fo iniy n oupion""" iniypo = { "isp": i.i.now().isofo(), "ouns": {}, "ovllsus": "OPIONL", "issus": [], "bupsus": "SU" } fo on in slf.oplinos: oph = slf.bsph / on bupph = slf.subupph / f"{on}.bup" osus = { "xiss": oph.xiss(), "siz": 0, "hsh": Non, "lsoifi": Non, "bupxiss": bupph.xiss(), "sus": "UNNOWN" } if oph.xiss(): y: s = oph.s() osus.up({ "siz": s.ssiz, "hsh": slf.lulfilhsh(oph), "lsoifi": i.i.foisp(s.si).isofo(), "sus": "OPIONL" if s.ssiz > 0 ls "OUP" }) # h fo oupion inios if s.ssiz == 0: iniypo["issus"].ppn(f"{on}: Fil is py (oup)") iniypo["ovllsus"] = "IIL" lif s.ssiz < 100: # Suspiiously sll iniypo["issus"].ppn(f"{on}: Fil unusully sll ({s.ssiz} bys)") xp xpion s : osus["sus"] = "O" iniypo["issus"].ppn(f"{on}: o ssin fil - {}") ls: osus["sus"] = "ISSIN" iniypo["issus"].ppn(f"{on}: Fil issin") iniypo["ovllsus"] = "IIL" iniypo["ouns"][on] = osus # Lo h po slf.lo.info(f"oun iniy h opl: {iniypo['ovllsus']}") if iniypo["issus"]: fo issu in iniypo["issus"]: slf.lo.wnin(f"Iniy issu: {issu}") un iniypo f subups(slf) -> bool: """ su bups of ll oplin ouns""" y: bupnifs = { "": i.i.now().isofo(), "bups": {} } fo on in slf.oplinos: oph = slf.bsph / on if oph.xiss(): bupph = slf.subupph / f"{on}.bup" # opy fil o su bup wih opn(oph, 'b') s s, opn(bupph, 'wb') s s: s.wi(s.()) # o bup info bupnifs["bups"][on] = { "bupph": s(bupph), "oiinlhsh": slf.lulfilhsh(oph), "buphsh": slf.lulfilhsh(bupph), "siz": oph.s().ssiz } # Sv nifs nifsph = slf.subupph / "bupnifs.json" wih opn(nifsph, 'w') s f: json.up(bupnifs, f, inn=2) slf.lo.info(f"Su bups  fo {ln(bupnifs['bups'])} ouns") un u xp xpion s : slf.lo.o(f"o in su bups: {}") un Fls f sofobup(slf, ounn: s) -> bool: """so  oun fo su bup""" y: bupph = slf.subupph / f"{ounn}.bup" oiinlph = slf.bsph / ounn if no bupph.xiss(): slf.lo.o(f"No bup foun fo {ounn}") un Fls # so fo bup wih opn(bupph, 'b') s s, opn(oiinlph, 'wb') s s: s.wi(s.()) slf.lo.info(f"Sussfully so {ounn} fo bup") un u xp xpion s : slf.lo.o(f"o soin {ounn}: {}") un Fls f pllunhsus(slf) -> i[s, ny]: """h pl lunh inss sus""" lunhsus = { "isp": i.i.now().isofo(), "lunh": "2025-09-27", "inss": "Y", "iilouns": {}, "ilvifiion": "PNIN", "issus": [] } # iil ouns fo pl lunh iilos = [ "LIFPLFOOPLINPO2025.", "PIVYPOLIY.", "zuonfi.py" ] fo o in iilos: oph = slf.bsph / o if oph.xiss() n oph.s().ssiz > 0: lunhsus["iilouns"][o] = "Y" ls: lunhsus["iilouns"][o] = "ISSIN/OUP" lunhsus["inss"] = "NOY" lunhsus["issus"].ppn(f"iil oun {o} issin o oup") # il vifiion sus lunhsus["ilvifiionion"] = { "qui": "Up Pn n il fo Info@lifoh121.o o sio@lifoh-121.o", "sus": "PNINUSION", "nxsps": [ "o o Pn n shbo", "Up Piy on il o sio@lifoh-121.o", "li 'sn' vifiion il", "h il fo 'ion n: Vify you il oun wih iosof'" ] } un lunhsus # Inion wih xisin PI onioin f oplinonioinopi(): """ oplin oun onioin o xisin PI sys""" onio = oplinounonio() # un iniy h iniypo = onio.onioouniniy() #  su bups bupsuss = onio.subups() # h lunh inss lunhsus = onio.pllunhsus() # obin PI po pioplinpo = { "oplinonioin": { "ouniniy": iniypo, "bupsus": "SUSS" if bupsuss ls "FIL", "lunhinss": lunhsus, "onioiniv": u, "lsh": i.i.now().isofo() } } un pioplinpo if n == "in": # un oplin onioin pin(" L.I.F. Plfo - oplin oun onioin") pin("=" * 60) onio = oplinounonio() # 1. h oun iniy pin("\n hin oun iniy...") iniy = onio.onioouniniy() pin(f"Ovll Sus: {iniy['ovllsus']}") if iniy['issus']: pin(" ️ Issus foun:") fo issu in iniy['issus']: pin(f" - {issu}") ls: pin(" ll ouns opionl") # 2.  su bups pin("\n in su bups...") bupsul = onio.subups() pin(f"Bup Sus: {' SUSS' if bupsul ls ' FIL'}") # 3. h pl lunh inss pin("\n hin pl lunh inss...") lunh = onio.pllunhsus() pin(f"Lunh inss: {lunh['inss']}") pin(f"il Vifiion: {lunh['ilvifiion']}") if lunh['issus']: pin(" ️ Lunh blos:") fo issu in lunh['issus']: pin(f" - {issu}") pin("\n" + "=" * 60) pin(" NX ION: Up Pn n il o sio@lifoh-121.o") pin(" hn sn vifiion il n h inbox!") pin(" You' los  h finish lin!") pin(" You' los  h finish lin!")