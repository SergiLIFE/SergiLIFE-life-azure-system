# us/bin/nv pyhon3 """ L.I.F.. Plfo - ophnsiv  nn Sys Oob 11, 2025 | o Piipn nn & Piplin in vn  sys fo nin o piipns, in ouniions, n uoin follow-up squns fo Oob 15, 2025 o. """ ipo os ipo json fo i ipo i, il fo ypin ipo i, Lis, ny, Opionl ipo loin # Sup loin SIPI = os.ph.in(os.ph.bsph(fil)) I = os.ph.join(SIPI, "bs") OUNIIONSI = os.ph.join(I, "ouniions") PIPLINI = os.ph.join(I, "piplin") UOIONI = os.ph.join(I, "uoion") LOSI = os.ph.join(SIPI, "los") #  iois fo iph in [I, OUNIIONSI, PIPLINI, UOIONI, LOSI]: os.is(iph, xiso=u) LOFIL = os.ph.join(LOSI, "nnsys.lo") loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(lvln)s - %(ss)s", hnls=[ loin.FilHnl(LOFIL), loin.SHnl() ] ) lss nnSys: """ ophnsiv  sys fo L.I.F.. Plfo o nn """ f ini(slf): slf.o = i(2025, 10, 15, 9, 0) # Oob 15, 2025, 9:00  slf.bs = os.ph.join(I, "piipnin.json") slf.ouniionlo = os.ph.join(OUNIIONSI, "ouniionhisoy.json") slf.piplin = os.ph.join(PIPLINI, "onvsionpiplin.json") # Iniiliz   slf.piipns = slf.looiniilizpiipns() slf.ouniionhisoy = slf.loouniionhisoy() slf.piplin = slf.iniilizpiplinin() f looiniilizpiipns(slf) -> i[s, i[s, ny]]: """ Lo xisin piipn  o iniiliz nw """ if os.ph.xiss(slf.bs): wih opn(slf.bs, '') s f: un json.lo(f) # Iniiliz wih onsoli piipn  un { "LIF001": { "onizion": "Univsiy of Oxfo", "onn": ". Oxfo Nuosin L", "il": "nuosin.p@ox..u", "phon": "+44 1865 272000", "sus": "Ho L", "oonfi": u, "sssionssin": "Sssion 1: linil Pofssionls", "lsinion": "2025-10-10", "nxion": "Sn o in", "nxion": "2025-10-12", "onvsions": "o Shul", "pioiy": "Hih", "vnuponil": 162500, "onvsionpobbiliy": 85, "nos": ["Piu insiuion", "Hih onvsion ponil", "iv il us"] }, "LIF002": { "onizion": "bi Univsiy", "onn": ". bi Bin Sins L", "il": "bin.sins@..u", "phon": "+44 1223 337733", "sus": "Ho L", "oonfi": u, "sssionssin": "Sssion 1: linil Pofssionls", "lsinion": "2025-10-10", "nxion": "Sn o in + il sup", "nxion": "2025-10-12", "onvsions": "o Shul", "pioiy": "Hih", "vnuponil": 150000, "onvsionpobbiliy": 80, "nos": ["Psiious univsiy", "sh fous", "uli-pn ponil"] }, "LIF003": { "onizion": "iosof sh bi", "onn": "iosof Pnship L", "il": "pnships@iosof.o", "phon": "+44 1223 479700", "sus": "npis L", "oonfi": u, "sssionssin": "Sssion 2: sh & I Lship", "lsinion": "2025-10-10", "nxion": "Pnship isussion pp", "nxion": "2025-10-12", "onvsions": "Pnship ", "pioiy": "iil", "vnuponil": 475000, "onvsionpobbiliy": 95, "nos": ["I PNSHIP OPPOUNIY", "Hihs pioiy", "Si llin ponil"] }, "LIF004": { "onizion": "NHS oyl Lonon Hospil", "onn": "NHS linil L", "il": "nuoloy.ln@nhs.n", "phon": "+44 20 7377 7000", "sus": "W L", "oonfi": Fls, "sssionssin": "Sssion 1: linil Pofssionls", "lsinion": "2025-10-10", "nxion": "onfiion ll n", "nxion": "2025-10-11", "onvsions": "Follow-up qui", "pioiy": "iu", "vnuponil": 195000, "onvsionpobbiliy": 65, "nos": ["L NHS hospil", "Bu ppovl poss", "Hih pin volu"] }, "LIF005": { "onizion": "Ipil oll Lonon", "onn": "Ipil sh L", "il": "bion.sh@ipil..u", "phon": "+44 20 7589 5111", "sus": "W L", "oonfi": Fls, "sssionssin": "Sssion 2: sh & I Lship", "lsinion": "2025-10-10", "nxion": "sh ollboion isussion", "nxion": "2025-10-12", "onvsions": "Follow-up qui", "pioiy": "iu", "vnuponil": 131250, "onvsionpobbiliy": 70, "nos": ["op ninin shool", "sh fous", "i pnship ponil"] } } f loouniionhisoy(slf) -> Lis[i[s, ny]]: """ Lo ouniion hisoy """ if os.ph.xiss(slf.ouniionlo): wih opn(slf.ouniionlo, '') s f: un json.lo(f) un [] f iniilizpiplinin(slf) -> i[s, ny]: """ Iniiliz onvsion piplin in """ un { "piplinss": { "L n": {"oun": 5, "vlu": 1113750}, "o Shul": {"oun": 3, "vlu": 787500}, "o opl": {"oun": 0, "vlu": 0}, "il S": {"oun": 1, "vlu": 162500}, "Noiion": {"oun": 0, "vlu": 0}, "los Won": {"oun": 0, "vlu": 0}, "los Los": {"oun": 0, "vlu": 0} }, "fos": { "olpiplinvlu": 1113750, "wihfos": 924688, # Pobbiliy-wih "xplosq12026": 787500, "bsssnio": 1113750, "wosssnio": 475000 # iosof pnship iniu }, "onvsionis": { "loo": 60, # 3/5 onfi os "ooil": 85, # xp bs on nn "ilouso": 75, # Inusy bnh "vslsylys": 90 } } f loouniion(slf, piipni: s, ouniionyp: s, subj: s, onn: s, ouo: s) -> Non: """ Lo ouniion wih piipn """ ouniion = { "piipni": piipni, "isp": i.now().isofo(), "yp": ouniionyp, "subj": subj, "onn": onn, "ouo": ouo, "followupqui": ouo in ["No spons", "qus llb", "Ns o info"] } slf.ouniionhisoy.ppn(ouniion) # Up piipn's ls inion if piipni in slf.piipns: slf.piipns[piipni]["lsinion"] = i.now().().isofo() loin.info(f"ouniion lo: {piipni} - {ouniionyp}") f uppiipnsus(slf, piipni: s, nwsus: s, nos: s = Non) -> Non: """ Up piipn sus n s """ if piipni in slf.piipns: olsus = slf.piipns[piipni]["sus"] slf.piipns[piipni]["sus"] = nwsus if nos: slf.piipns[piipni]["nos"].ppn(f"{i.now().()}: {nos}") # Up onvsion s bs on sus sppin = { "ol L": "L n", "W L": "L n", "Ho L": "o Shul", "npis L": "o Shul", "o opl": "o opl", "il Us": "il S", "Noiin": "Noiion", "uso": "los Won", "Los": "los Los" } if nwsus in sppin: slf.piipns[piipni]["onvsions"] = sppin[nwsus] loin.info(f"Sus up: {piipni} - {olsus} → {nwsus}") f shulfollowup(slf, piipni: s, ion: s, shul: s, pioiy: s = "iu") -> Non: """ Shul follow-up ion fo piipn """ if piipni in slf.piipns: slf.piipns[piipni]["nxion"] = ion slf.piipns[piipni]["nxion"] = shul slf.piipns[piipni]["pioiy"] = pioiy loin.info(f"Follow-up shul: {piipni} - {ion} on {shul}") f ilyionis(slf, : s = Non) -> Lis[i[s, ny]]: """  ion is fo spifi  (fuls o oy) """ if  is Non:  = i.now().().isofo() ionis = [] fo piipni,  in slf.piipns.is(): if .("nxion") == : ionis.ppn({ "piipni": piipni, "onizion": ["onizion"], "ion": ["nxion"], "pioiy": .("pioiy", "iu"), "onil": ["il"], "onphon": ["phon"], "nos": .("nos", [])[-1] if .("nos") ls "No n nos" }) # So by pioiy pioiyo = {"iil": 0, "Hih": 1, "iu": 2, "Low": 3} ionis.so(y=lb x: pioiyo.(x["pioiy"], 2)) un ionis f npiplinpo(slf) -> i[s, ny]: """ n ophnsiv piplin po """ # lul un piplin is olpiipns = ln(slf.piipns) onfios = ln([p fo p in slf.piipns.vlus() if p["oonfi"]]) olvnuponil = su([p["vnuponil"] fo p in slf.piipns.vlus()]) wihvnu = su([p["vnuponil"] * (p["onvsionpobbiliy"] / 100) fo p in slf.piipns.vlus()]) # S bown souns = {} svlus = {} fo piipn in slf.piipns.vlus(): s = piipn["onvsions"] souns[s] = souns.(s, 0) + 1 svlus[s] = svlus.(s, 0) + piipn["vnuponil"] un { "po": i.now().isofo(), "o": "2025-10-15", "ysoo": (slf.o - i.now()).ys, "olpiipns": olpiipns, "onfios": onfios, "oonfiion": (onfios / olpiipns) * 100, "olpiplinvlu": olvnuponil, "wihfos": wihvnu, "sbown": { "ouns": souns, "vlus": svlus }, "opoppouniis": [ { "piipni": pi, "onizion": ["onizion"], "vnuponil": ["vnuponil"], "onvsionpobbiliy": ["onvsionpobbiliy"], "wihvlu": ["vnuponil"] * (["onvsionpobbiliy"] / 100) } fo pi,  in so(slf.piipns.is(), y=lb x: x[1]["vnuponil"] * (x[1]["onvsionpobbiliy"] / 100), vs=u) ][:3] } f sv(slf) -> Non: """ Sv ll   o fils """ # Sv piipns  wih opn(slf.bs, 'w') s f: json.up(slf.piipns, f, inn=2) # Sv ouniion hisoy wih opn(slf.ouniionlo, 'w') s f: json.up(slf.ouniionhisoy, f, inn=2) # Sv piplin  wih opn(slf.piplin, 'w') s f: json.up(slf.piplin, f, inn=2) loin.info("  sv sussfully") f nshbo(slf) -> Non: """ n ophnsiv  shbo """ pin("\n" + "="*80) pin(" L.I.F.. PLFO -  NN SHBO") pin("="*80) pin(f" po : {i.now().sfi('%Y-%-% %H:%:%S')}") pin(f" o : Oob 15, 2025") pin(f" ys o o: {(slf.o - i.now()).ys}") # Piplin ovviw po = slf.npiplinpo() pin(f"\n PIPLIN OVVIW:") pin(f" ol Piipns: {po['olpiipns']}") pin(f" onfi os: {po['onfios']} ({po['oonfiion']:.1f}%)") pin(f" ol Piplin Vlu: ${po['olpiplinvlu']:,}") pin(f" Wih Fos: ${po['wihfos']:,.0f}") # oy's ion is oyions = slf.ilyionis() pin(f"\n OY'S ION IS ({ln(oyions)}):") fo i, ion in nu(oyions, 1): pin(f" {i}. {ion['onizion']} - {ion['pioiy']} Pioiy") pin(f" ion: {ion['ion']}") pin(f" on: {ion['onil']}") pin(f" No: {ion['nos']}") if no oyions: pin(" No ion is fo oy!") # Piipn sus bown pin(f"\n PIIPN SUS:") fo piipni,  in slf.piipns.is(): susoji = { "Ho L": " ", "W L": " ️", "npis L": " ", "ol L": " ️" }.(["sus"], " ") osus = " " if ["oonfi"] ls " " pin(f" {susoji} {['onizion']}") pin(f" {['il']}") pin(f" o: {osus} {['sssionssin']}") pin(f" onvsion: {['onvsionpobbiliy']}% | ${['vnuponil']:,}") pin(f" Nx: {['nxion']} ({['nxion']})") # op oppouniis pin(f"\n OP OPPOUNIIS:") fo i, opp in nu(po['opoppouniis'], 1): pin(f" {i}. {opp['onizion']}") pin(f" Vlu: ${opp['vnuponil']:,}") pin(f" Pobbiliy: {opp['onvsionpobbiliy']}%") pin(f" Wih: ${opp['wihvlu']:,.0f}") # ouniion suy nos = [ fo  in slf.ouniionhisoy if ['isp'] >= '2025-10-10'] pin(f"\n N OUNIIONS ({ln(nos)}):") fo o in nos[-5:]: # Show ls 5 piipn = slf.piipns.(o['piipni'], {}) on = piipn.('onizion', 'Unnown') pin(f" {o['isp'][:10]} - {on}") pin(f" {o['yp']}: {o['subj']}") pin(f" Ouo: {o['ouo']}") pin(f"\n  FILS:") pin(f" Piipns: {slf.bs}") pin(f" ouniions: {slf.ouniionlo}") pin(f" Piplin: {slf.piplin}") pin(f"\n NX PIOIIS:") pin(f" 1. opl o onfiions (NHS, Ipil)") pin(f" 2. Pp iosof pnship isussion") pin(f" 3. Sn o in ils") pin(f" 4. usoiz o onn fo h sssion") pin(f" 5. S up pos-o follow-up uoion") f in(): """ in  sys xuion """ pin(" Iniilizin L.I.F.. Plfo  nn Sys...") #   sys  = nnSys() #  spl ouniions fo o .loouniion( "LIF001", "il", "o Inviion - Oob 15", "Sn o inviion wih sssion ils", "onfi nn" ) .loouniion( "LIF003", "il", "Pnship isussion qus", "qus in o isuss si pnship", "Vy posiiv spons - shulin ll" ) # Shul follow-ups .shulfollowup("LIF004", "onfiion ll fo o", "2025-10-11", "Hih") .shulfollowup("LIF001", "Sn o in + pp ils", "2025-10-12", "iu") # n shbo .nshbo() # Sv ll  .sv() pin("\n  nn Sys Sup opl!") pin(" ll piipn  onsoli n .") pin(" ouniion hisoy n piplin y.") if n == "in": in()