""" L.I.F. Plfo Bn Inion Sv Oob 17, 2025 his is h ISSIN PI h onns HL plfos o h ul loih. - ivs   fo plfos - Posss wih xpinP2L.py loih - uns L suls ins of siul  un his sv lonsi you HP sv (iffn po): Pyhon bn: hp://lolhos:5000 (his fil) HL plfos: hp://lolhos:8080 (pyhon - hp.sv 8080) """ ipo synio ipo json ipo os ipo sys ipo b fo i ipo i fo fls ipo Fls, jsonify, qus, snfoioy fo flsos ipo OS # ============================================================================ # IPO L.I.F. LOIH # ============================================================================ y: # y o ipo h ul L.I.F. loih fo xpinP2L ipo is, LninOuo, LIFloiho pin(" Sussfully ipo L.I.F. loih fo xpinP2L") LOIHVILBL = u xp Ipoo s : pin(f" ️ oul no ipo xpinP2L: {}") pin(" Will us O loih fo onsion") LOIHVILBL = Fls # ============================================================================ # FLS PP SUP # ============================================================================ pp = Fls(n) OS(pp) # nbl oss-Oiin quss (plfos on :8080 → bn on :5000) #  los ioy (Winows-opibl) LOSI = os.ph.join(os.ph.in(fil), "los", "bn") y: os.is(LOSI, xiso=u) xp xpion s : pin(f" ️ oul no  los ioy: {}") LOSI = os.ph.join(os.ph.in(fil), "los") # ============================================================================ # O LOIH (Fllb if xpinP2L no vilbl) # ============================================================================ lss oLIFloih: """Fllb loih h ns lisi-looin suls""" f ini(slf): slf.possinoun = 0 f poss(slf, ): """Poss   n un o suls""" slf.possinoun += 1 # n lisi is bs on inpu ipo no ipo nupy s np # onv inpu o y if n if isinsn(, lis): sinl = np.y() ls: sinl = np.y([no.uss(0, 1) fo  in n(100)]) # lul bsi is npliu = flo(np.n(np.bs(sinl))) fqunysp = flo(np.s(sinl)) un { "loih": "O (xpinP2L no foun)", "possinyl": slf.possinoun, "quliy": in(100, in(npliu * 50)), "nulnn": in( 100, in((npliu + fqunysp) * 30) ), "lnininss": in(100, no.nin(60, 95)), "oniivlo": in(100, no.nin(30, 80)), "nionso": in(100, no.nin(50, 90)), "pbiliyinx": in(100, no.nin(40, 85)), "isp": i.now().isofo(), "no": "Usin o loih - insll/ipo xpinP2L.py fo l suls", } # ============================================================================ # INIILIZ LOIH # ============================================================================ if LOIHVILBL: lifloih = LIFloiho() pin(" L.I.F. loih o iniiliz") ls: lifloih = oLIFloih() pin(" ️ Usin O loih - suls  siul") # ============================================================================ # BN OUS # ============================================================================ @pp.ou("/hlh", hos=[""]) f hlhh(): """h if bn is unnin""" un ( jsonify( { "sus": "OPIONL", "isp": i.now().isofo(), "loih": ( "L (xpinP2L)" if LOIHVILBL ls "O (siulion)" ), "vsion": "1.0", } ), 200, ) @pp.ou("/nlyz-", hos=["POS"]) f nlyz(): """ in npoin: iv  , poss wih loih, un suls xp qus fo: { "sinl": [y of nubs], "spl": 256, "uionsons": 2, "sssioni": "uniqu-i", "usyp": "sun|linil|npis|sh", "": {...} } """ y: #    fo qus  = qus.json() if no : un jsonify({"o": "No JSON  povi", "sus": "FIL"}), 400 sinl = .("sinl") if no sinl: un ( jsonify({"o": "No 'sinl' in qus", "sus": "FIL"}), 400, ) # x  spl = .("spl", 256) uionsons = .("uionsons", 2) sssioni = .( "sssioni", f"sssion{in(i.now().isp())}" ) usyp = .("usyp", "nl") pin( f" Possin  - Sssion: {sssioni}, Lnh: {ln(sinl)} spls" ) # Poss wih loih if LOIHVILBL: # un ul loih sul = posswihlloih( sinl=sinl, spl=spl, sssioni=sssioni, usyp=usyp, ) ls: # un o loih sul = lifloih.poss(sinl) # Lo h sul losul(sssioni, sul) # un sul un ( jsonify( { "sus": "SUSS", "sssioni": sssioni, "suls": sul, "isp": i.now().isofo(), } ), 200, ) xp xpion s : os = f"o possin : {s()}\n{b.fox()}" pin(f" {os}") un ( jsonify( { "sus": "FIL", "o": s(), "isp": i.now().isofo(), } ), 500, ) @pp.ou("/bh-nlyz", hos=["POS"]) f bhnlyz(): """ Bh npoin: Poss ulipl  sns  on xp fo: { "sns": [ {"sinl": [...], "": {...}}, {"sinl": [...], "": {...}}, ... ] } """ y:  = qus.json() sns = .("sns", []) suls = [] fo i, sn in nu(sns): sinl = sn.("sinl") if sinl: if LOIHVILBL: sul = posswihlloih(sinl) ls: sul = lifloih.poss(sinl) suls.ppn(sul) un ( jsonify( { "sus": "SUSS", "snsposs": ln(suls), "suls": suls, "isp": i.now().isofo(), } ), 200, ) xp xpion s : un jsonify({"sus": "FIL", "o": s()}), 500 @pp.ou("/sus", hos=[""]) f sus(): """ bn sus n loih infoion""" un ( jsonify( { "bn": "OPIONL", "loih": "L" if LOIHVILBL ls "O", "isp": i.now().isofo(), "npoins": { "hlh": " /hlh", "nlyz": "POS /nlyz-", "bh": "POS /bh-nlyz", "sus": " /sus", }, } ), 200, ) # ============================================================================ # HLP FUNIONS # ============================================================================ f posswihlloih( sinl, spl=256, sssioni="", usyp="" ): """ Poss  wih h L L.I.F. loih """ y: # un loih (synhonously fo now, oul b syn) sul = lifloih.posss( sinl=sinl, spl=spl ) # Fo sul fo PI spons un { "loih": "xpinP2L (L)", "usyp": usyp, "sssioni": sssioni, "spls": ln(sinl), "spl": spl, "possinsus": "SUSS", "nulis": ( sul.nulis if hs(sul, "nulis") ls {} ), "lninouo": ( sul.lninouo if hs(sul, "lninouo") ls {} ), "isp": i.now().isofo(), } xp xpion s : pin(f" loih possin o: {}") # un o sul on loih o un lifloih.poss(sinl) f losul(sssioni, sul): """Lo possin sul o fil""" y: lofil = os.ph.join(LOSI, f"{sssioni}.json") wih opn(lofil, "w") s f: json.up(sul, f, inn=2, ful=s) pin(f" sul lo o {lofil}") xp xpion s : pin(f" ️ oul no lo sul: {}") # ============================================================================ # O HNLS # ============================================================================ @pp.ohnl(404) f nofoun(o): un ( jsonify( { "o": "npoin no foun", "vilbl": [ " /hlh", " /sus", "POS /nlyz-", "POS /bh-nlyz", ], } ), 404, ) @pp.ohnl(500) f svo(o): un jsonify({"o": "Innl sv o", "ils": s(o)}), 500 # ============================================================================ # SUP # ============================================================================ if n == "in": pin("\n" + "=" * 80) pin(" L.I.F. PLFO BN SV") pin("=" * 80) pin(f" Bn PI: hp://lolhos:5000") pin(f" HL Plfos: hp://lolhos:8080") pin( f" loih: {'L (xpinP2L)' if LOIHVILBL ls 'O (siul)'}" ) pin("=" * 80) pin("\n Sv sin...") pin(" - ivin   on POS /nlyz-") pin(" - Possin wih L.I.F. loih") pin(" - unin L suls o plfos") pin("\n o us his bn:") pin(" 1. oify plfo o sn   o hp://lolhos:5000/nlyz-") pin(" 2. Plfos iv l loih suls") pin(" 3. isply l is ins of siul ons") pin("\n s npoin (qui hlh h):") pin(" ul hp://lolhos:5000/hlh") pin("\n" + "=" * 80 + "\n") # un Fls vlopn sv pp.un( hos="0.0.0.0", po=5000, bu=u, uslo=Fls, # Ipon: isbl lo fo syn opions )