# us/bin/nv pyhon3 """ Qui inion xpl: PhysioN → L.I.F. Plfo ownlo l   n poss wih L.I.F.. loih un: pyhon physionlifinion.py """ ipo synio ipo json ipo loin ipo os fo ypin ipo i, Opionl lo = loin.Lo(n) syn f quio(): """o: Lo PhysioN  n poss wih L.I.F..""" pin("\n" + "=" * 80) pin(" L.I.F.. + PhysioN Inion o") pin("=" * 80) y: fo physionins ipo PhysioNInso pin("\n PhysioN Inso lo") xp Ipoo: pin("\n o: physionins oul no foun") pin("  su physionins.py is in h s ioy") un # Iniiliz inso inso = PhysioNInso() # vilbl ss pin("\n vilbl PhysioN ss:") pin(" 1. biiv2 - oo Iy  (22 hnnls, 250 Hz)") pin(" 2. slpf - Slp sin (2 hnnls, 100 Hz)") pin(" 3. ouplin - Bin-h syn (64 hnnls, 256 Hz)") pin(" 4. psizu - Sizu  (23 hnnls, 256 Hz)") pin(" 5. plunivsiysizu - UH  (21 hnnls, 250 Hz)") # ownlo xpl shoi = "biiv2" pin(f"\n ownloin {shoi}...") pin(" Subj: 1, Sssion: 1")  = wi inso.ownlos(shoi, subji=1, sssion=1) if no : pin(" ownlo fil") un pin(f" ownlo {ln() / (1024 * 1024):.2f} B") # Sv n ps ipo pfil pi = pfil.p() fph = os.ph.join(pi, "spl.f") wih opn(fph, "wb") s f: f.wi() pin(f"\n Psin F fil...") y,  = inso.psffil(fph) if y is Non: pin(" F psin fil (pyflib y no b insll)") pin(" Insll wih: pip insll pyflib") un pin(f" Lo {y.shp[0]} hnnls, {y.shp[1]} spls") pin(f" uion: {.('uions', 'N/')} sons") pin(f" Splin : {.('splin', 'N/')} Hz") # Poss fis hnnl pin(f"\n Possin  sinl (hnnl 1)...") suls = inso.posssinl(y[0], splin=250) # isply suls pin("\n Sinl Quliy ssssn:") quliy = suls["quliy"] pin(f" So: {quliy['so']:.1f}/100") pin(f" in: {quliy['in']}") pin(f" SN: {quliy['snb']:.2f} B") pin(f" P-o-P: {quliy['popuv']:.2f} µV") pin(f" Vin: {quliy['vin']:.2f}") pin("\n Fquny Bn nlysis:") fq = suls["fquny"] bns = ["l", "h", "lph", "b", ""] fo bn in bns: y = f"{bn}powpn" if y in fq: pin(f" {bn.upp():6s}: {fq[y]:6.2f}%") pin("\n if ion:") ifs = suls["ifs"] pin(f" y Blins: {ifs['blinvns']} vns") pin(f" Blin Pn: {ifs['blinpn']:.2f}%") pin(f" usl if Pow: {ifs['uslifpow']:.4f}") pin( f" Lin Nois (50/60 Hz): {'' if ifs['linnoispsn'] ls 'l'}" ) # Suy pin("\n" + "=" * 80) pin(" Inion opl!") pin("=" * 80) pin("\n Nx Sps:") pin(" 1. Poss ll hnnls: fo i in n(y.shp[0]): ...") pin(" 2. xpo suls: onv.nupyosv(y, 'suls.sv')") pin(" 3. Uplo o L.I.F.. plfo shbos") pin(" 4. un L.I.F. loih: lif.posss(y)") # lnup ipo shuil shuil.(pi) pin("\n poy fils ln up") syn f bhposssubjs(): """Poss ulipl subjs fo  s""" fo physionins ipo PhysioNInso pin("\n" + "=" * 80) pin(" Bh Possin xpl: BI IV-2 (ll 9 Subjs)") pin("=" * 80) inso = PhysioNInso() suls = [] fo subji in n(1, 10): # 9 subjs pin(f"\n Possin Subj {subji}...") y:  = wi inso.ownlos( "biiv2", subji=subji, sssion=1 ) if : ipo shuil ipo pfil pi = pfil.p() fph = os.ph.join(pi, f"S{subji:03}.f") wih opn(fph, "wb") s f: f.wi() y,  = inso.psffil(fph) if y is no Non: possin = inso.posssinl( y[0], splin=250 ) sul = { "subj": subji, "quliyso": possin["quliy"]["so"], "quliyin": possin["quliy"]["in"], "snb": possin["quliy"]["snb"], } suls.ppn(sul) pin(f" Quliy: {sul['quliyso']:.1f}/100") shuil.(pi) xp xpion s : pin(f" o: {}") # Suy bl if suls: pin("\n Bh Possin suls:") pin( f"\n{'Subj':<10} {'Quliy So':<15} {'in':<10} {'SN (B)':<10}" ) pin("-" * 45) fo  in suls: pin( f"{['subj']:<10} {['quliyso']:<15.1f} " f"{['quliyin']:<10} {['snb']:<10.2f}" ) vquliy = su(["quliyso"] fo  in suls) / ln(suls) pin(f"\nv Quliy So: {vquliy:.1f}/100 ") f xpoxpl(): """xpl: xpo  o iffn fos""" pin("\n" + "=" * 80) pin("  xpo xpls") pin("=" * 80) y: ipo nupy s np fo physionins ipo Foonv #  spl  spl = np.no.nn(22, 1000) # 22 hnnls, 1000 spls onv = Foonv() # xpo o SV pin("\n xpoin o SV...") svph = "xpo.sv" hnnlns = [ "Fp1", "Fp2", "F3", "F4", "3", "4", "P3", "P4", "O1", "O2", "F7", "F8", "3", "4", "5", "6", "Fz", "z", "Pz", "Oz", "1", "2", ] onv.nupyosv(spl, svph, hnnlns) pin(f" Sv o {svph}") # xpo o NPY pin("\n xpoin o NPY (NuPy biny)...") npyph = "xpo.npy" onv.nupyonpy(spl, npyph) pin(f" Sv o {npyph}") # Lo fo SV pin("\n Loin fo SV...") lo = onv.svonupy(svph, siph=1) pin(f" Lo shp: {lo.shp}") pin("\n xpo/Ipo yl opl!") xp Ipoo s : pin(f"o: {}") if n == "in": pin("\n" + "=" * 80) pin(" L.I.F. Plfo + PhysioN Inion xpls") pin("=" * 80) pin("\n hoos n opion:") pin(" 1. Qui o (sinl subj)") pin(" 2. Bh poss ll 9 subjs") pin(" 3.  xpo xpls") pin(" 4. un ll xpls") y: hoi = inpu("\nn hoi (1-4): ").sip() xp yboInup: pin("\n\nbo by us") xi(1) if hoi == "1": synio.un(quio()) lif hoi == "2": synio.un(bhposssubjs()) lif hoi == "3": xpoxpl() lif hoi == "4": synio.un(quio()) synio.un(bhposssubjs()) xpoxpl() ls: pin("Invli hoi")