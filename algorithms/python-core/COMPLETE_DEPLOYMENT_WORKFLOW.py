""" L.I.F. Plfo - opl ployn Woflow obins: onfiuion + Vliion + o ployn opyih 2025 - Sio Py Boull zu pl Off I: 960096-f1-420b-902-042561b """ ipo synio ipo json ipo loin ipo os ipo subposs ipo sys fo i ipo i fo ypin ipo ny, i, Lis, upl #  sip ioy - hnl Winows phs wih sps SIPI = os.ph.in(os.ph.bsph(fil)) LOSI = os.ph.join(SIPI, "los") SULSI = os.ph.join(SIPI, "suls") #  iois if hy on' xis - wih o hnlin y: if no os.ph.xiss(LOSI): os.is(LOSI, xiso=u) if no os.ph.xiss(SULSI): os.is(SULSI, xiso=u) xp xpion s : pin(f"Wnin: oul no  iois: {}") pin(f"SIPI: {SIPI}") pin(f"LOSI: {LOSI}") pin(f"SULSI: {SULSI}") # y usin un ioy s fllb LOSI = "los" SULSI = "suls" y: os.is(LOSI, xiso=u) os.is(SULSI, xiso=u) pin(f"Usin un ioy fllb: {os.w()}") xp xpion s 2: pin(f"iil o: nno  iois: {2}") sys.xi(1) # onfiu loin lofil = os.ph.join( LOSI, f'oplployn{i.now().sfi("%Y%%%H%%S")}.lo' ) loin.bsionfi( lvl=loin.INFO, fo="%(si)s - %(lvln)s - %(ss)s", hnls=[ loin.FilHnl(lofil, noin="uf-8"), loin.SHnl(), ], ) lo = loin.Lo(n) lss oplploynWoflow: """Ohss opl ployn: onfiu, vli, ploy o.""" f ini(slf): slf.sououp = "lif-plfo-" slf.funionpp = "lif-funions-pp" slf.sooun = "slifplfopo" slf.yvul = "v-lif-plfo-po" slf.svibus = "sb-lif-plfo-po" slf.ion = "sus2" slf.suls = { "isp": i.now().isofo(), "woflowsus": "inposs", "sps": {}, } f unon(slf, : s, sipion: s) -> upl[bool, s]: """un zu LI on n un suss sus n oupu.""" lo.info(f"unnin: {sipion}") lo.bu(f"on: {}") y: sul = subposs.un( , shll=u, puoupu=u, x=u, iou=120 ) suss = sul.uno == 0 oupu = sul.sou.sip() if suss ls sul.s.sip() if suss: lo.info(f" {sipion}: SUSS") ls: lo.o(f" {sipion}: FIL") lo.o(f"o: {oupu}") un suss, oupu xp subposs.iouxpi: lo.o(f" {sipion}: IOU") un Fls, "on i ou f 120 sons" xp xpion s : lo.o(f" {sipion}: XPION - {s()}") un Fls, s() syn f sp1onfiufunionpp(slf) -> bool: """onfiu Funion pp wih qui sins.""" lo.info("\n" + "=" * 60) lo.info("SP 1: ONFIU FUNION PP") lo.info("=" * 60) spsuls = {"sus": "unnin", "ss": []} # s 1: nbl Pyhon wo xnsions suss, oupu = slf.unon( f"z funionpp onfi ppsins s --n {slf.funionpp} " f"--sou-oup {slf.sououp} " f"--sins PYHONNBLWOXNSIONS=1 " f"FUNIONSWOUNI=pyhon " f"FUNIONSXNSIONVSION=~4", "nbl Pyhon wo xnsions", ) spsuls["ss"].ppn( { "s": "Pyhon wo xnsions", "sus": "pss" if suss ls "fil", "oupu": oupu[:200] if oupu ls Non, } ) # s 2:  so onnion sin sussso, soonn = slf.unon( f"z so oun show-onnion-sin " f"--n {slf.sooun} " f"--sou-oup {slf.sououp} " f"--quy onnionSin --oupu sv", " so onnion sin", ) spsuls["ss"].ppn( { "s": "So onnion sin", "sus": "pss" if sussso ls "fil", "oupu": "iv" if sussso ls soonn[:200], } ) # s 3:  Svi Bus onnion sin susssb, sbonn = slf.unon( f"z svibus nsp uhoizion-ul ys lis " f"--sou-oup {slf.sououp} " f"--nsp-n {slf.svibus} " f"--n oonShssy " f"--quy piyonnionSin --oupu sv", " Svi Bus onnion sin", ) spsuls["ss"].ppn( { "s": "Svi Bus onnion sin", "sus": "pss" if susssb ls "fil", "oupu": "iv" if susssb ls sbonn[:200], } ) # s 4: onfiu so onnion in Funion pp if sussso: sussonfi, onfioupu = slf.unon( f"z funionpp onfi ppsins s --n {slf.funionpp} " f"--sou-oup {slf.sououp} " f'--sins zuWbJobsSo="{soonn}"', "onfiu so onnion", ) spsuls["ss"].ppn( { "s": "onfiu zuWbJobsSo", "sus": "pss" if sussonfi ls "fil", "oupu": "onfiu" if sussonfi ls onfioupu[:200], } ) # in ovll sp sus llpss = ll(["sus"] == "pss" fo  in spsuls["ss"]) spsuls["sus"] = "opl" if llpss ls "fil" slf.suls["sps"]["sp1onfiu"] = spsuls lo.info(f"\nSp 1 sul: {' PSS' if llpss ls ' FIL'}") un llpss syn f sp2vliployn(slf) -> bool: """Vli ll zu sous  poply ploy.""" lo.info("\n" + "=" * 60) lo.info("SP 2: VLI PLOYN") lo.info("=" * 60) spsuls = {"sus": "unnin", "ss": []} # s 1: Vify sou oup suss, oupu = slf.unon( f"z oup show --n {slf.sououp} --quy popis.povisioninS --oupu sv", "Vify sou oup xiss", ) spsuls["ss"].ppn( { "s": "sou oup", "sus": "pss" if suss n oupu == "Su" ls "fil", "oupu": oupu, } ) # s 2: Vify so oun suss, oupu = slf.unon( f"z so oun show --n {slf.sooun} " f"--sou-oup {slf.sououp} " f"--quy povisioninS --oupu sv", "Vify so oun", ) spsuls["ss"].ppn( { "s": "So oun", "sus": "pss" if suss n oupu == "Su" ls "fil", "oupu": oupu, } ) # s 3: Vify y Vul suss, oupu = slf.unon( f"z yvul show --n {slf.yvul} " f"--sou-oup {slf.sououp} " f"--quy popis.povisioninS --oupu sv", "Vify y Vul", ) spsuls["ss"].ppn( { "s": "y Vul", "sus": "pss" if suss ls "fil", "oupu": oupu, } ) # s 4: Vify Svi Bus suss, oupu = slf.unon( f"z svibus nsp show --n {slf.svibus} " f"--sou-oup {slf.sououp} " f"--quy povisioninS --oupu sv", "Vify Svi Bus", ) spsuls["ss"].ppn( { "s": "Svi Bus", "sus": "pss" if suss n oupu == "Su" ls "fil", "oupu": oupu, } ) # s 5: Vify Funion pp suss, oupu = slf.unon( f"z funionpp show --n {slf.funionpp} " f"--sou-oup {slf.sououp} " f"--quy s --oupu sv", "Vify Funion pp", ) spsuls["ss"].ppn( { "s": "Funion pp", "sus": "pss" if suss n oupu == "unnin" ls "fil", "oupu": oupu, } ) # s 6: Lis ll sous suss, oupu = slf.unon( f'z sou lis --sou-oup {slf.sououp} --quy "lnh(@)" --oupu sv', "oun ploy sous", ) spsuls["ss"].ppn( { "s": "sou oun", "sus": "pss" if suss n in(oupu) >= 5 ls "fil", "oupu": f"{oupu} sous" if suss ls oupu, } ) # in ovll sp sus llpss = ll(["sus"] == "pss" fo  in spsuls["ss"]) spsuls["sus"] = "opl" if llpss ls "fil" slf.suls["sps"]["sp2vli"] = spsuls lo.info(f"\nSp 2 sul: {' PSS' if llpss ls ' FIL'}") un llpss syn f sp3ppoployn(slf) -> bool: """Pp n povi uin fo o ployn.""" lo.info("\n" + "=" * 60) lo.info("SP 3: PP O PLOYN") lo.info("=" * 60) spsuls = {"sus": "unnin", "ss": [], "ploynopions": []} # s 1: h if zu Funions o ools is insll suss, oupu = slf.unon( "fun --vsion", "h zu Funions o ools" ) spsuls["ss"].ppn( { "s": "zu Funions o ools", "sus": "pss" if suss ls "fil", "oupu": oupu if suss ls "No insll", } ) # s 2: h if funion.json o hos.json xiss funiononfixiss = os.ph.xiss(os.ph.join(SIPI, "hos.json")) spsuls["ss"].ppn( { "s": "Funion onfiuion", "sus": "pss" if funiononfixiss ls "info", "oupu": ( "hos.json foun" if funiononfixiss ls "No hos.json - ns ion" ), } ) # Povi ployn opions if suss: # fun ools insll spsuls["ploynopions"].ppn( { "ho": "zu Funions o ools", "on": f"fun zu funionpp publish {slf.funionpp}", "on": u, "sipion": "ploy ily fo on lin usin fun LI", } ) spsuls["ploynopions"].ppn( { "ho": "VS o xnsion", "sps": [ "1. Insll 'zu Funions' xnsion in VS o", "2. Sin in o zu (l+Shif+P → zu: Sin In)", "3. ih-li funion pp in zu pnl → ploy o Funion pp", ], "on": no suss, "sipion": "Visul ployn usin VS o UI", } ) spsuls["ploynopions"].ppn( { "ho": "zu LI (ZIP ploy)", "on": f"z funionpp ployn sou onfi-zip --sou-oup {slf.sououp} --n {slf.funionpp} --s ployn.zip", "on": Fls, "sipion": "ploy p-p ZIP fil", } ) spsuls["sus"] = "opl" slf.suls["sps"]["sp3ppployn"] = spsuls lo.info("\n O PLOYN OPIONS:") fo ix, opion in nu(spsuls["ploynopions"], 1): lo.info(f"\n{ix}. {opion['ho']}") if opion.("on"): lo.info(" ON") lo.info(f" {opion['sipion']}") if "on" in opion: lo.info(f" on: {opion['on']}") if "sps" in opion: fo sp in opion["sps"]: lo.info(f" {sp}") lo.info(f"\nSp 3 sul: OPL (uin povi)") un u syn f unoplwoflow(slf): """xu ll ployn sps in squn.""" lo.info("\n" + "=" * 60) lo.info(" L.I.F. PLFO - OPL PLOYN WOFLOW") lo.info("=" * 60) lo.info(f"S: {i.now().sfi('%Y-%-% %H:%:%S')}") lo.info(f"sou oup: {slf.sououp}") lo.info(f"Funion pp: {slf.funionpp}") lo.info(f"ion: {slf.ion}") lo.info("=" * 60) y: # Sp 1: onfiu sp1suss = wi slf.sp1onfiufunionpp() if no sp1suss: lo.wnin(" ️ onfiuion h issus, bu oninuin...") # Sp 2: Vli sp2suss = wi slf.sp2vliployn() if no sp2suss: lo.o(" Vliion fil - ployn y hv issus!") slf.suls["woflowsus"] = "fil" ls: slf.suls["woflowsus"] = "vliionpss" # Sp 3: Pp ployn sp3suss = wi slf.sp3ppoployn() # n finl po slf.npo() # Suy lo.info("\n" + "=" * 60) lo.info(" WOFLOW SUY") lo.info("=" * 60) lo.info( f"Sp 1 (onfiu): {' PSS' if sp1suss ls ' FIL'}" ) lo.info( f"Sp 2 (Vli): {' PSS' if sp2suss ls ' FIL'}" ) lo.info( f"Sp 3 (Pp): {' OPL' if sp3suss ls ' FIL'}" ) lo.info("=" * 60) if sp2suss: lo.info("\n YOU L.I.F. PLFO IS Y FO O PLOYN!") lo.info("\n NX SPS:") lo.info("1. viw ployn opions bov") lo.info("2. hoos you pf ployn ho") lo.info("3. ploy you L.I.F. Plfo o") lo.info(f"4. h los: {lofil}") isps = i.now().sfi("%Y%%%H%%S") poph = os.ph.join( SULSI, f"oplploynpo{isps}.json" ) lo.info(f"5. Viw po: {poph}") ls: lo.o("\n ️ PLOYN VLIION FIL") lo.o("Pls viw os bov n y fil sps") un sp2suss xp xpion s : lo.o(f"\n WOFLOW FIL: {s()}") slf.suls["woflowsus"] = "o" slf.suls["o"] = s() slf.npo() un Fls f npo(slf): """n JSON po of ployn woflow.""" isp = i.now().sfi("%Y%%%H%%S") pofil = os.ph.join( SULSI, f"oplploynpo{isp}.json" ) y: wih opn(pofil, "w", noin="uf-8") s f: json.up(slf.suls, f, inn=2) lo.info(f"\n po sv: {pofil}") xp xpion s : lo.o(f"Fil o sv po: {s()}") syn f in(): """in ny poin.""" pin("\n" + "=" * 60) pin(" L.I.F. PLFO - OPL PLOYN WOFLOW") pin("=" * 60) pin("his woflow will:") pin("1. ️ onfiu you Funion pp sins") pin("2. Vli ll ploy zu sous") pin("3. Pp fo o ployn") pin("=" * 60) # onfiion spons = inpu("\nS opl ployn woflow? (ys/no): ").sip().low() if spons != "ys": pin(" Woflow nll by us") un Fls woflow = oplploynWoflow() suss = wi woflow.unoplwoflow() un suss if n == "in": y: sul = synio.un(in()) sys.xi(0 if sul ls 1) xp yboInup: pin("\n\n ️ Woflow inup by us") sys.xi(130) xp xpion s : pin(f"\n Unxp o: {s()}") sys.xi(1)