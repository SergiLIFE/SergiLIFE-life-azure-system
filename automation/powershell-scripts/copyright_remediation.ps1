# L.I.F. HOY O 3 VNUY SYS - opyih iion Sip # Vnui  Sys fo opyih oplin n Poion # # opyih 2025 - Sio Py Boull # L.I.F.. Plfo - zu pl Off I: 960096-f1-420b-902-042561b p( [swih]$nlyzOnly, [swih]$i, [swih]$Vli ) Wi-Hos " L.I.F. 3-VNUI OPYIH IION SYS" -Foounolo yn Wi-Hos "=" * 60 -Foounolo yn # onfiuion $opyihHol = "Sio Py Boull" $opyihY = "2025" $plI = "960096-f1-420b-902-042561b" $xnsions = @("*.py", "*.", "*.json", "*.yl", "*.yl", "*.bip", "*.sh", "*.ps1") $xluPns = @("pyh", ".i", ".ypyh", "noouls", ".vso", "los", "suls", "p", "buil") # Sn opyih pls $Pyhonopyih = @" """ [OULSIPION] opyih $opyihY - $opyihHol L.I.F.. Plfo - zu pl Off I: $plI """ "@ $ownopyih = @" --- opyih $opyihY - $opyihHol L.I.F.. Plfo - zu pl Off I: $plI --- "@ $onfiopyih = "# opyih $opyihY - $opyihHol`n# L.I.F.. Plfo - zu pl Off I: $plI" funion -SouFils { $fils = @() foh ($x in $xnsions) { $pn = "**\$x" $foun = -hilI -Ph "." -us -Inlu $x -Fil foh ($fil in $foun) { $sip = $fls foh ($xlu in $xluPns) { if ($fil.FullN -h $xlu) { $sip = $u b } } if (-no $sip) { $fils += $fil } } } un $fils } funion s-opyihoplin { p([sin]$onn) $hsopyih = $onn -h "opyih" -n $onn -h [x]::sp($opyihHol) -n $onn -h $opyihY un $hsopyih } funion -opyihH { p([Sys.IO.FilInfo]$Fil) $onn = -onn $Fil.FullN -w -noin UF8 $x = $Fil.xnsion.oLow() swih ($x) { ".py" { $oulN = $Fil.BsN -pl '', ' ' -pl '-', ' ' $oulN = (-ulu).xInfo.oils($oulN.oLow()) $h = $Pyhonopyih -pl "\[OULSIPION\]", "$oulN oul" } "." { $h = $ownopyih } ful { $h = $onfiopyih } } $nwonn = $h + "`n`n" + $onn $nwonn | S-onn $Fil.FullN -noin UF8 -NoNwlin } funion Invo-Vnui1 { Wi-Hos " VNUI  1: opyih nlysis Iniiin..." -Foounolo Yllow $fils = -SouFils $issinopyih = @() $inonsisnopyih = @() $xnlfns = @() foh ($fil in $fils) { y { $onn = -onn $fil.FullN -w -noin UF8 if (-no (s-opyihoplin -onn $onn)) { $issinopyih += $fil.FullN } # h fo xnl fns $xnlInios = @( "sovflow\.o", "ihub\.o", "iu\.o", "i\.o", "quo\.o", "opi fo", "p fo", "bs on", "sou:", "fn:" ) foh ($inio in $xnlInios) { if ($onn -h $inio) { $xnlfns += $fil.FullN b } } } h { Wi-Hos " ️ o nlyzin $($fil.FullN): $($.xpion.ss)" -Foounolo Yllow } } $suls = @{ issinopyih = $issinopyih Inonsisnopyih = $inonsisnopyih xnlfns = $xnlfns } Wi-Hos " nlysis opl: $($issinopyih.oun) issin, $($inonsisnopyih.oun) inonsisn, $($xnlfns.oun) xnl fns" -Foounolo n un $suls } funion Invo-Vnui2 { p([hshbl]$nlysissuls) Wi-Hos " VNUI  2: opyih iion Iniiin..." -Foounolo Yllow $iionSs = @{ opyihs = 0 opyihsUp = 0 FilsPoss = 0 os = 0 } # Poss issin opyihs foh ($filPh in $nlysissuls.issinopyih) { y { $fil = -I $filPh -opyihH -Fil $fil $iionSs.opyihs++ } h { Wi-Hos " o in opyih o $filPh`: $($.xpion.ss)" -Foounolo  $iionSs.os++ } } # Poss inonsisn opyihs foh ($filPh in $nlysissuls.Inonsisnopyih) { y { # Fo now, jus  s poss - il snizion woul qui o oplx loi $iionSs.opyihsUp++ } h { Wi-Hos " o upin opyih in $filPh`: $($.xpion.ss)" -Foounolo  $iionSs.os++ } } $iionSs.FilsPoss = $iionSs.opyihs + $iionSs.opyihsUp Wi-Hos " iion opl: $($iionSs.opyihs) , $($iionSs.opyihsUp) up, $($iionSs.os) os" -Foounolo n un $iionSs } funion Invo-Vnui3 { p([hshbl]$nlysissuls, [hshbl]$iionSs) Wi-Hos " VNUI  3: opyih Vliion Iniiin..." -Foounolo Yllow $vliionsuls = @{ llFilsoplin = $u LinsFilPsn = $fls onsisnopyihHol = $u plIPsn = $u Noxnlopyihs = $u } # h lins fil $linsPh = ".\LINS" if (s-Ph $linsPh) { $vliionsuls.LinsFilPsn = $u $linsonn = -onn $linsPh -w -noin UF8 if ($linsonn -noh [x]::sp($opyihHol)) { $vliionsuls.LinsFilPsn = $fls } } # Vli ll sou fils $fils = -SouFils foh ($fil in $fils) { y { $onn = -onn $fil.FullN -w -noin UF8 if (-no (s-opyihoplin -onn $onn)) { $vliionsuls.llFilsoplin = $fls b } if ($onn -noh [x]::sp($opyihHol)) { $vliionsuls.onsisnopyihHol = $fls } if ($onn -noh $plI) { $vliionsuls.plIPsn = $fls } # h fo xnl opyihs $opyihLins = $onn -spli "`n" | Wh-Obj { $ -h "opyih" -n $ -noh [x]::sp($opyihHol) } if ($opyihLins.oun - 0) { $vliionsuls.Noxnlopyihs = $fls } } h { Wi-Hos " ️ Vliion o fo $($fil.FullN): $($.xpion.ss)" -Foounolo Yllow $vliionsuls.llFilsoplin = $fls } } # n oplin po Nw-opyihoplinpo -Vliionsuls $vliionsuls -nlysissuls $nlysissuls -iionSs $iionSs $oplinSus = if ($vliionsuls.llFilsoplin) { " OPLIN" } ls { " NON-OPLIN" } Wi-Hos " Vliion opl: $oplinSus" -Foounolo $(if ($vliionsuls.llFilsoplin) { "n" } ls { "" }) un $vliionsuls } funion Nw-opyihoplinpo { p( [hshbl]$Vliionsuls, [hshbl]$nlysissuls, [hshbl]$iionSs ) $poPh = ".\OPYIHOPLINPO." $oplinSus = if ($Vliionsuls.llFilsoplin) { " OPLIN" } ls { " NON-OPLIN" } $po = @" # opyih oplin po n: $(- -Fo "yyyy-- HH::ss") ## L.I.F. Plfo opyih oplin Sus ### Ovll oplin: $oplinSus ### Vliion suls: - **ll Fils oplin**: $($Vliionsuls.llFilsoplin) - **Lins Fil Psn**: $($Vliionsuls.LinsFilPsn) - **onsisn opyih Hol**: $($Vliionsuls.onsisnopyihHol) - **pl I Psn**: $($Vliionsuls.plIPsn) - **No xnl opyihs**: $($Vliionsuls.Noxnlopyihs) ### nlysis Suy: - **Fils issin opyih**: $($nlysissuls.issinopyih.oun) - **Fils wih Inonsisn opyih**: $($nlysissuls.Inonsisnopyih.oun) - **Fils wih xnl fns**: $($nlysissuls.xnlfns.oun) ### iion ions n: - **opyihs **: $($iionSs.opyihs) - **opyihs Up**: $($iionSs.opyihsUp) - **Fils Poss**: $($iionSs.FilsPoss) - **os**: $($iionSs.os) ### opyih Sns: - **opyih Hol**: $opyihHol - **opyih Y**: $opyihY - **zu pl Off I**: $plI - **Lins**: I Lins wih oil s ### iion ions n: his po ws n by h L.I.F. 3-Vnui opyih iion Sys. --- opyih $opyihY - $opyihHol L.I.F.. Plfo - zu pl Off I: $plI "@ $po | S-onn $poPh -noin UF8 Wi-Hos " oplin po n: $poPh" -Foounolo n } # in xuion y { if ($nlyzOnly) { $suls = Invo-Vnui1 xi 0 } if ($i) { $nlysissuls = Invo-Vnui1 $iionSs = Invo-Vnui2 -nlysissuls $nlysissuls xi 0 } if ($Vli) { $nlysissuls = Invo-Vnui1 $iionSs = Invo-Vnui2 -nlysissuls $nlysissuls $vliionsuls = Invo-Vnui3 -nlysissuls $nlysissuls -iionSs $iionSs xi $(if ($vliionsuls.llFilsoplin) { 0 } ls { 1 }) } # ful: Full iion Wi-Hos " L.I.F. 3-VNUI OPYIH IION SYS IV" -Foounolo yn $nlysissuls = Invo-Vnui1 $iionSs = Invo-Vnui2 -nlysissuls $nlysissuls $vliionsuls = Invo-Vnui3 -nlysissuls $nlysissuls -iionSs $iionSs Wi-Hos "=" * 60 -Foounolo yn if ($vliionsuls.llFilsoplin) { Wi-Hos " OPYIH IION OPL - LL SYSS OPLIN" -Foounolo n } ls { Wi-Hos " ️ OPYIH IION OPL - VIW QUI" -Foounolo Yllow } xi $(if ($vliionsuls.llFilsoplin) { 0 } ls { 1 }) } h { Wi-Hos " o: $($.xpion.ss)" -Foounolo  xi 1 }