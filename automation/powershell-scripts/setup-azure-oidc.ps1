# zu OI Sup Sip fo iHub ions # un his sip in PowShll wih zu LI insll p( [P(noy = $fls)] [sin]$ppN = "iHub-SiLIF-lif-zu-sys", [P(noy = $fls)] [sin]$poOwn = "SiLIF", [P(noy = $fls)] [sin]$poN = "SiLIF-lif-zu-sys" ) Wi-Hos " Sin up zu OI uhniion fo iHub ions..." -Foounolo n # h if us is lo in o zu Wi-Hos " hin zu loin sus..." -Foounolo Yllow y { $oun = z oun show --quy "us.n" -o sv 2>$null if ($LSXIO -n 0) { Wi-Hos " Pls loin o zu fis: z loin" -Foounolo  xi 1 } Wi-Hos " Lo in s: $oun" -Foounolo n } h { Wi-Hos " Pls insll zu LI n loin: z loin" -Foounolo  xi 1 } #  un subsipion info $subsipionI = z oun show --quy "i" -o sv $nnI = z oun show --quy "nnI" -o sv $subsipionN = z oun show --quy "n" -o sv Wi-Hos " un zu onx:" -Foounolo Yllow Wi-Hos " Subsipion: $subsipionN ($subsipionI)" -Foounolo yn Wi-Hos " nn: $nnI" -Foounolo yn #  zu  ppliion Wi-Hos " in zu  ppliion: $ppN..." -Foounolo Yllow $ppOupu = z  pp  --isply-n $ppN --sin-in-uin "zuyO" 2>$null if ($LSXIO -n 0) { Wi-Hos " ️ pp ih ly xis, yin o  xisin pp..." -Foounolo Yllow $ppOupu = z  pp lis --isply-n $ppN --quy "[0]" 2>$null } $ppI = ($ppOupu | onvFo-Json).ppI Wi-Hos " ppliion I (lin I): $ppI" -Foounolo n #  svi pinipl Wi-Hos " in svi pinipl..." -Foounolo Yllow $spOupu = z  sp  --i $ppI 2>$null if ($LSXIO -n 0) { Wi-Hos " ️ Svi pinipl ih ly xis" -Foounolo Yllow } # ssin onibuo ol Wi-Hos " ssinin onibuo ol o svi pinipl..." -Foounolo Yllow $olssinn = z ol ssinn  --ssin $ppI --ol "onibuo" --sop "/subsipions/$subsipionI" 2>$null if ($LSXIO -n 0) { Wi-Hos " ️ ol ssinn ih ly xis" -Foounolo Yllow } #  f nils Wi-Hos " in f nils fo iHub..." -Foounolo Yllow # in bnh nil $innil = @{ n = "ihub-in" issu = "hps://on.ions.ihubusonn.o" subj = "po:$poOwn/${poN}:f:fs/hs/in" sipion = "iHub ions fo in bnh" uins = @("pi://zuonxhn") } | onvo-Json -ph 3 $pFil1 = [Sys.IO.Ph]::pFilN() $innil | Ou-Fil -FilPh $pFil1 -noin uf8 z  pp f-nil  --i $ppI --ps $pFil1 2>$null ov-I $pFil1 # Pull qus nil $pnil = @{ n = "ihub-p" issu = "hps://on.ions.ihubusonn.o" subj = "po:$poOwn/${poN}:pullqus" sipion = "iHub ions fo pull quss" uins = @("pi://zuonxhn") } | onvo-Json -ph 3 $pFil2 = [Sys.IO.Ph]::pFilN() $pnil | Ou-Fil -FilPh $pFil2 -noin uf8 z  pp f-nil  --i $ppI --ps $pFil2 2>$null ov-I $pFil2 Wi-Hos " F nils  sussfully!" -Foounolo n # Oupu suy Wi-Hos "`n Sup opl! Pls  hs vibls o you iHub posioy:" -Foounolo n Wi-Hos " o o: hps://ihub.o/$poOwn/$poN/sins/vibls/ions" -Foounolo yn Wi-Hos "`n posioy Vibls o :" -Foounolo Yllow Wi-Hos " ZULINI: $ppI" -Foounolo Whi Wi-Hos " ZUNNI: $nnI" -Foounolo Whi Wi-Hos " ZUSUBSIPIONI: $subsipionI" -Foounolo Whi Wi-Hos "`n Usful lins:" -Foounolo Yllow Wi-Hos " iHub Vibls: hps://ihub.o/$poOwn/$poN/sins/vibls/ions" -Foounolo yn Wi-Hos " iHub ions: hps://ihub.o/$poOwn/$poN/ions" -Foounolo yn Wi-Hos " zu Pol: hps://pol.zu.o" -Foounolo yn Wi-Hos "`n You iHub ions woflow is now y o us OI uhniion!" -Foounolo n