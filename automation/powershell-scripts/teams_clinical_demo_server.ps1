# L.I.F.. Plfo - linil shbo o Sv # Oob 15, 2025 Univsiy s o # opibl wih 23 ollus shin # P oplin Lol Hosin p( [in]$Po = 8080, [sin]$shboFil = "LIFLINILSHBO.hl", [swih]$uoOpn = $u ) Wi-Hos "=======================================" -Foounolo yn Wi-Hos "L.I.F.. PLFO LINIL O SV" -Foounolo Yllow Wi-Hos "Oob 15, 2025 Univsiy Psnion" -Foounolo n Wi-Hos "=======================================" -Foounolo yn Wi-Hos "" #  un ioy n shbo ph $uni = -Loion $shboPh = Join-Ph $uni $shboFil # h if shbo fil xiss if (-no (s-Ph $shboPh)) { Wi-Hos " O: shbo fil '$shboFil' no foun!" -Foounolo  Wi-Hos "xp loion: $shboPh" -Foounolo Yllow Wi-Hos "" Wi-Hos "vilbl HL fils:" -Foounolo yn -hilI -Ph $uni -Fil "*.hl" | Foh-Obj { Wi-Hos " • $($.N)" -Foounolo Whi } xi 1 } # isply onfiuion Wi-Hos " linil shbo: $shboFil" -Foounolo n Wi-Hos " Sv Po: $Po" -Foounolo n Wi-Hos " shbo Ph: $shboPh" -Foounolo n Wi-Hos " s opibl: Ys (23 ollus y)" -Foounolo n Wi-Hos " P oplin: Lol hosin only" -Foounolo n Wi-Hos "" #  nwo infoion $LolIP = (-NIPss -ssFily IPv4 | Wh-Obj {$.Inflis -noli "*Loopb*" -n $.IPss -noli "169.254*"} | Sl-Obj -Fis 1).IPss $LolUL = "hp://lolhos:$Po" $NwoUL = "hp://${LolIP}:$Po" Wi-Hos " SS LINS FO S O:" -Foounolo Yllow Wi-Hos "Lol ss: $LolUL" -Foounolo Whi Wi-Hos "Nwo ss: $NwoUL" -Foounolo Whi Wi-Hos "" # s shin insuions Wi-Hos " S SHIN INSUIONS:" -Foounolo n Wi-Hos "1. Sh you sn in s in" -Foounolo Whi Wi-Hos "2. Nvi o: $LolUL" -Foounolo Whi Wi-Hos "3. opy his ss o h:" -Foounolo Whi Wi-Hos "" Wi-Hos " L.I.F.. Plfo linil o is LIV!" -Foounolo n Wi-Hos " l-i  nlysis wih PhysioN " -Foounolo n Wi-Hos " I linil ssisn y fo qusions" -Foounolo n Wi-Hos " F-oplin nuoplsiiy ssssn" -Foounolo n Wi-Hos "" #  sipl HP sv y { Wi-Hos " Sin linil o Sv..." -Foounolo Yllow #  HpLisn $lisn = Nw-Obj Sys.N.HpLisn $lisn.Pfixs.("hp://lolhos:$Po/") $lisn.Pfixs.("hp://$LolIP:$Po/") $lisn.S() Wi-Hos " Sv s sussfully!" -Foounolo n Wi-Hos "" Wi-Hos " O SUS: y fo Oob 15h psnion" -Foounolo Yllow Wi-Hos " un i: $(- -Fo 'yyyy-- HH::ss')" -Foounolo yn Wi-Hos "" Wi-Hos "Pss l+ o sop h sv..." -Foounolo y # uo-opn bows if qus if ($uoOpn) { Wi-Hos " Opnin shbo in ful bows..." -Foounolo n S-Poss $LolUL } # Sv loop whil ($lisn.IsLisnin) { y { # Wi fo qus $onx = $lisn.onx() $qus = $onx.qus $spons = $onx.spons # Lo qus $linIP = $qus.onPoin.ss $isp = - -Fo 'HH::ss' Wi-Hos "[$isp] qus fo $linIP - $($qus.Ul.bsoluPh)" -Foounolo yn # Hnl iffn quss if ($qus.Ul.bsoluPh -q "/" -o $qus.Ul.bsoluPh -q "/shbo") { # Sv shbo $shboonn = -onn -Ph $shboPh -w $bys = [Sys.x.noin]::UF8.Bys($shboonn) $spons.onnyp = "x/hl; hs=uf-8" $spons.onnLnh64 = $bys.Lnh $spons.Suso = 200 $spons.OupuS.Wi($bys, 0, $bys.Lnh) Wi-Hos " linil shbo sv" -Foounolo n } lsif ($qus.Ul.bsoluPh -q "/sus") { # PI sus npoin $sus = @{ plfo = "L.I.F.. linil Plfo" vsion = "2025.10.15" sus = "opionl" oy = $u sopibl = $u poplin = $u isp = (-).oSin("o") fus = @( "PhysioN  Inion", "I linil ssisn", "l-i Possin", "linil- nlyis", "xpo pbiliis" ) } | onvo-Json -ph 3 $bys = [Sys.x.noin]::UF8.Bys($sus) $spons.onnyp = "ppliion/json; hs=uf-8" $spons.onnLnh64 = $bys.Lnh $spons.Suso = 200 $spons.OupuS.Wi($bys, 0, $bys.Lnh) Wi-Hos " Sus PI ll" -Foounolo Yllow } lsif ($qus.Ul.bsoluPh -q "/hlh") { # Hlh h npoin $hlh = "L.I.F.. linil Plfo - OPIONL - Oob 15, 2025 o y" $bys = [Sys.x.noin]::UF8.Bys($hlh) $spons.onnyp = "x/plin; hs=uf-8" $spons.onnLnh64 = $bys.Lnh $spons.Suso = 200 $spons.OupuS.Wi($bys, 0, $bys.Lnh) Wi-Hos " Hlh h O" -Foounolo n } ls { # 404 fo oh quss $os = "L.I.F.. Plfo - sou no foun. y: / o /shbo o /sus" $bys = [Sys.x.noin]::UF8.Bys($os) $spons.onnyp = "x/plin; hs=uf-8" $spons.onnLnh64 = $bys.Lnh $spons.Suso = 404 $spons.OupuS.Wi($bys, 0, $bys.Lnh) Wi-Hos " 404 - sou no foun" -Foounolo  } $spons.los() } h { Wi-Hos " ️ qus o: $($.xpion.ss)" -Foounolo  if ($spons) { $spons.los() } } } } h { Wi-Hos " Sv o: $($.xpion.ss)" -Foounolo  xi 1 } finlly { if ($lisn) { $lisn.Sop() Wi-Hos "" Wi-Hos " linil o Sv sopp." -Foounolo Yllow Wi-Hos "hn you fo usin L.I.F.. Plfo!" -Foounolo yn } }