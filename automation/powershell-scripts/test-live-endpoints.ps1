# L.I.F.. Plfo Liv npoin sin & Funion pp onioin # n: Spb 28, 2025 # Pupos: s liv zu infsuu n onio Funion pp iviy p( [sin]$SubsipionI = "588f6-f243-497-98f-66086575", [sin]$sououp = "lif-plfo-", [swih]$il ) Wi-Hos " L.I.F.. Plfo Liv npoin sin" -Foounolo yn Wi-Hos "===========================================" -Foounolo yn Wi-Hos "" # S zu subsipion Wi-Hos " Sin zu subsipion..." -Foounolo Yllow z oun s --subsipion $SubsipionI # Funion o s HP npoins funion s-npoin { p( [sin]$Ul, [sin]$N, [in]$iouSons = 30 ) y { Wi-Hos " sin $N..." -Foounolo n Wi-Hos " UL: $Ul" -Foounolo y $spons = Invo-Wbqus -Ui $Ul -ho  -iouS $iouSons -UsBsiPsin Wi-Hos " Sus: $($spons.Suso) $($spons.Sussipion)" -Foounolo n Wi-Hos " spons Lnh: $($spons.onn.Lnh) bys" -Foounolo y if ($il) { Wi-Hos " Hs:" -Foounolo y $spons.Hs | Fo-bl -uoSiz } un $u } h { Wi-Hos " o: $($.xpion.ss)" -Foounolo  un $fls } } Wi-Hos " PHS 1: Funion pp Sus h" -Foounolo yn Wi-Hos "=====================================" -Foounolo yn #  Funion pps n hi ULs Wi-Hos " ivin Funion pp infoion..." -Foounolo Yllow $funionpps = z funionpp lis --sou-oup $sououp --quy "[].{N:n, S:s, fulHosN:fulHosN, Loion:loion}" -o json | onvFo-Json if ($funionpps.oun -q 0) { Wi-Hos " ️ No Funion pps foun in sou oup: $sououp" -Foounolo Yllow Wi-Hos " hin ll Funion pps in subsipion..." -Foounolo Yllow $funionpps = z funionpp lis --quy "[?onins(n,'lif')].{N:n, S:s, fulHosN:fulHosN, Loion:loion, sououp:sououp}" -o json | onvFo-Json } foh ($pp in $funionpps) { Wi-Hos "" Wi-Hos " Funion pp: $($pp.N)" -Foounolo n Wi-Hos " Loion: $($pp.Loion)" -Foounolo y Wi-Hos " S: $($pp.S)" -Foounolo y Wi-Hos " Hos: $($pp.fulHosN)" -Foounolo y if ($pp.sououp) { Wi-Hos " sou oup: $($pp.sououp)" -Foounolo y } } Wi-Hos "" Wi-Hos " PHS 2: npoin onniviy sin" -Foounolo yn Wi-Hos "=========================================" -Foounolo yn # s Funion pp npoins foh ($pp in $funionpps) { if ($pp.fulHosN -n $pp.S -q "unnin") { $bsUl = "hps://$($pp.fulHosN)" Wi-Hos "" Wi-Hos " sin: $($pp.N)" -Foounolo n # s bsi npoin s-npoin -Ul $bsUl -N "Bs UL" # s oon Funion pp npoins s-npoin -Ul "$bsUl/pi/hlh" -N "Hlh h" s-npoin -Ul "$bsUl/pi/sus" -N "Sus npoin" s-npoin -Ul "$bsUl/pi/info" -N "Info npoin" } } Wi-Hos "" Wi-Hos " PHS 3: Funion pp Los & is" -Foounolo yn Wi-Hos "=======================================" -Foounolo yn foh ($pp in $funionpps) { Wi-Hos "" Wi-Hos " Los fo: $($pp.N)" -Foounolo n y { #  n los (ls 50 lins) Wi-Hos " ivin n iviy los..." -Foounolo Yllow $sououpN = if ($pp.sououp) { $pp.sououp } ls { $sououp } #  Funion pp los Wi-Hos " Funion pp Los (Ls 10 nis):" -Foounolo n z funionpp los il --n $pp.N --sou-oup $sououpN --x-lins 10 --iou 10 2>$null #  Funion pp onfiuion if ($il) { Wi-Hos " ️ pp Sins:" -Foounolo n z funionpp onfi ppsins lis --n $pp.N --sou-oup $sououpN --quy "[].{N:n, Vlu:vlu}" -o bl 2>$null } #  Funion finiions Wi-Hos " vilbl Funions:" -Foounolo n z funionpp funion lis --n $pp.N --sou-oup $sououpN --quy "[].{N:n, Lnu:lnu}" -o bl 2>$null } h { Wi-Hos " ️ oul no iv los: $($.xpion.ss)" -Foounolo Yllow } } Wi-Hos "" Wi-Hos " ️ PHS 4: Si Wb pp sin" -Foounolo yn Wi-Hos "===================================" -Foounolo yn # s Si Wb pp $siWbpps = z siwbpp lis --sou-oup $sououp --quy "[].{N:n, fulHosN:fulHosn}" -o json 2>$null | onvFo-Json foh ($wbpp in $siWbpps) { Wi-Hos "" Wi-Hos " sin Si Wb pp: $($wbpp.N)" -Foounolo n if ($wbpp.fulHosN) { s-npoin -Ul "hps://$($wbpp.fulHosN)" -N "Si Wb pp" } } Wi-Hos "" Wi-Hos " PHS 5: y Vul & So Vliion" -Foounolo yn Wi-Hos "==========================================" -Foounolo yn # s y Vul ssibiliy Wi-Hos " sin y Vul ss..." -Foounolo Yllow $yVuls = z yvul lis --sou-oup $sououp --quy "[].{N:n, VulUi:popis.vulUi}" -o json 2>$null | onvFo-Json foh ($v in $yVuls) { Wi-Hos " y Vul: $($v.N)" -Foounolo n Wi-Hos " UI: $($v.VulUi)" -Foounolo y # y o lis ss (will show if ssibl) y { $soun = (z yvul s lis --vul-n $v.N --quy "lnh(@)" -o sv 2>$null) Wi-Hos " ssibl Ss: $soun" -Foounolo n } h { Wi-Hos " ️ ss si (nol fo pouion)" -Foounolo Yllow } } # s So oun ssibiliy Wi-Hos "" Wi-Hos " sin So oun ss..." -Foounolo Yllow $soouns = z so oun lis --sou-oup $sououp --quy "[].{N:n, Piynpoins:piynpoins}" -o json 2>$null | onvFo-Json foh ($so in $soouns) { Wi-Hos " So oun: $($so.N)" -Foounolo n if ($so.Piynpoins.blob) { Wi-Hos " Blob npoin: $($so.Piynpoins.blob)" -Foounolo y s-npoin -Ul $so.Piynpoins.blob -N "Blob So" } } Wi-Hos "" Wi-Hos " PHS 6: NS & uso oins" -Foounolo yn Wi-Hos "=================================" -Foounolo yn # s uso oins $usooins = @("oh121lif.o", "lifno121.o") foh ($oin in $usooins) { Wi-Hos "" Wi-Hos " sin NS fo: $oin" -Foounolo n y { # s NS soluion $nssul = solv-nsN $oin -yp  -oion Silnlyoninu if ($nssul) { Wi-Hos " NS soluion: Suss" -Foounolo n Wi-Hos " IP ss: $($nssul.IPss -join ', ')" -Foounolo y # s HP onniviy s-npoin -Ul "hps://$oin" -N "HPS npoin" s-npoin -Ul "hp://$oin" -N "HP npoin" } ls { Wi-Hos " NS soluion: Fil" -Foounolo  } } h { Wi-Hos " ️ NS s o: $($.xpion.ss)" -Foounolo Yllow } } Wi-Hos "" Wi-Hos " SIN OPL!" -Foounolo n Wi-Hos "===================" -Foounolo n Wi-Hos " Liv npoin sin finish" -Foounolo n Wi-Hos " h suls bov fo ny issus" -Foounolo n Wi-Hos " L.I.F.. Plfo sus vli!" -Foounolo n Wi-Hos "" Wi-Hos " Fo o il nlysis, un wih -il swih" -Foounolo yn Wi-Hos " xpl: .\s-liv-npoins.ps1 -il" -Foounolo yn